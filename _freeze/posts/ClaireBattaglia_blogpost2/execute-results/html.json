{
  "hash": "ecd6c611d265dfc4711669e57edebe1f",
  "result": {
    "markdown": "---\ntitle: \"Blog Post 2\"\nauthor: \"Claire Battaglia\"\ndesription: \"Blog Post 2\"\ndate: \"10/02/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Claire Battaglia\n  - text-as-data\n  - blog post 2\n  - open-text survey response\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## The Data\n\nThe dataset that I'll be working with is from the Missoula City-County's inaugural Community Food Assessment, completed in 2021. In particular, the responses to one (or more) of the open-ended questions:\n\n1. What changes would you like to see for Missoula’s food system?\n2. In your opinion, what strengths and assets exist in Missoula's food system (i.e. in what ways is the food system doing well)?\n3. In your opinion, what gaps or unmet needs exist in Missoula's food system (i.e. in what ways could the food system do better)?\n\nQuestion One and Question Three are distinct questions but that distinction might not have been clear to respondents so I'm not sure yet whether it makes sense to analyze both questions or just one of the two.\n\nWe received 389 responses in 2021 but are working to implement random sampling for our next wave and anticipate a larger, valid sample moving forward. Working with this smaller sample will thus be good practice for me but it's important to note that, given the sampling method (a mix between convenience and snowball sampling), I will ultimately not be drawing any inferences about the Missoula community as a whole from it.\n\n## Research Question and Analysis\n\nWhile I am still researching methods of analysis I am currently leaning towards Structural Topic Modeling (STM). I am ultimately interested in understanding the prevalence and content of topics (for each of the above survey questions) by certain categories: age, household size, household income level, and geographic area, etc. STM will enable me to do this. As described by Roberts et al., it will allow me to *discover* the topics within the responses as opposed to assume them based upon my own theoretical expectations.^[Roberts, Margaret E.; Stewart, Brandon M.; Tingley, Dustin; Lucas, Christopher; Leder-Luis, Jetson; Gadarian, Shana Kushner; Albertson, Bethany; Rand, David G. (2014). Structural Topic Models for Open-Ended Survey Responses. American Journal of Political Science, 58(4), 1064–1082.doi:10.1111/ajps.12103]\n\n*Prevalence* refers to how frequently a topic is discussed and *content* refers to the language used to discuss it.\n\nSTM will allow me to analyze whether different groups discuss certain topics more frequently than other groups but also what language they use to discuss them. This is important. Looking at prevalence alone may reveal that all income levels discuss farmers markets with the same frequency but looking at content as well could reveal that one income level uses words/phrases like \"fun\" or \"meet friends\" to talk about them while another group uses \"expensive\" or \"far away.\" These are clearly getting at very different lived experiences of farmers markets.\n\n## Getting Started\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# check wd\ngetwd()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"C:/Users/srika/OneDrive/Desktop/Text_as_Data_Fall_2022/posts\"\n```\n:::\n\n```{.r .cell-code}\n# read data\nCFA_raw <- read_excel(\"FPAB Community Food Assessment Survey Data.xlsx\", sheet = \"Raw\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...15`\n• `` -> `...16`\n• `` -> `...17`\n• `` -> `...18`\n• `` -> `...19`\n• `` -> `...20`\n• `` -> `...21`\n• `` -> `...22`\n• `` -> `...23`\n• `` -> `...24`\n• `` -> `...26`\n• `` -> `...27`\n• `` -> `...28`\n• `` -> `...29`\n• `` -> `...30`\n• `` -> `...31`\n• `` -> `...32`\n• `` -> `...34`\n• `` -> `...35`\n• `` -> `...36`\n• `` -> `...37`\n• `` -> `...38`\n• `` -> `...39`\n• `` -> `...40`\n• `` -> `...43`\n• `` -> `...44`\n• `` -> `...45`\n• `` -> `...46`\n• `` -> `...47`\n• `` -> `...48`\n• `` -> `...50`\n• `` -> `...51`\n• `` -> `...52`\n• `` -> `...53`\n• `` -> `...54`\n• `` -> `...55`\n• `` -> `...56`\n• `` -> `...57`\n• `` -> `...58`\n• `` -> `...60`\n• `` -> `...61`\n• `` -> `...62`\n• `` -> `...63`\n• `` -> `...64`\n• `` -> `...65`\n• `` -> `...66`\n• `` -> `...67`\n• `` -> `...68`\n• `` -> `...69`\n```\n:::\n\n```{.r .cell-code}\n# preview\nhead(CFA_raw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 72\n  Respondent I…¹ Colle…² `Start Date`        `End Date`          IP Ad…³ Email…⁴\n           <dbl>   <dbl> <dttm>              <dttm>              <chr>   <lgl>  \n1    12978141302  4.09e8 2021-09-18 13:41:15 2021-09-18 14:43:04 216.14… NA     \n2    12979593159  4.09e8 2021-09-19 17:30:07 2021-09-19 17:36:22 72.174… NA     \n3    12991074702  4.09e8 2021-09-22 15:30:03 2021-09-23 13:55:29 184.16… NA     \n4    12985165265  4.09e8 2021-09-21 15:03:48 2021-09-21 15:58:22 72.174… NA     \n5    12978197761  4.09e8 2021-09-18 15:31:36 2021-09-18 15:44:55 209.6.… NA     \n6    13003870096  4.09e8 2021-09-28 23:25:30 2021-09-28 23:27:22 69.145… NA     \n# … with 66 more variables: `First Name` <lgl>, `Last Name` <lgl>,\n#   `Custom Data 1` <lgl>, `Zip Code` <dbl>, Age <chr>,\n#   `Annual Household Income` <chr>,\n#   `Number of Individuals in Your Household` <chr>,\n#   `In the context of food and agriculture, which of the following do you identify with? (Check all that apply)` <chr>,\n#   ...15 <chr>, ...16 <chr>, ...17 <chr>, ...18 <chr>, ...19 <chr>,\n#   ...20 <chr>, ...21 <chr>, ...22 <chr>, ...23 <chr>, ...24 <chr>, …\n```\n:::\n:::\n\n\nThere is some initial cleaning I can do right now.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# rename columns\nCFA_tidy <- CFA_raw %>%\n  rename(\"id\" = \"Respondent ID\",\n         \"zip\" = \"Zip Code\",\n         \"age\" = \"Age\",\n         \"income\" = \"Annual Household Income\",\n         \"size\" = \"Number of Individuals in Your Household\",\n         \"change\" = \"What changes would you like to see for Missoula’s food system?\",\n         \"strengths\" = \"In your opinion, what strengths and assets exist in Missoula's food system (i.e. in what ways is the food system doing well)?\")\n\n# create subset\nCFA_tidy <- CFA_tidy %>%\n  subset(select = c(\"id\", \"zip\", \"age\", \"income\", \"size\", \"change\", \"strengths\"))\n\n# preview\nhead(CFA_tidy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n           id   zip age   income                      size  change       stren…¹\n        <dbl> <dbl> <chr> <chr>                       <chr> <chr>        <chr>  \n1 12978141302 59823 72    Under $25,000               2     \"More conce… Plenty…\n2 12979593159 59802 42    Between $35,000 and $49,999 4      <NA>        We hav…\n3 12991074702 59802 29    Between $50,000 and $99,999 2     \"I'd like t… We hav…\n4 12985165265 59801 60    Between $50,000 and $99,999 2     \"Factual, e… Garden…\n5 12978197761 59801 61    Between $50,000 and $99,999 1     \"Whatever i… I beli…\n6 13003870096 59803 27    Between $25,000 and $34,999 4      <NA>        So man…\n# … with abbreviated variable name ¹​strengths\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# change class\nCFA_tidy$id <- as.character(CFA_tidy$id)\nCFA_tidy$zip <- as.character(CFA_tidy$zip)\nCFA_tidy$age <- as.numeric(CFA_tidy$age)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\nCFA_tidy$size <- as.numeric(CFA_tidy$size)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\n# TODO decide what to do with income categories\n# CFA_tidy$size <- as.numeric(CFA_tidy$size)\n\n# preview\nhead(CFA_tidy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  id          zip     age income                       size change       stren…¹\n  <chr>       <chr> <dbl> <chr>                       <dbl> <chr>        <chr>  \n1 12978141302 59823    72 Under $25,000                   2 \"More conce… Plenty…\n2 12979593159 59802    42 Between $35,000 and $49,999     4  <NA>        We hav…\n3 12991074702 59802    29 Between $50,000 and $99,999     2 \"I'd like t… We hav…\n4 12985165265 59801    60 Between $50,000 and $99,999     2 \"Factual, e… Garden…\n5 12978197761 59801    61 Between $50,000 and $99,999     1 \"Whatever i… I beli…\n6 13003870096 59803    27 Between $25,000 and $34,999     4  <NA>        So man…\n# … with abbreviated variable name ¹​strengths\n```\n:::\n\n```{.r .cell-code}\nsave(CFA_tidy, file = \"CFA_tidy.RData\")\n\n# TODO get mean age and size of household\n# mean(CFA_tidy$age, na.rm = TRUE)\n# mean(CFA_tidy$size, na.rm = TRUE)\n```\n:::\n\n\nNext I'll calculate some summary statistics.\n\nFor **age** I'll be interested in mean, median, mode and range.\nFor **household size** I'll be interested in mean, median, mode and range.\nI'll want the mode **income level**.\nI'll also want all of those statistics broken out for each zip code.\n\n## Thinking Ahead to Next Steps\n\nNext I'll spend some time with the [`stm`](https://cran.r-project.org/web/packages/stm/vignettes/stmVignette.pdf) package and go through the methodology outlined in \"Structural Topic Models for Open-Ended Survey Responses\" in more detail. I definitely need to wrap my head around constructing the actual model(s) and there are some statistical concepts that have surfaced that I'm not familiar with (e.g. shrinkage priors, regularization, etc.)\n\nI've also started thinking about what I would like to be able to visualize and came across these posts about visualizing text data in both R and Python:\n\n* R - [TextPlot: R Library for Visualizing Text Data](https://towardsdatascience.com/textplot-r-library-for-visualizing-text-data-a8f1740a032d)\n* Python - [Advanced Visualisations for Text Data Analysis](https://towardsdatascience.com/advanced-visualisations-for-text-data-analysis-fc8add8796e2)\n\nNeither are specific to STM but may give me a sense of what is possible, packages to use, etc. The STM package documentation also includes some ideas for visualization STM models.\n",
    "supporting": [
      "ClaireBattaglia_blogpost2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}