{
  "hash": "dccab4d2c1435725532a72cd2a87384a",
  "result": {
    "markdown": "---\ntitle: \"Text as Data Final Project\"\nauthor: \"Ethan Campbell\"\ndescription: \"Research into English Premier League and how language changes depending on the season\"\ndate: \"11/16/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Blog Post 4\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n# Loading Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rvest)\nlibrary(tidyverse)\nlibrary(polite)\nlibrary(stringr)\nlibrary(preText)\nlibrary(quanteda)\nlibrary(quanteda.textplots)\nlibrary(tidytext)\nlibrary(tm)\nlibrary(SentimentAnalysis)\nlibrary(quanteda.dictionaries)\n```\n:::\n\n\n# Data Sources\n\nThere are 6 teams included in this study 2 from the top of the table 2 from the middle and 2 from the bottom. They are already in that order from top to bottom. Data needed to be web scraped from a page called match report. This page was located on each teams official website and this page included information about the match, statistics, and quotes from both the players and the managers. This data will include this current season and all of last season.\n\n[Arsenal Data](https://www.arsenal.com/news?field_article_arsenal_team_value=men&revision_information=&page=1)\n\n[Manchester City Data](https://www.mancity.com/news/mens)\n\n[Newcastle United Data](https://www.nufc.co.uk/matches/first-team/#results)\n\n[Everton Data](https://www.evertonfc.com/results)\n\n[Leicester Data](https://www.lcfc.com/matches/reports)\n\n[West Ham United Data](https://www.whufc.com/fixture/list/713)\n\n# Hypothesis for project\n\n::: callout-note\n## Research Questions\n\nA. Does Premier League soccer teams language change over the course of the season?\n\nB. Does the language grow in correlation to the success of the season?\n:::\n\nThe hypothesis will be tested as follows:\n\n::: callout-tip\n## H~0A~\n\nThe Premier league soccer team language [does not]{.underline} change over the course of the season.\n:::\n\n::: callout-tip\n## H~1A~\n\nThe Premier league soccer team language [does]{.underline} change over the course of the season.\n:::\n\n::: callout-tip\n## H~0A~\n\nThe language [does not]{.underline} correlate to the success of the season.\n:::\n\n::: callout-tip\n## H~1A~\n\nThe language [does]{.underline} correlate to the success of the season.\n:::\n\n# Analytic planning\n\n\n```{mermaid}\nflowchart LR\n  A[Web Scrape] --> B(Preprocess)\n  B --> C[Organize]\n  C --> D(TDM)\n  D --> E[Sentiment Analysis]\n  E --> F[Research Question 1]\n  F --> G{Conclusion}\n  D --> H[DTM]\n  H --> I[Document Similarity]\n  I --> J[Research Question 2]\n  J --> G{Conclusion}\n```\n\n\n[![Image from Sentiment Analysis of 49 years of Warren Buffett\\'s Letters to Shareholders of Berkshire Hathaway by Paul D. Sonkin](Sentimentpicture.png){width=\"920\"}](https://bookdown.org/psonkin18/berkshire/sentiment.html#setting-expectations)\n\n# Web Scraping/Tidying data\n\nHere is the beginning of the web scraping process. I was unable to find a way to make the web scraper search for one object then proceed to the next page where you could then scrape whats inside. For the time being I decided to manually web scrape the information. The tidying process is the real issue as there are many unwanted variables inside. For example there are a lot of /n's.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## The function is working at reading in the data however. parts of the cleaning process are failing and I am thinking this is because I am not specifying the create values\n\n# I need to remove punct, capitalization, stopwords like (the, a ',') finish repeating the process to all teams and adjusting the function until it grabs every single problem once this is complete we should be able to tokenize then corpus and work with the data\n\nWeb_scrape_function_Arsenal <- function(url,css,data) { # creating function to repeat web scrape \n  url <- read_html(url) \ncss <- (\".article-body\")\ndata <- url %>% \n  html_node(css = css) %>%\n  html_text2()\n}\n\ntidy_function <- function(data){data <- str_replace_all(data, \"\\n\", \"####\") %>%\n  str_replace_all(\"/n\", \"####\") %>%\n  str_remove_all(\"/n\") %>%\n  str_remove_all(\"\\n\") %>%\n  str_remove_all(\" - \") %>%\n  str_replace_all(\"'\\'\", \"#\") %>%\n  str_replace_all(\"[0-9] of [0-9]To buy official Arsenal pictures visit Arsenal Pics\", \"#\") %>%\n  str_remove(\"WHAT HAPPENED\") %>%\n  str_remove_all(\"[0-9] of 42To buy official Arsenal pictures visit Arsenal Pics\") %>%\n  str_remove_all(\"[0-9] of 29To buy official Arsenal pictures visit Arsenal Pics\") %>%\n  str_remove_all(\"[0-9] of 45To buy official Arsenal pictures visit Arsenal Pics\") %>%\n  str_remove_all(\"[0-9] of 38To buy official Arsenal pictures visit Arsenal Pics\") %>%\n  str_remove_all(\"[0-9] of 32To buy official Arsenal pictures visit Arsenal Pics\") %>%\n  str_remove_all(\"[0-9] of 36To buy official Arsenal pictures visit Arsenal Pics\") %>%\n  str_remove(\"Play videoWatch Arsenal video online05:24Highlights | Crystal Palace 0-2 Arsenal - bitesize\") %>%\n  str_remove(\"111111111122222222223333333333444\") %>%\n  str_remove(\"111111111122222222223333333\") %>%\n  str_remove(\"11111111112222222222\") %>%\n  str_remove_all(\"\\\\(\") %>%\n  str_remove_all(\"\\\\)\") %>%\n  str_replace_all(\"||\", \"#\") %>%\n  str_remove_all(\"'Play videoWatch Arsenal video online02:17Mikel Arteta post-match interview | Crystal Palace 0-2 Arsenal | Premier LeagueArteta: \\'\") %>%\n  str_remove_all(\"\\\"read everything from his press conferencePlay videoWatch Arsenal video online02:07William Saliba post-match interview || Premier LeagueSaliba:\") %>%\n  str_remove_all(\"#\") %>%\n  unlist()\n}\n\n# Running the tidy function twice to clean up certain parts that are getting missed the first time for some reason and this is a temporary fix.\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Aug-05/crystal-palace-0-2-arsenal-match-report\"\nMatch_1 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_1 <- tidy_function(Match_1)\nMatch_1 <- tidy_function(Match_1)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Aug-13/arsenal-4-2-leicester-city-match-report\"\nMatch_2 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_2 <- tidy_function(Match_2)\nMatch_2 <- tidy_function(Match_2)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-bournemouth-odegaard-saliba-jesus\"\nMatch_3 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_3 <- tidy_function(Match_3)\nMatch_3 <- tidy_function(Match_3)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-fulham-odegaard-gabriel\"\nMatch_4 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_4 <- tidy_function(Match_4)\nMatch_4 <- tidy_function(Match_4)\nArsenal_url <- \"https://www.arsenal.com/match-report-aston-villa-premier-league-martinelli-jesus\"\nMatch_5 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_5 <- tidy_function(Match_5)\nMatch_5 <- tidy_function(Match_5)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Sep-04/manchester-united-3-1-arsenal-match-report\"\nMatch_6 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_6 <- tidy_function(Match_6)\nMatch_6 <- tidy_function(Match_6)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-brentford-saliba-jesus-vieira\"\nMatch_7 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_7 <- tidy_function(Match_7)\nMatch_7 <- tidy_function(Match_7)\n# Arsenal 2021 season \n\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Jul-28/arsenal-4-1-watford-match-report\"\nMatch_1_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_1_2021 <- tidy_function(Match_1_2021)\nMatch_1_2021 <- tidy_function(Match_1_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Aug-01/arsenal-1-2-chelsea-match-report\"\nMatch_2_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_2_2021 <- tidy_function(Match_2_2021)\nMatch_2_2021 <- tidy_function(Match_2_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Aug-08/tottenham-hotspur-1-0-arsenal-match-report\"\nMatch_3_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_3_2021 <- tidy_function(Match_3_2021)\nMatch_3_2021 <- tidy_function(Match_3_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Aug-13/brentford-fc-2-0-arsenal-match-report\"\nMatch_4_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_4_2021 <- tidy_function(Match_4_2021)\nMatch_4_2021 <- tidy_function(Match_4_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Aug-22/arsenal-0-2-chelsea-match-report\"\nMatch_5_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_5_2021 <- tidy_function(Match_5_2021)\nMatch_5_2021 <- tidy_function(Match_5_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Aug-28/manchester-city-5-0-arsenal-match-report\"\nMatch_6_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_6_2021 <- tidy_function(Match_6_2021)\nMatch_6_2021 <- tidy_function(Match_6_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Sep-11/arsenal-1-0-norwich-city-match-report\"\nMatch_7_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_7_2021 <- tidy_function(Match_7_2021)\nMatch_7_2021 <- tidy_function(Match_7_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Sep-18/burnley-0-1-arsenal-match-report\"\nMatch_8_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_8_2021 <- tidy_function(Match_8_2021)\nMatch_8_2021 <- tidy_function(Match_8_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Sep-26/arsenal-3-1-tottenham-hotspur-match-report\"\nMatch_9_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_9_2021 <- tidy_function(Match_9_2021)\nMatch_9_2021 <- tidy_function(Match_9_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Oct-02/brighton-0-0-arsenal-match-report\"\nMatch_10_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_10_2021 <- tidy_function(Match_10_2021)\nMatch_10_2021 <- tidy_function(Match_10_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Oct-18/arsenal-2-2-crystal-palace-match-report\"\nMatch_11_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_11_2021 <- tidy_function(Match_11_2021)\nMatch_11_2021 <- tidy_function(Match_11_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Oct-22/arsenal-3-1-aston-villa-match-report\"\nMatch_12_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_12_2021 <- tidy_function(Match_12_2021)\nMatch_12_2021 <- tidy_function(Match_12_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Oct-30/leicester-city-0-2-arsenal-match-report\"\nMatch_13_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_13_2021 <- tidy_function(Match_13_2021)\nMatch_13_2021 <- tidy_function(Match_13_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Nov-07/arsenal-1-0-watford-match-report\"\nMatch_14_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_14_2021 <- tidy_function(Match_14_2021)\nMatch_14_2021 <- tidy_function(Match_14_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Nov-20/liverpool-4-0-arsenal-match-report\"\nMatch_15_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_15_2021 <- tidy_function(Match_15_2021)\nMatch_15_2021 <- tidy_function(Match_15_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Nov-27/arsenal-2-0-newcastle-united-match-report\"\nMatch_16_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_16_2021 <- tidy_function(Match_16_2021)\nMatch_16_2021 <- tidy_function(Match_16_2021)\nArsenal_url <- \"https://www.arsenal.com/arsenal-manchester-united-match-report-premier-league\"\nMatch_17_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_17_2021 <- tidy_function(Match_17_2021)\nMatch_17_2021 <- tidy_function(Match_17_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Dec-06/everton-2-1-arsenal-match-report\"\nMatch_18_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_18_2021 <- tidy_function(Match_18_2021)\nMatch_18_2021 <- tidy_function(Match_18_2021)\nArsenal_url <- \"https://www.arsenal.com/arsenal-southampton-match-report-premier-league-lacazette\"\nMatch_19_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_19_2021 <- tidy_function(Match_19_2021)\nMatch_19_2021 <- tidy_function(Match_19_2021)\nArsenal_url <- \"https://www.arsenal.com/arsenal-west-ham-match-report-premier-league-martinelli-smith-rowe\"\nMatch_20_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_20_2021 <- tidy_function(Match_20_2021)\nMatch_20_2021 <- tidy_function(Match_20_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Dec-18/leeds-1-4-arsenal-match-report\"\nMatch_21_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_21_2021 <- tidy_function(Match_21_2021)\nMatch_21_2021 <- tidy_function(Match_21_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2021-Dec-26/norwich-city-0-5-arsenal-match-report\"\nMatch_22_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_22_2021 <- tidy_function(Match_22_2021)\nMatch_22_2021 <- tidy_function(Match_22_2021)\nArsenal_url <- \"https://www.arsenal.com/arsenal-manchester-city-report-xhaka-gabriel-premier-league\"\nMatch_23_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_23_2021 <- tidy_function(Match_23_2021)\nMatch_23_2021 <- tidy_function(Match_23_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-burnley-match-report-emirates-stadium\"\nMatch_24_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_24_2021 <- tidy_function(Match_24_2021)\nMatch_24_2021 <- tidy_function(Match_24_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Feb-10/wolves-0-1-arsenal-match-report\"\nMatch_25_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_25_2021 <- tidy_function(Match_25_2021)\nMatch_25_2021 <- tidy_function(Match_25_2021)\nArsenal_url <- \"https://www.arsenal.com/match-report-emile-smith-rowe-bukayo-saka-premier-league-southampton\"\nMatch_26_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_26_2021 <- tidy_function(Match_26_2021)\nMatch_26_2021 <- tidy_function(Match_26_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Feb-24/arsenal-2-1-wolves-match-report-0\"\nMatch_27_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_27_2021 <- tidy_function(Match_27_2021)\nMatch_27_2021 <- tidy_function(Match_27_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-watford-odegaard-saka-martinelli\"\nMatch_28_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_28_2021 <- tidy_function(Match_28_2021)\nMatch_28_2021 <- tidy_function(Match_28_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-leicester-city-thomas-partey-alexandre-lacazette\"\nMatch_29_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_29_2021 <- tidy_function(Match_29_2021)\nMatch_29_2021 <- tidy_function(Match_29_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Mar-16/arsenal-0-2-liverpool-match-report\"\nMatch_30_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_30_2021 <- tidy_function(Match_30_2021)\nMatch_30_2021 <- tidy_function(Match_30_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-bukayo-saka-aston-villa-top-four\"\nMatch_31_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_31_2021 <- tidy_function(Match_31_2021)\nMatch_31_2021 <- tidy_function(Match_31_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Apr-04/crystal-palace-3-0-arsenal-match-report\"\nMatch_32_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_32_2021 <- tidy_function(Match_32_2021)\nMatch_32_2021 <- tidy_function(Match_32_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-brighton-martin-odegaard-emirates-stadium\"\nMatch_33_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_33_2021 <- tidy_function(Match_33_2021)\nMatch_33_2021 <- tidy_function(Match_33_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-Apr-16/southampton-1-0-arsenal-match-report\"\nMatch_34_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_34_2021 <- tidy_function(Match_34_2021)\nMatch_34_2021 <- tidy_function(Match_34_2021)\nArsenal_url <- \"https://www.arsenal.com/match-report-premier-league-chelsea-nketiah-smith-rowe-saka\"\nMatch_35_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_35_2021 <- tidy_function(Match_35_2021)\nMatch_35_2021 <- tidy_function(Match_35_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-manchester-united-saka-tavares-xhaka-ronaldo\"\nMatch_36_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_36_2021 <- tidy_function(Match_36_2021)\nMatch_36_2021 <- tidy_function(Match_36_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-west-ham-london-stadium\"\nMatch_37_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_37_2021 <- tidy_function(Match_37_2021)\nMatch_37_2021 <- tidy_function(Match_37_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-leeds-united-emirates-stadium-top-four-nketiah\"\nMatch_38_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_38_2021 <- tidy_function(Match_38_2021)\nMatch_38_2021 <- tidy_function(Match_38_2021)\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-tottenham-hotspur-top-four\"\nMatch_39_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_39_2021 <- tidy_function(Match_39_2021)\nMatch_39_2021 <- tidy_function(Match_39_2021)\nArsenal_url <- \"https://www.arsenal.com/fixture/arsenal/2022-May-16/newcastle-united-2-0-arsenal-match-report\"\nMatch_40_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_40_2021 <- tidy_function(Match_40_2021)\nMatch_40_2021 <- tidy_function(Match_40_2021)\n\nArsenal_url <- \"https://www.arsenal.com/premier-league-match-report-everton-mikel-arteta-emirates-stadium\"\nMatch_41_2021 <- Web_scrape_function_Arsenal(Arsenal_url)\nMatch_41_2021 <- tidy_function(Match_41_2021)\nMatch_41_2021 <- tidy_function(Match_41_2021)\n# Manchester City data\n\nWeb_scrape_function_mancity <- function(url,css,data) { # creating function to repeat web scrape \n  url <- read_html(url) \ncss <- (\".article-body__article-text\")\ndata <- url %>% \n  html_node(css = css) %>%\n  html_text2()\ndata <- str_replace_all(data, \"\\n\", \"####\") %>%\n  str_replace_all(\"/n\", \"####\") %>%\n  str_remove_all(\"/n\") %>%\n  str_remove_all(\"\\n\") %>%\n  str_remove_all(\" - \") %>%\n  str_remove_all(\"\\\\(\") %>%\n  str_remove_all(\"\\\\)\") %>%\n  str_remove_all(\"#\") %>%\n  str_remove_all(\"'\\'\") %>%\n  unlist()\n}\n\nmancity_url <- \"https://www.mancity.com/news/mens/west-ham-v-manchester-city-premier-league-match-report-63795480\"\nManc_1 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/man-city-bournemouth-premier-league-match-report-63795987\"\nManc_2 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/newcastle-v-manchester-city-match-report-63796690\"\nManc_3 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/man-city-crystal-palace-match-report-63797204\"\nManc_4 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-nottingham-forest-match-report-31-august-63797573\"\nManc_5 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/aston-villa-manchester-city-premier-league-match-report-63797816\"\nManc_6 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/wolves-manchester-city-away-premier-league-2022-match-report-63799002\"\nManc_7 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/tottenham-hotspur-v-manchester-city-match-report-63764635\"\nMatch_1_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-norwich-premier-league-21-august-match-report-63765149\"\nMatch_2_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-arsenal-premier-league-aug-28-match-report-63765746\"\nMatch_3_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/leicester-man-city-match-report-premier-league-11-september-63766964\"\nMatch_4_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-southampton-premier-league-match-report-63767564\"\nMatch_5_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-wycombe-wanderers-match-report-21-september-63767846\"\nMatch_6_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/chelsea-man-city-premier-league-63768172\"\nMatch_7_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/liverpool-v-manchester-city-premier-league-match-report-63768869\"\nMatch_8_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/man-city-burnley-premier-league-match-report-63769988\"\nMatch_9_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/brighton-man-city-premier-league-match-report-63770611\"\nMatch_10_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-crystal-palace-premier-league-match-report-30-october-63771197\"\nMatch_11_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-united-city-derby-match-report-premier-league-63771797\"\nMatch_12_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-everton-premier-league-match-report-63773091\"\nMatch_13_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-west-ham-united-premier-league-28-nov-match-report-63773703\"\nMatch_14_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/aston-villa-v-manchester-city-premier-league-match-report-63773986\"\nMatch_15_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/watford-v-manchester-city-pl-match-report-4-december-63774234\"\nMatch_16_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-wolves-premier-league-match-report-63774823\"\nMatch_17_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-leeds-united-premier-league-match-report-63775100\"\nMatch_18_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/newcastle-united-v-manchester-city-match-report-19-dec-63775518\"\nMatch_19_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-leicester-premier-league-match-report-63776131\"\nMatch_20_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/brentford-man-city-premier-league-match-report-63776395\"\nMatch_21_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/arsenal-man-city-premier-league-match-report-63776627\"\nMatch_22_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-chelsea-premier-league-match-report-63777838\"\nMatch_23_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/southampton-v-manchester-city-premier-league-match-report-63778466\"\nMatch_24_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-brentford-premier-league-match-report-63780029\"\nMatch_25_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/norwich-manchester-city-premier-league-12-february-63780282\"\nMatch_26_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-tottenham-match-report-63780885\"\nMatch_27_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/everton-man-city-premier-league-match-report-63781486\"\nMatch_28_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-manchester-united-premier-league-match-report-6-march-2022-63782178\"\nMatch_29_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/crystal-palace-v-manchester-city-premier-league-match-report-1-63782881\"\nMatch_30_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/burnley-manchester-city-premier-league-match-report-63784504\"\nMatch_31_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/man-city-liverpool-premier-league-match-report-63785199\"\nMatch_32_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-brighton-and-hove-albion-premier-league-match-report-63786059\"\nMatch_33_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-watford-premier-league-match-report-63786322\"\nMatch_34_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/leeds-united-v-manchester-city-premier-league-match-report-30-april-63786930\"\nMatch_35_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-newcastle-united-premier-league-match-report-8-may-2022-63787619\"\nMatch_36_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/wolves-v-manchester-city-premier-league-match-report-63787892\"\nMatch_37_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/west-ham-man-city-premier-league-match-report-63788208\"\nMatch_38_2021 <- Web_scrape_function_mancity(mancity_url)\n\nmancity_url <- \"https://www.mancity.com/news/mens/manchester-city-v-aston-villa-match-report-may-2022-63788826\"\nMatch_39_2021 <- Web_scrape_function_mancity(mancity_url)\n# New Castle \n\n# New Castle United first match against nottingham forest\n# 1 rule for 1 bots crawl delay 5 seconds, scrapable\n\nbow(\"https://www.nufc.co.uk/matches/first-team/2022-23/newcastle-united-v-nottingham-forest/\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<polite session> https://www.nufc.co.uk/matches/first-team/2022-23/newcastle-united-v-nottingham-forest/\n    User-agent: polite R package\n    robots.txt: 1 rules are defined for 1 bots\n   Crawl delay: 5 sec\n  The path is scrapable for this user-agent\n```\n:::\n\n```{.r .cell-code}\nWeb_scrape_function_Newcastle <- function(url,css,data) { # creating function to repeat web scrape \n  url <- read_html(url) \ncss <- (\".article__body\")\ndata <- url %>% \n  html_node(css = css) %>%\n  html_text2()\ndata <- str_replace_all(data, \"\\n\", \"####\") %>%\n  str_replace_all(\"/n\", \"####\") %>%\n  str_remove_all(\"/n\") %>%\n  str_remove_all(\"\\n\") %>%\n  str_remove_all(\" - \") %>%\n  str_remove_all(\"\\\\(\") %>%\n  str_remove_all(\"\\\\)\") %>%\n  str_remove_all(\"\\\"\") %>%\n  str_remove_all(\"#\") %>%\n  unlist()\n}\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2022-23/newcastle-united-v-nottingham-forest/\"\nnc_1 <- Web_scrape_function_Newcastle(Newcastle_url)\n                        \nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2022-23/brighton-and-hove-albion-v-newcastle-united/\"\nnc_2 <- Web_scrape_function_Newcastle(Newcastle_url)\n                        \nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2022-23/newcastle-united-v-manchester-city/\"\nnc_3 <- Web_scrape_function_Newcastle(Newcastle_url)\n                        \nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2022-23/wolverhampton-wanderers-v-newcastle-united/\"\nnc_4 <- Web_scrape_function_Newcastle(Newcastle_url)\n                        \nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2022-23/liverpool-v-newcastle-united/\"\nnc_5 <- Web_scrape_function_Newcastle(Newcastle_url)\n                        \nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2022-23/newcastle-united-v-crystal-palace/\"\nnc_6 <- Web_scrape_function_Newcastle(Newcastle_url)\n                        \nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2022-23/newcastle-united-v-bournemouth/\"\nnc_7 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-west-ham-united/\"\nnc_1_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/aston-villa-v-newcastle-united/\"\nnc_2_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-southampton/\"\nnc_3_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/manchester-united-v-newcastle-united/\"\nnc_4_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-leeds-united/\"\nnc_5_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/watford-v-newcastle-united/\"\nnc_6_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/wolverhampton-wanderers-v-newcastle-united/\"\nnc_7_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-tottenham-hotspur/\"\nnc_8_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/crystal-palace-v-newcastle-united/\"\nnc_9_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-chelsea/\"\nnc_10_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/brighton-and-hove-albion-v-newcastle-united/\"\nnc_11_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-brentford/\"\nnc_12_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/arsenal-v-newcastle-united/\"\nnc_13_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-norwich-city/\"\nnc_14_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-burnley/\"\nnc_15_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/leicester-city-v-newcastle-united/\"\nnc_16_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/liverpool-v-newcastle-united/\"\nnc_17_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-manchester-city/\"\nnc_18_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-manchester-united/\"\nnc_19_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-watford/\"\nnc_20_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/leeds-united-v-newcastle-united/\"\nnc_21_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-everton/\"\nnc_22_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-aston-villa/\"\nnc_23_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/west-ham-united-v-newcastle-united/\"\nnc_24_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/brentford-v-newcastle-united/\"\nnc_25_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-brighton-and-hove-albion/\"\nnc_26_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/southampton-v-newcastle-united/\"\nnc_27_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/chelsea-v-newcastle-united/\"\nnc_28_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/everton-v-newcastle-united/\"\nnc_29_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/tottenham-hotspur-v-newcastle-united/\"\nnc_30_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-wolverhampton-wanderers/\"\nnc_31_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-leicester-city/\"\nnc_32_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-crystal-palace/\"\nnc_33_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/norwich-city-v-newcastle-united/\"\nnc_34_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-liverpool/\"\nnc_35_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/manchester-city-v-newcastle-united/\"\nnc_36_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/newcastle-united-v-arsenal/\"\nnc_37_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n\nNewcastle_url <- \"https://www.nufc.co.uk/matches/first-team/2021-22/burnley-v-newcastle-united/\"\nnc_38_2021 <- Web_scrape_function_Newcastle(Newcastle_url)\n# Everton \n\n# Everton vs Chelsea\n# 1 rule for 1 bots crawl delay 5 seconds, scrapable\n\nbow(\"https://www.evertonfc.com/match/74913/everton-chelsea#report\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<polite session> https://www.evertonfc.com/match/74913/everton-chelsea#report\n    User-agent: polite R package\n    robots.txt: 1 rules are defined for 1 bots\n   Crawl delay: 5 sec\n  The path is scrapable for this user-agent\n```\n:::\n\n```{.r .cell-code}\nWeb_scrape_function_Everton <- function(url,css,data) { # creating function to repeat web scrape \n  url <- read_html(url) \ncss <- (\".article__body.mc-report__body.js-article-body\")\ndata <- url %>% \n  html_node(css = css) %>%\n  html_text2()\ndata <- str_replace_all(data, \"\\n\", \"####\") %>%\n  str_replace_all(\"/n\", \"####\") %>%\n  str_remove_all(\"/n\") %>%\n  str_remove_all(\"\\n\") %>%\n  str_remove_all(\" - \") %>%\n  str_remove_all(\"\\\\(\") %>%\n  str_remove_all(\"\\\\)\") %>%\n  str_remove_all(\"\\\"\") %>%\n  str_remove_all(\"#\") %>%\n  unlist()\n}\n\nEverton_url <- \"https://www.evertonfc.com/match/74913/everton-chelsea#report\"\never_1 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/74922/aston-villa-everton#report\"\never_2 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/74933/everton-nottm-forest#report\"\never_3 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <-\"https://www.evertonfc.com/match/74943/brentford-everton#report\"\never_4 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/74955/leeds-everton#report\"\never_5 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/74965/everton-liverpool#report\"\never_6 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/74985/everton-west-ham#report\"\never_7 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66345/everton-southampton#report\"\never_1_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66356/leeds-everton#report\"\never_2_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66363/brighton-everton#report\"\never_3_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66376/everton-burnley#report\"\never_4_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66382/aston-villa-everton#report\"\never_5_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66396/everton-norwich#report\"\never_6_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66408/man-utd-everton#report\"\never_7_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66415/everton-west-ham#report\"\never_8_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66427/everton-watford#report\"\never_9_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66441/wolves-everton#report\"\never_10_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66447/everton-spurs#report\"\never_11_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66456/man-city-everton#report\"\never_12_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66463/brentford-everton#report\"\never_13_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66473/everton-liverpool#report\"\never_14_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66483/everton-arsenal#report\"\never_15_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66497/crystal-palace-everton#report\"\never_16_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66509/chelsea-everton#report\"\never_17_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66546/everton-brighton#report\"\never_18_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66558/norwich-everton#report\"\never_19_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66566/everton-aston-villa#report\"\never_20_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66580/newcastle-everton#report\"\never_21_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66585/everton-leeds#report\"\never_22_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66599/southampton-everton#report\"\never_23_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66607/everton-man-city#report\"\never_24_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66619/spurs-everton#report\"\never_25_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66627/everton-wolves#report\"\never_26_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66536/everton-newcastle#report\"\never_27_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66650/west-ham-everton#report\"\never_28_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66524/burnley-everton#report\"\never_29_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66655/everton-man-utd#report\"\never_30_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66513/everton-leicester#report\"\never_31_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66679/liverpool-everton#report\"\never_32_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66683/everton-chelsea#report\"\never_33_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66698/leicester-everton#report\"\never_34_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66640/watford-everton#report\"\never_35_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66703/everton-brentford#report\"\never_36_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66663/everton-crystal-palace#report\"\never_37_2021 <- Web_scrape_function_Everton(Everton_url)\n\nEverton_url <- \"https://www.evertonfc.com/match/66712/arsenal-everton#report\"\never_38_2021 <- Web_scrape_function_Everton(Everton_url)\n# Leicester \n\n# Leicester against Brentford\n# 1 bot 1 rule scrapable 5 second crawl\nbow(\"https://www.lcfc.com/news/2729025/city-held-by-bees-in-premier-league-opener/featured\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<polite session> https://www.lcfc.com/news/2729025/city-held-by-bees-in-premier-league-opener/featured\n    User-agent: polite R package\n    robots.txt: 1 rules are defined for 1 bots\n   Crawl delay: 5 sec\n  The path is scrapable for this user-agent\n```\n:::\n\n```{.r .cell-code}\nWeb_scrape_function_Leicester <- function(url,css,data) { # creating function to repeat web scrape \n  url <- read_html(url) \ncss <- (\".col-12\")\ndata <- url %>% \n  html_node(css = css) %>%\n  html_text2()\ndata <- str_replace_all(data, \"\\n\", \"####\") %>%\n  str_replace_all(\"/n\", \"####\") %>%\n  str_remove_all(\"/n\") %>%\n  str_remove_all(\"\\n\") %>%\n  str_remove_all(\" - \") %>%\n  str_remove_all(\"\\\\(\") %>%\n  str_remove_all(\"\\\\)\") %>%\n  str_remove_all(\"\\\"\") %>%\n  str_remove_all(\"#\") %>%\n  str_remove_all(\"More on this story. . . In Photos -\") %>%\n  unlist()\n}\n\nLeicester_url <- \"https://www.lcfc.com/news/2729025/city-held-by-bees-in-premier-league-opener/featured\"\nlei_1 <- Web_scrape_function_Leicester(Leicester_url)\n\nLeicester_url <- \"https://www.lcfc.com/news/2739798/foxes-fall-to-defeat-at-arsenal/featured\"\nlei_2 <- Web_scrape_function_Leicester(Leicester_url)\n\nLeicester_url <- \"https://www.lcfc.com/news/2751347/saints-take-the-points-on-filbert-way/featured\"\nlei_3 <- Web_scrape_function_Leicester(Leicester_url)\n\nLeicester_url <- \"https://www.lcfc.com/news/2762326/city-defeated-as-10man-chelsea-win-at-stamford-bridge/featured\"\nlei_4 <- Web_scrape_function_Leicester(Leicester_url)\n\nLeicester_url <- \"https://www.lcfc.com/news/2774578/man-utd-defeat-for-leicester-on-matchday-five/featured\"\nlei_5 <- Web_scrape_function_Leicester(Leicester_url)\n\nLeicester_url <- \"https://www.lcfc.com/news/2779658/city-beaten-away-to-brighton/featured\"\nlei_6 <- Web_scrape_function_Leicester(Leicester_url)\n\nLeicester_url <- \"https://www.lcfc.com/news/2793845/leicester-lose-to-spurs-in-london/featured\"\nlei_7 <- Web_scrape_function_Leicester(Leicester_url)\n\n# West Ham \n\n# West Ham vs Manchester City\n\nWeb_scrape_function_WestHam <- function(url,css,data) { # creating function to repeat web scrape \n  url <- read_html(url) \ncss <- (\".m-article__columns\")\ndata <- url %>% \n  html_node(css = css) %>%\n  html_text2()\ndata <- str_replace_all(data, \"\\n\", \"####\") %>%\n  str_replace_all(\"/n\", \"####\") %>%\n  str_remove_all(\"/n\") %>%\n  str_remove_all(\"\\n\") %>%\n  str_remove_all(\" - \") %>%\n  str_remove_all(\"\\\\(\") %>%\n  str_remove_all(\"\\\\)\") %>%\n  str_remove_all(\"\\\"\") %>%\n  str_remove_all(\"#\") %>%\n  str_remove_all(\"More on this story. . . In Photos -\") %>%\n  unlist()\n}\n\nWestHam_url <- \"https://www.whufc.com/fixture/view/6472\"\nwh_1 <- Web_scrape_function_WestHam(WestHam_url)\n\nWestHam_url <- \"https://www.whufc.com/fixture/view/6464\"\nwh_2 <- Web_scrape_function_WestHam(WestHam_url)\n\nWestHam_url <- \"https://www.whufc.com/fixture/view/6452\"\nwh_3 <- Web_scrape_function_WestHam(WestHam_url)\n\nWestHam_url <- \"https://www.whufc.com/fixture/view/6450\"\nwh_4 <- Web_scrape_function_WestHam(WestHam_url)\n\nWestHam_url <- \"https://www.whufc.com/fixture/view/6436\"\nwh_5 <- Web_scrape_function_WestHam(WestHam_url)\n\nWestHam_url <- \"https://www.whufc.com/fixture/view/6428\"\nwh_6 <- Web_scrape_function_WestHam(WestHam_url)\n\nWestHam_url <- \"https://www.whufc.com/fixture/view/6407\"\nwh_7 <- Web_scrape_function_WestHam(WestHam_url)\n```\n:::\n\n\n# Preprocessing\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First step is to make these character vectors into a corpus to use for preprocessing \n# Arsenal\nArsenal <- c(Match_1, Match_2, Match_3, Match_4, Match_5, Match_6, Match_7,Match_1_2021, Match_2_2021, Match_3_2021, Match_4_2021, Match_5_2021, Match_6_2021, Match_7_2021,Match_8_2021, Match_9_2021, Match_10_2021, Match_11_2021, Match_12_2021, Match_13_2021, Match_14_2021, Match_15_2021, Match_16_2021, Match_17_2021, Match_18_2021, Match_19_2021, Match_20_2021, Match_21_2021, Match_22_2021, Match_23_2021, Match_24_2021, Match_25_2021, Match_26_2021, Match_27_2021, Match_28_2021, Match_29_2021, Match_30_2021, Match_31_2021, Match_32_2021, Match_33_2021, Match_34_2021, Match_35_2021, Match_36_2021, Match_37_2021, Match_38_2021, Match_39_2021, Match_40_2021, Match_41_2021)\n\nArsenal_corpus <- corpus(Arsenal)\n# Man city\n\nManchester_City <- c(Manc_1, Manc_2, Manc_3, Manc_4, Manc_5, Manc_6, Manc_7, Match_1_2021, Match_2_2021, Match_3_2021, Match_4_2021, Match_5_2021, Match_6_2021, Match_7_2021, Match_8_2021, Match_9_2021, Match_10_2021, Match_11_2021, Match_12_2021, Match_13_2021, Match_14_2021, Match_15_2021, Match_16_2021, Match_17_2021, Match_18_2021, Match_19_2021, Match_20_2021, Match_21_2021, Match_22_2021, Match_23_2021, Match_24_2021, Match_25_2021, Match_26_2021, Match_27_2021, Match_28_2021, Match_29_2021, Match_30_2021, Match_31_2021, Match_32_2021, Match_33_2021, Match_34_2021, Match_35_2021, Match_36_2021, Match_37_2021, Match_38_2021, Match_39_2021)\n                        \n\n# Newcastle united\n\nNewcastle_United <- c(nc_1, nc_2, nc_3, nc_4, nc_5, nc_6, nc_7, nc_1_2021, nc_2_2021, nc_3_2021, nc_4_2021, nc_5_2021, nc_6_2021, nc_7_2021, nc_8_2021, nc_9_2021, nc_10_2021, nc_11_2021, nc_12_2021, nc_13_2021, nc_14_2021, nc_15_2021, nc_16_2021, nc_17_2021, nc_18_2021, nc_19_2021, nc_20_2021, nc_21_2021, nc_22_2021, nc_23_2021, nc_24_2021, nc_25_2021, nc_26_2021, nc_27_2021, nc_28_2021, nc_29_2021, nc_30_2021, nc_31_2021, nc_32_2021, nc_33_2021, nc_34_2021, nc_35_2021, nc_36_2021, nc_37_2021, nc_38_2021)\n\n# Everton\n\nEverton <- c(ever_1, ever_2, ever_3, ever_4, ever_5, ever_6, ever_7, ever_1_2021, ever_2_2021, ever_3_2021, ever_4_2021, ever_5_2021, ever_6_2021, ever_7_2021, ever_8_2021, ever_9_2021, ever_10_2021, ever_11_2021, ever_12_2021, ever_13_2021, ever_14_2021, ever_15_2021, ever_16_2021, ever_17_2021, ever_18_2021, ever_19_2021, ever_20_2021, ever_21_2021, ever_22_2021, ever_23_2021, ever_24_2021, ever_25_2021, ever_26_2021, ever_27_2021, ever_28_2021, ever_29_2021, ever_30_2021, ever_31_2021, ever_32_2021, ever_33_2021, ever_34_2021, ever_35_2021, ever_36_2021, ever_37_2021, ever_38_2021)\n\n# Leicester\n\nLeicester <- c(lei_1, lei_2, lei_3, lei_4, lei_5, lei_6, lei_7)\n\n# West Ham\n\nWest_Ham_United <- c(wh_1, wh_2, wh_3, wh_4, wh_5, wh_6, wh_7)\n\n# Second step is figure out how to preprocess this data \n\n# seeing how I should preprocess the data\npreprocessed_documents <- factorial_preprocessing(\n    Arsenal_corpus,\n    use_ngrams = TRUE,\n    infrequent_term_threshold = 0.05,\n    verbose = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPreprocessing 48 documents 128 different ways...\n```\n:::\n\n```{.r .cell-code}\npreText_results <- preText(\n    preprocessed_documents,\n    dataset_name = \"Arsenal\",\n    distance_method = \"cosine\",\n    num_comparisons = 10,\n    verbose = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGenerating document distances...\nGenerating preText Scores...\nGenerating regression results..\nThe R^2 for this model is: 0.6375776 \nRegression results (negative coefficients imply less risk):\n                 Variable Coefficient    SE\n1               Intercept       0.170 0.010\n2      Remove Punctuation       0.036 0.007\n3          Remove Numbers       0.003 0.007\n4               Lowercase       0.001 0.007\n5                Stemming      -0.010 0.007\n6        Remove Stopwords      -0.087 0.007\n7 Remove Infrequent Terms       0.003 0.007\n8              Use NGrams      -0.011 0.007\nComplete in: 10.25 seconds...\n```\n:::\n\n```{.r .cell-code}\npreText_score_plot(preText_results)\n```\n\n::: {.cell-output-display}\n![](Blogpost4EthanCampbell_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Creating list of objects to put into the loop\nPrem <- c(\"Arsenal\", \"Manchester_City\", \"Newcastle_United\", \"Everton\", \"Leicester\", \"West_Ham_United\")\n\n# create loop.\nfor (i in 1:length(Prem)){\n  \n  # create corpora\n  corpusCall <- paste(Prem[i],\"_corpus <- corpus(\",Prem[i],\")\", sep = \"\")\n    #print(corpusCall)\n  eval(parse(text=corpusCall))\n   #print(corpusCall)\n\n  # change document names for each match to include team name. If you don't do this, the document names will be duplicated and you'll get an error.\n  namesCall <- paste(\"tmpNames <- docnames(\",Prem[i],\"_corpus)\", sep = \"\")\n  eval(parse(text=namesCall))\n  print(namesCall)\n  bindCall <- paste(\"docnames(\",Prem[i],\"_corpus) <- paste(\\\"\",Prem[i],\"\\\", tmpNames, sep = \\\"-\\\")\", sep = \"\")\n  eval(parse(text=bindCall))\n  print(bindCall)\n  # create summary data\n  summaryCall <- paste(Prem[i],\"_summary <- summary(\",Prem[i],\"_corpus)\", sep = \"\")\n  eval(parse(text=summaryCall))\n\n  # add indicator\n  bookCall <- paste(Prem[i],\"_summary$Team <- \\\"\",Prem[i],\"\\\"\", sep = \"\")\n  eval(parse(text=bookCall))\n\n  # add match indicator\n  chapterCall <- paste(Prem[i],\"_summary$Match <- as.numeric(str_extract(\",Prem[i],\"_summary$Text, \\\"[0-9]+\\\"))\", sep = \"\")\n  eval(parse(text=chapterCall))\n\n  # add meta data to each corpus\n  metaCall <- paste(\"docvars(\",Prem[i],\"_corpus) <- \",Prem[i],\"_summary\", sep = \"\")\n  eval(parse(text=metaCall))\n\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"tmpNames <- docnames(Arsenal_corpus)\"\n[1] \"docnames(Arsenal_corpus) <- paste(\\\"Arsenal\\\", tmpNames, sep = \\\"-\\\")\"\n[1] \"tmpNames <- docnames(Manchester_City_corpus)\"\n[1] \"docnames(Manchester_City_corpus) <- paste(\\\"Manchester_City\\\", tmpNames, sep = \\\"-\\\")\"\n[1] \"tmpNames <- docnames(Newcastle_United_corpus)\"\n[1] \"docnames(Newcastle_United_corpus) <- paste(\\\"Newcastle_United\\\", tmpNames, sep = \\\"-\\\")\"\n[1] \"tmpNames <- docnames(Everton_corpus)\"\n[1] \"docnames(Everton_corpus) <- paste(\\\"Everton\\\", tmpNames, sep = \\\"-\\\")\"\n[1] \"tmpNames <- docnames(Leicester_corpus)\"\n[1] \"docnames(Leicester_corpus) <- paste(\\\"Leicester\\\", tmpNames, sep = \\\"-\\\")\"\n[1] \"tmpNames <- docnames(West_Ham_United_corpus)\"\n[1] \"docnames(West_Ham_United_corpus) <- paste(\\\"West_Ham_United\\\", tmpNames, sep = \\\"-\\\")\"\n```\n:::\n\n```{.r .cell-code}\nPrem <- c(Arsenal_corpus, Manchester_City_corpus, Newcastle_United_corpus, Everton_corpus, Leicester_corpus, West_Ham_United_corpus)\n\nPrem_summary <- summary(Prem)\nndoc(Prem)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 198\n```\n:::\n\n```{.r .cell-code}\nArsenal_1 <- corpus_subset(Prem, Team == 'Arsenal')\n\nsummary(Arsenal_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCorpus consisting of 48 documents, showing 48 documents:\n\n           Text Types Tokens Sentences           Text Types Tokens Sentences\n  Arsenal-text1   474   1027        12  Arsenal-text1   474   1027        12\n  Arsenal-text2   561   1297        22  Arsenal-text2   561   1297        22\n  Arsenal-text3   517   1124        15  Arsenal-text3   517   1124        15\n  Arsenal-text4   429    894         9  Arsenal-text4   429    894         9\n  Arsenal-text5   408    790        12  Arsenal-text5   408    790        12\n  Arsenal-text6   438    916         6  Arsenal-text6   438    916         6\n  Arsenal-text7   490   1107        21  Arsenal-text7   490   1107        21\n  Arsenal-text8   500   1036        15  Arsenal-text8   500   1036        15\n  Arsenal-text9   479   1037        30  Arsenal-text9   479   1037        30\n Arsenal-text10   532   1179        27 Arsenal-text10   532   1179        27\n Arsenal-text11   586   1250        20 Arsenal-text11   586   1250        20\n Arsenal-text12   541   1169        20 Arsenal-text12   541   1169        20\n Arsenal-text13   517   1130        19 Arsenal-text13   517   1130        19\n Arsenal-text14   577   1283        44 Arsenal-text14   577   1283        44\n Arsenal-text15   624   1410        23 Arsenal-text15   624   1410        23\n Arsenal-text16   556   1212        23 Arsenal-text16   556   1212        23\n Arsenal-text17   737   1781        44 Arsenal-text17   737   1781        44\n Arsenal-text18   497   1090        19 Arsenal-text18   497   1090        19\n Arsenal-text19   746   1853        57 Arsenal-text19   746   1853        57\n Arsenal-text20   641   1398        19 Arsenal-text20   641   1398        19\n Arsenal-text21   537   1232        30 Arsenal-text21   537   1232        30\n Arsenal-text22   707   1618        34 Arsenal-text22   707   1618        34\n Arsenal-text23   695   1683        34 Arsenal-text23   695   1683        34\n Arsenal-text24   644   1601        54 Arsenal-text24   644   1601        54\n Arsenal-text25   695   1673        26 Arsenal-text25   695   1673        26\n Arsenal-text26   651   1614        35 Arsenal-text26   651   1614        35\n Arsenal-text27   696   1817        63 Arsenal-text27   696   1817        63\n Arsenal-text28   591   1361        25 Arsenal-text28   591   1361        25\n Arsenal-text29   640   1435        26 Arsenal-text29   640   1435        26\n Arsenal-text30   662   1607        32 Arsenal-text30   662   1607        32\n Arsenal-text31   632   1421        20 Arsenal-text31   632   1421        20\n Arsenal-text32   645   1501        20 Arsenal-text32   645   1501        20\n Arsenal-text33   720   1740        57 Arsenal-text33   720   1740        57\n Arsenal-text34   538   1208        29 Arsenal-text34   538   1208        29\n Arsenal-text35   639   1510        20 Arsenal-text35   639   1510        20\n Arsenal-text36   641   1444        26 Arsenal-text36   641   1444        26\n Arsenal-text37   570   1207        21 Arsenal-text37   570   1207        21\n Arsenal-text38   673   1616        47 Arsenal-text38   673   1616        47\n Arsenal-text39   699   1667        29 Arsenal-text39   699   1667        29\n Arsenal-text40   596   1338        18 Arsenal-text40   596   1338        18\n Arsenal-text41   607   1438        56 Arsenal-text41   607   1438        56\n Arsenal-text42   606   1492        38 Arsenal-text42   606   1492        38\n Arsenal-text43   601   1468        36 Arsenal-text43   601   1468        36\n Arsenal-text44   564   1287        31 Arsenal-text44   564   1287        31\n Arsenal-text45   608   1383        21 Arsenal-text45   608   1383        21\n Arsenal-text46   797   2027        51 Arsenal-text46   797   2027        51\n Arsenal-text47   268    495         9 Arsenal-text47   268    495         9\n Arsenal-text48   339    656        11 Arsenal-text48   339    656        11\n    Team Match\n Arsenal     1\n Arsenal     2\n Arsenal     3\n Arsenal     4\n Arsenal     5\n Arsenal     6\n Arsenal     7\n Arsenal     8\n Arsenal     9\n Arsenal    10\n Arsenal    11\n Arsenal    12\n Arsenal    13\n Arsenal    14\n Arsenal    15\n Arsenal    16\n Arsenal    17\n Arsenal    18\n Arsenal    19\n Arsenal    20\n Arsenal    21\n Arsenal    22\n Arsenal    23\n Arsenal    24\n Arsenal    25\n Arsenal    26\n Arsenal    27\n Arsenal    28\n Arsenal    29\n Arsenal    30\n Arsenal    31\n Arsenal    32\n Arsenal    33\n Arsenal    34\n Arsenal    35\n Arsenal    36\n Arsenal    37\n Arsenal    38\n Arsenal    39\n Arsenal    40\n Arsenal    41\n Arsenal    42\n Arsenal    43\n Arsenal    44\n Arsenal    45\n Arsenal    46\n Arsenal    47\n Arsenal    48\n```\n:::\n\n```{.r .cell-code}\nPrem_dfm <- dfm(tokens(Prem,\nremove_punct = TRUE,\nremove_symbols = TRUE) %>%\ndfm(tolower = TRUE) %>%\ndfm_remove(stopwords('english')))\n\ntopfeatures(Prem_dfm, 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      city     league    premier    minutes       ball       goal      first \n      1898       1244       1124        966        869        774        745 \n   everton     united       back      watch        win       game         de \n       611        551        549        548        523        516        501 \n    city's     second       home       side       half manchester \n       470        464        463        456        445        429 \n```\n:::\n\n```{.r .cell-code}\nfull_dfm_tfidf <- dfm_tfidf(Prem_dfm)\n\n# This mostly shows the team names and player names but with the world title it hints at the goal of each team\ntopfeatures(full_dfm_tfidf,50)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         city       everton         watch            de        city's \n    392.43063     275.90753     169.82161     162.09221     160.93866 \n        villa         leeds        bruyne           ham          gray \n    154.33943     151.39706     150.34573     127.02092     123.54291 \n    guardiola        palace          west   richarlison     everton's \n    121.78676     114.29461     113.24767     110.07369     110.03041 \n      watford       chelsea     leicester        wolves      sterling \n    109.93445     109.89875     109.71933     108.30484     108.23318 \n    newcastle         jesus         foden          read      bernardo \n    108.02438     107.70556     107.28971     106.26621     102.32610 \n       gordon      pickford     brentford    manchester         derby \n    100.59473     100.15736      99.73092      99.61689      98.16591 \n      arsenal           win       haaland      brighton       burnley \n     98.05475      97.31748      97.24989      93.32205      88.70924 \n            1         title      goodison     liverpool           man \n     87.88307      87.77516      86.82565      85.91413      85.80801 \n      magpies           1-0 calvert-lewin       norwich   southampton \n     84.29921      84.11740      84.10121      83.93424      83.06894 \n     morecity     important             v      grealish         aston \n     82.99645      81.40669      81.12535      80.17323      80.14958 \n```\n:::\n\n```{.r .cell-code}\nset.seed(1)\n\n# Creating a table to show the highest frequency items and then ranking them\nword_counts <- as.data.frame(sort(colSums(Prem_dfm),dec=T))\ncolnames(word_counts) <- c(\"Frequency\")\nword_counts$Rank <- c(1:ncol(Prem_dfm))\n\nggplot(word_counts, mapping = aes(x = Rank, y = Frequency)) + \n  geom_point() +\n  labs(title = \"Zipf's Law\", x = \"Rank\", y = \"Frequency\") + \n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](Blogpost4EthanCampbell_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\nPrem_smaller_dfm <- dfm_trim(Prem_dfm, min_termfreq = 10)\n\n# trim based on the proportion of documents that the feature appears in; here, \n# the feature needs to appear in more than 10% of documents (chapters)\nPrem_smaller_dfm <- dfm_trim(Prem_smaller_dfm, min_docfreq = 0.1, docfreq_type = \"prop\")\n\nPrem_smaller_dfm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDocument-feature matrix of: 198 documents, 1,004 features (75.14% sparse) and 6 docvars.\n               features\ndocs            gabriel header late goal got premier league campaign perfect\n  Arsenal-text1       2      2    1    6   1       9      8        3       1\n  Arsenal-text2       3      3    1    3   1       5      5        2       2\n  Arsenal-text3       3      1    2    8   1      10     11        0       0\n  Arsenal-text4       7      2    2    4   1       8      8        1       0\n  Arsenal-text5       4      0    0    5   1       7      9        0       1\n  Arsenal-text6       2      1    0    5   2       5      7        0       2\n               features\ndocs            start\n  Arsenal-text1     4\n  Arsenal-text2     2\n  Arsenal-text3     5\n  Arsenal-text4     3\n  Arsenal-text5     1\n  Arsenal-text6     2\n[ reached max_ndoc ... 192 more documents, reached max_nfeat ... 994 more features ]\n```\n:::\n\n```{.r .cell-code}\ntextplot_wordcloud(Prem_smaller_dfm, min_count = 50,\n                   random_order = FALSE)\n```\n\n::: {.cell-output-display}\n![](Blogpost4EthanCampbell_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Creating the FCM\n\nPrem_smaller_dfm <- dfm_trim(Prem_dfm, min_termfreq = 20)\nPrem_smaller_dfm <- dfm_trim(Prem_smaller_dfm, min_docfreq = .3, docfreq_type = \"prop\")\n\n# create fcm from dfm\nPrem_smaller_fcm <- fcm(Prem_smaller_dfm)\n\n# check the dimensions (i.e., the number of rows and the number of columnns)\n# of the matrix we created\ndim(Prem_smaller_fcm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 276 276\n```\n:::\n\n```{.r .cell-code}\n# pull the top features\nmyFeatures <- names(topfeatures(Prem_smaller_fcm, 30))\n\n# retain only those top features as part of our matrix\nPrem_smaller_fcm <- fcm_select(Prem_smaller_fcm, pattern = myFeatures, selection = \"keep\")\n\n# compute size weight for vertices in network\nsize <- log(colSums(Prem_smaller_fcm))\n\n# create plot\ntextplot_network(Prem_smaller_fcm, vertex_size = size / max(size) * 3)\n```\n\n::: {.cell-output-display}\n![](Blogpost4EthanCampbell_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n:::\n\n\n# Dictionary Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reading and converting the Brand dictionary into a dictionary object \nbp <- read.csv(\"brandp.csv\")\nbp <- as.list(bp)\nbp <- dictionary(bp)\n\n# Testing the Brand Dictionary\n#Brand_dictionary <- liwcalike(corp, bp)\n\n\n# Testing the sentiment dictionary\nTitles <- c(\"Arsenal\", \"Manchester_City\", \"Newcastle_United\", \"Everton\", \"Leicester\", \"West_Ham_United\")\n\nPrem_tidy <- list(Arsenal, Manchester_City, Newcastle_United, Everton, Leicester, West_Ham_United)\n\nseries <- tibble()\n\nfor(i in seq_along(Titles)) {\n        \n        clean <- tibble(Match = seq_along(Prem_tidy[[i]]),\n                        text = Prem_tidy[[i]]) %>%\n             unnest_tokens(word, text) %>%\n             mutate(Team = Titles[i]) %>%\n             select(Team, everything())\n\n        series <- rbind(series, clean)\n}\n\n# set factor to keep words in order for team and match\nseries$Team <- factor(series$Team, levels = rev(Titles))\n\nseries\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 224,027 × 3\n   Team    Match word      \n   <fct>   <int> <chr>     \n 1 Arsenal     1 a         \n 2 Arsenal     1 gabriel   \n 3 Arsenal     1 martinelli\n 4 Arsenal     1 header    \n 5 Arsenal     1 and       \n 6 Arsenal     1 a         \n 7 Arsenal     1 late      \n 8 Arsenal     1 marc      \n 9 Arsenal     1 guehi     \n10 Arsenal     1 own       \n# … with 224,017 more rows\n```\n:::\n\n```{.r .cell-code}\n# now we start the sentiment analysis with the dictionary nrc\n\nseries %>%\n        right_join(get_sentiments(\"nrc\")) %>%\n        filter(!is.na(sentiment)) %>%\n        count(sentiment, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"word\"\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 2\n   sentiment        n\n   <chr>        <int>\n 1 positive     13988\n 2 negative      9531\n 3 trust         6481\n 4 anticipation  6019\n 5 fear          5378\n 6 anger         5078\n 7 sadness       4112\n 8 joy           3921\n 9 surprise      3012\n10 disgust       2126\n```\n:::\n\n```{.r .cell-code}\n#  Breaking it up by every 500 words to say that is one match and then do a polarity test for each team \nseries %>%\n        group_by(Team) %>% \n        mutate(word_count = 1:n(),\n               index = word_count %/% 500 + 1) %>% \n        inner_join(get_sentiments(\"bing\")) %>%\n        count(Team, index = index , sentiment) %>%\n        ungroup() %>%\n        spread(sentiment, n, fill = 0) %>%\n        mutate(sentiment = positive - negative,\n               Team = factor(Team, levels = Titles)) %>%\n        ggplot(aes(index, sentiment, fill = Team)) +\n          geom_bar(alpha = 0.5, stat = \"identity\", show.legend = FALSE) +\n          facet_wrap(~ Team, ncol = 2, scales = \"free_x\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"word\"\n```\n:::\n\n::: {.cell-output-display}\n![](Blogpost4EthanCampbell_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# testing the other two sentiment packages in tidytext and comparing the differences to get a better feel for the actual sentiment\nafinn <- series %>%\n        group_by(Team) %>% \n        mutate(word_count = 1:n(),\n               index = word_count %/% 500 + 1) %>% \n        inner_join(get_sentiments(\"afinn\")) %>%\n        group_by(Team, index) %>%\n        summarise(sentiment = sum(value)) %>%\n        mutate(method = \"AFINN\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"word\"\n`summarise()` has grouped output by 'Team'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nbing_and_nrc <- bind_rows(series %>%\n                  group_by(Team) %>% \n                  mutate(word_count = 1:n(),\n                         index = word_count %/% 500 + 1) %>% \n                  inner_join(get_sentiments(\"bing\")) %>%\n                  mutate(method = \"Bing\"),\n          series %>%\n                  group_by(Team) %>% \n                  mutate(word_count = 1:n(),\n                         index = word_count %/% 500 + 1) %>%\n                  inner_join(get_sentiments(\"nrc\") %>%\n                                     filter(sentiment %in% c(\"positive\", \"negative\"))) %>%\n                  mutate(method = \"NRC\")) %>%\n        count(Team, method, index = index , sentiment) %>%\n        ungroup() %>%\n        spread(sentiment, n, fill = 0) %>%\n        mutate(sentiment = positive - negative) %>%\n        select(Team, index, method, sentiment)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"word\"\nJoining, by = \"word\"\n```\n:::\n\n```{.r .cell-code}\n# Visualization of the 3 different sentiment dictionaries and we can see how the teams compare over the course of the season\nbind_rows(afinn, \n          bing_and_nrc) %>%\n        ungroup() %>%\n        mutate(Team = factor(Team, levels = Titles)) %>%\n  ggplot(aes(index, sentiment, fill = method)) +\n  geom_bar(alpha = 0.8, stat = \"identity\", show.legend = FALSE) +\n  facet_grid(Team ~ method)\n```\n\n::: {.cell-output-display}\n![](Blogpost4EthanCampbell_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Here we can see that premier is skewing it more towards being positive as that is simply the name of the league\nbing_word_counts <- series %>%\n  inner_join(get_sentiments(\"bing\")) %>%\n  count(word, sentiment, sort = TRUE) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"word\"\n```\n:::\n\n```{.r .cell-code}\n# Removing premier from the analysis since it is incorrect\nbing_word_counts <- bing_word_counts %>%\n  filter(!row_number() %in% c(1))\n\nbing_word_counts %>%\n        group_by(sentiment) %>%\n        top_n(10) %>%\n        ggplot(aes(reorder(word, n), n, fill = sentiment)) +\n          geom_bar(alpha = 0.8, stat = \"identity\", show.legend = FALSE) +\n          facet_wrap(~sentiment, scales = \"free_y\") +\n          labs(y = \"Contribution to sentiment\", x = NULL) +\n          coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSelecting by n\n```\n:::\n\n::: {.cell-output-display}\n![](Blogpost4EthanCampbell_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n:::\n\n\n# Unsupervised Learning\n\n# Comparison\n\n# Visualization\n\n# Conclusion\n\n\n# Bibliography\n\n-   City, M. (2022). NEWS. Retrieved from Mancity: https://www.mancity.com/news/mens\n\n-   Club, L. F. (2022). First Team. Retrieved from Leicester Football Club: https://www.lcfc.com/matches/reports\n\n-   Club, T. A. (2022). NEWS. Retrieved from Arsenal: https://www.arsenal.com/news?field_article_arsenal_team_value=men&revision_information=&page=1\n\n-   Everton. (2022). Results. Retrieved from Everton: https://www.evertonfc.com/results\n\n-   United, N. (2022). Our Results. Retrieved from Newcastle United: https://www.nufc.co.uk/matches/first-team/#results\n\n-   United, W. H. (2022). Fixtures. Retrieved from West Ham United: https://www.whufc.com/fixture/list/713",
    "supporting": [
      "Blogpost4EthanCampbell_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}