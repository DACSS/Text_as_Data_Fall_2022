{
  "hash": "ad04cda1a31a176179e563aa402fe91e",
  "result": {
    "markdown": "---\ntitle: \"Blog 2-Sentiment Analysis on IRA and Healthcare Costs\"\nauthor: \"Rhowena Vespa\"\ndesription: \"Sentiment Analysis on POTUS Twitter Replies\"\ndate: \"10/02/2022\"\neditor: visual\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Healthcare cost\n  - Twitter\n  - Rhowena Vespa\n  - Blog Post 2\n  - Sentiment Analysis\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(quarto)\nlibrary(quanteda)\nlibrary(quanteda.textplots)\nlibrary(lubridate)\nlibrary(tm) \nlibrary(tidytext) \nlibrary(dplyr)\nlibrary(corpus) \nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(syuzhet) \nlibrary(stringr)\nlibrary(tidyr)\nlibrary(DT)\nlibrary(RColorBrewer)\n\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\n```\n:::\n\n\n## Research topic\n\nThis research revolves around text analytics and healthcare costs. Specifically, I wanted to focus on analyzing **replies to a specific tweet** on a specific social science topic.\n\nAccording to the government, the Inflation Reduction Act of 2022 (IRA 2022) will cut prescription drug costs and lower overall healthcare costs. Unfortunately, the US healthcare system is very complex and the political divide among Americans view the IRA differently.\n\nOn October 15, 2022 at 9:10am, POTUS tweeted \"With the Inflation Reduction Act, the American people won and Big Pharma lost.\" At the time of this writing, this tweet has generated 7,301 replies, 5,016 retweet and 25.5K likes.\n\nAt first glance, my impression of this specific @POTUS tweet is positive. My research looks into the sentiments of all the Tweet replies (including replies to replies) to this specific \\$POTUS tweet.\n\n        1. Do the responses imply trust on @POTUS?\n        2. Is public opinion positive?\n        3. Are there specific words that trigger positive or negative sentiments?\n\n## Data\n\nCorpus is composed of **9497 twitter replies (all conversation threads)** from @POTUS tweet on October 15, 2022 saying \"With the Inflation Reduction Act, the American people won and Big Pharma lost.\" Twarc package in python was used to extract the conversation threads of this specific tweet.\n\n### Data Pre-Processing\n\n            1. Data extracted as jsonl, converted to csv\n            2. Tweet replies isolated and cleaned.\n            3. Cleaning: \n                  remove stopwords, \n                  lowercase\n                  remove twitter handles\n                  remove \"POTUS\" \"joe\" \"biden\" \"inflation\" \"big\" \"pharma\"\n                  remove punctuation\n                  remove retweet\n                  remove numbers\n                  remove white spaces\n                  & converted to 'amp', remove \"amp\"\n            4. Stemming\n            \n            \n\n## Analysis -Word cloud, Sentiment Analysis\n\nWord cloud was used to get visualization on most used words. Sentiment analysis using NRC as I wanted 8 specific emotions namely anger, fear, anticipation, trust, surprise, sadness, joy, disgust and positve or negative sentiment.\n\n## Results\n\nInitial results was surprising. Most replies evoked **trust** to @POTUS tweet about the IRA and its effects on the people and Big Pharma. However, it was very surprising that **sadness** and **anger** were the next 2 prominent emotions from this tweet.\\\nIt was also unexpected that the tweet had an overall **negative sentiment** based on average sentiment scores.\n\n## Challenges\n\nI had a difficult time sourcing data. Initial attempts to parse PUBMED and EMBASE. The Open-Access subsets were limited in terms of my research topic of sentiments on healthcare costs in the US. Due to time constraints, I did not find it practical hand-pick and parse 50+ pdfs, some requiring paid subscriptions. With this, I decided to go straight to the source- tweet responses. Extracting twitter replies was a steep, but fun, learning curve for me. Initially , I used the academictwitteR package in R but my dataframe kept coming up empty. I switched to python and found the twarc package much easier.\n\n## Future work\n\nWith this initial analysis, I would like to examine the replies closely and conduct a toxic comment classification. I would like to use classifiers to predict if a twitter response is toxic. I will continue to pre-process the data to remove emojis and non-english words.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in data\n\nIRA.csv <- read.csv(\"IRA_med.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_df <- as.data.frame(IRA.csv) #convert csv to df\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#standardize dates\nIRA_df$created_at <- ymd_hms(IRA_df$created_at) \nIRA_df$created_at <- with_tz(IRA_df$created_at,\"America/New_York\")\nIRA_df$created_date <- as.Date(IRA_df$created_at)\n```\n:::\n\n\nnew df\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_text <- IRA_df %>%\n  select (\"text\", created_date) #new dataframe isolate text column \n```\n:::\n\n\nremove @twitter handles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_text$text <- gsub(\"@[[:alpha:]]*\",\"\", IRA_text$text) #remove Twitter handles\n```\n:::\n\n\ntext mining and cleaning - lowercase, remove common words, stop words, punctuation, retweet, & =amp and numbers\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_corpus <- Corpus(VectorSource(IRA_text$text))\nIRA_corpus <- tm_map(IRA_corpus, tolower) #lowercase\nIRA_corpus <- tm_map(IRA_corpus, removeWords, \n                      c(\"joe\", \"biden\",\"potus\", \"big\", \"pharma\",\"inflation\", \"rt\", \"amp\"))\nIRA_corpus <- tm_map(IRA_corpus, removeWords, \n                      stopwords(\"en\"))\nIRA_corpus <- tm_map(IRA_corpus, removePunctuation)\nIRA_corpus <- tm_map(IRA_corpus, stripWhitespace)\nIRA_corpus <- tm_map(IRA_corpus, removeNumbers)\n```\n:::\n\n\nconvert cleaned data back to data frame\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_text_df <- data.frame(IRA_text_clean = get(\"content\", IRA_corpus),  \n                      stringsAsFactors = FALSE)\n```\n:::\n\n\ntokenize\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_tidy <- IRA_text_df %>%\n  unnest_tokens(word, IRA_text_clean)\nIRA_tidy <- rename(IRA_tidy, text = word)\nIRA_tokens <-text_tokens(IRA_tidy)\n```\n:::\n\n\nStemming\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_tokens <- tokens(IRA_tokens) \nIRA_tokens <- tokens_wordstem(IRA_tokens)\n```\n:::\n\n\nWord Cloud\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndfm_IRA <- corpus(as.character(IRA_tokens)) %>%\n    dfm(remove = stopwords('english'), remove_punct = TRUE) %>%\n    dfm_trim(min_termfreq = 10, verbose = FALSE)\n\ntextplot_wordcloud(dfm_IRA, scale=c(5,1), max.words=50, random.order=FALSE, rot.per=0.35, use.r.layout=FALSE, colors=brewer.pal(8, \"Dark2\"))\n```\n\n::: {.cell-output-display}\n![](IRA_Blog2_Vespa_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_Sentiment <- get_nrc_sentiment(as.character(IRA_text_df$IRA_text_clean)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_td<-data.frame(t(IRA_Sentiment)) #transpose\nIRA_td_new <- data.frame(rowSums(IRA_td[2:9497]))\nIRA_td_mean <- data.frame(rowMeans(IRA_td[2:9497]))#get mean of sentiment values\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Transformation and cleaning\nnames(IRA_td_new)[1] <- \"Count\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_td_new <- cbind(\"sentiment\" = rownames(IRA_td_new), IRA_td_new)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrownames(IRA_td_new) <- NULL\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_td_new2<-IRA_td_new[1:8,]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Plot One - Count of words associated with each sentiment\nquickplot(sentiment, data=IRA_td_new2, weight=Count, geom=\"bar\", fill=sentiment, ylab=\"count\")+ggtitle(\"Emotions to @POTUS Tweet\")\n```\n\n::: {.cell-output-display}\n![](IRA_Blog2_Vespa_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(IRA_td_mean)[1] <- \"Mean\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_td_mean <- cbind(\"sentiment\" = rownames(IRA_td_mean), IRA_td_mean)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrownames(IRA_td_mean) <- NULL\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_td_mean2<-IRA_td_mean[9:10,]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Plot One - Count of words associated with each sentiment\nquickplot(sentiment, data=IRA_td_mean2, weight=Mean, geom=\"bar\", fill=sentiment, ylab=\"Mean Sentiment Score\")+ggtitle(\"Sentiments to @POTUS Tweet\")\n```\n\n::: {.cell-output-display}\n![](IRA_Blog2_Vespa_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n## REFERENCES\n\n        1. House, T., 2022. BY THE NUMBERS: The Inflation Reduction Act - The White House. [online] The White House. Available at: <https://www.whitehouse.gov/briefing-room/statements-releases/2022/08/15/by-the-numbers-the-inflation-reduction-act/> [Accessed 15 October 2022].\n        2. Biden, P. (2022, October 15). We pay more for our prescription drugs than any other nation in the world. it's outrageous. but now, instead of money going into the pockets of drug companies, it will go into your pockets in the form of lower drug prices. Twitter. Retrieved October 15, 2022, from https://twitter.com/POTUS/status/1581374573815431168 \n        3. Robinson, J. S. and D. (n.d.). Welcome to text mining with r: Text mining with R. Welcome to Text Mining with R | Text Mining with R. Retrieved October 15, 2022, from https://www.tidytextmining.com/ \n",
    "supporting": [
      "IRA_Blog2_Vespa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}