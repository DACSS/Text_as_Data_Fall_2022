{
  "hash": "948180bc60bb37ef595f08cce7bcca0d",
  "result": {
    "markdown": "---\ntitle: \"Blog 4 -Supervised Learning Part 1\"\nauthor: \"Rhowena Vespa\"\ndesription: \"Dictionary and Polarity scores\"\ndate: \"10/29/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Blog 4\n  - Polarity1\n  - dictionary\n  - healthcare\n  - supervised learning\n  - ggplot2\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: package or namespace load failed for 'readr' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: package or namespace load failed for 'dplyr' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n```{.r .cell-code}\nlibrary(quanteda)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPackage version: 3.2.3\nUnicode version: 13.0\nICU version: 69.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nParallel computing: 8 of 8 threads used.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSee https://quanteda.io for tutorials and examples.\n```\n:::\n\n```{.r .cell-code}\nlibrary(quanteda.textstats)\nlibrary(quanteda.textplots)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: package or namespace load failed for 'quanteda.textplots' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: package or namespace load failed for 'ggplot2' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n```{.r .cell-code}\nlibrary(DT)\nlibrary(tm)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: NLP\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'NLP'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:quanteda':\n\n    meta, meta<-\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tm'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:quanteda':\n\n    stopwords\n```\n:::\n\n```{.r .cell-code}\nlibrary(stringr)\nlibrary(tidytext)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: package or namespace load failed for 'tidytext' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n```{.r .cell-code}\nlibrary(plyr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: package or namespace load failed for 'tidyverse' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n```{.r .cell-code}\nlibrary(quanteda.textmodels)\nlibrary(devtools)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: usethis\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nError: package or namespace load failed for 'usethis' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError: package 'usethis' could not be loaded\n```\n:::\n\n```{.r .cell-code}\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nError: package or namespace load failed for 'ggplot2' in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]]):\n namespace 'rlang' 1.0.4 is already loaded, but >= 1.0.6 is required\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError: package 'ggplot2' could not be loaded\n```\n:::\n\n```{.r .cell-code}\nlibrary(quanteda.dictionaries)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(quanteda.dictionaries): there is no package called 'quanteda.dictionaries'\n```\n:::\n\n```{.r .cell-code}\n#library(devtools)\n#devtools::install_github(\"kbenoit/quanteda.dictionaries\")\nlibrary(quanteda.dictionaries)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(quanteda.dictionaries): there is no package called 'quanteda.dictionaries'\n```\n:::\n\n```{.r .cell-code}\nlibrary(syuzhet) \n#remotes::install_github(\"quanteda/quanteda.sentiment\")\nlibrary(quanteda.sentiment)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(quanteda.sentiment): there is no package called 'quanteda.sentiment'\n```\n:::\n:::\n\n\n\nThis 4th Blog starts work on supervised machine learning from week 7 and 8. Using tweet replies as corpus,\nsentiment scores, polarity scores are calculated and visualized.\n\nSupervised machine learning will continue on next blog post to build models for polarity classification\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in data\n\nIRA<- read_csv(\"IRA_med.csv\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in read_csv(\"IRA_med.csv\"): could not find function \"read_csv\"\n```\n:::\n\n```{.r .cell-code}\n#remove @twitter handles\nIRA$text <- gsub(\"@[[:alpha:]]*\",\"\", IRA$text) #remove Twitter handles\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.factor(x): object 'IRA' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_corpus <- corpus(IRA,text_field = \"text\")   \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in corpus(IRA, text_field = \"text\"): object 'IRA' not found\n```\n:::\n:::\n\n\n#tokenize and stemming\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_tokens <- tokens(IRA_corpus)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in tokens(IRA_corpus): object 'IRA_corpus' not found\n```\n:::\n\n```{.r .cell-code}\nIRA_tokens <- tokens_wordstem(IRA_tokens)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in tokens_wordstem(IRA_tokens): object 'IRA_tokens' not found\n```\n:::\n:::\n\n\n\n# USING LECTURE week8 --NRC sentiment\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use liwcalike() to estimate sentiment using NRC dictionary\nIRAreviewSentiment_nrc <- liwcalike(IRA_corpus, data_dictionary_NRC)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in liwcalike(IRA_corpus, data_dictionary_NRC): could not find function \"liwcalike\"\n```\n:::\n\n```{.r .cell-code}\nnames(IRAreviewSentiment_nrc)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRAreviewSentiment_nrc' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(IRAreviewSentiment_nrc) +\n  geom_histogram(aes(x = positive)) +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(IRAreviewSentiment_nrc): could not find function \"ggplot\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_corpus[which(IRAreviewSentiment_nrc$positive > 15)]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRA_corpus' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(IRAreviewSentiment_nrc) +\n  geom_histogram(aes(x = negative)) +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(IRAreviewSentiment_nrc): could not find function \"ggplot\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRA_corpus[which(IRAreviewSentiment_nrc$negative > 15)]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRA_corpus' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a full dfm for comparison\nIRA_Dfm <- tokens(IRA_corpus,\n                         remove_punct = TRUE,\n                         remove_symbols = TRUE,\n                         remove_numbers = TRUE,\n                         remove_url = TRUE,\n                         split_hyphens = FALSE,\n                         include_docvars = TRUE) %>%\n  tokens_tolower() %>%\n  dfm()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in tokens(IRA_corpus, remove_punct = TRUE, remove_symbols = TRUE, : object 'IRA_corpus' not found\n```\n:::\n\n```{.r .cell-code}\nhead(IRA_Dfm, 10)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in head(IRA_Dfm, 10): object 'IRA_Dfm' not found\n```\n:::\n\n```{.r .cell-code}\ndim(IRA_Dfm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRA_Dfm' not found\n```\n:::\n\n```{.r .cell-code}\n# convert corpus to dfm using the dictionary\nIRADfm_nrc <- tokens(IRA_corpus,\n                         remove_punct = TRUE,\n                         remove_symbols = TRUE,\n                         remove_numbers = TRUE,\n                         remove_url = TRUE,\n                         split_hyphens = FALSE,\n                         include_docvars = TRUE) %>%\n  tokens_tolower() %>%\n  dfm() %>%\n  dfm_lookup(data_dictionary_NRC)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in tokens(IRA_corpus, remove_punct = TRUE, remove_symbols = TRUE, : object 'IRA_corpus' not found\n```\n:::\n\n```{.r .cell-code}\ndim(IRADfm_nrc)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRADfm_nrc' not found\n```\n:::\n\n```{.r .cell-code}\nhead(IRADfm_nrc, 10)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in head(IRADfm_nrc, 10): object 'IRADfm_nrc' not found\n```\n:::\n\n```{.r .cell-code}\nclass(IRADfm_nrc)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRADfm_nrc' not found\n```\n:::\n:::\n\n\n# POLARITY\n\n::: {.cell}\n\n```{.r .cell-code}\nIRAdf_nrc <- convert(IRADfm_nrc, to = \"data.frame\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in convert(IRADfm_nrc, to = \"data.frame\"): object 'IRADfm_nrc' not found\n```\n:::\n\n```{.r .cell-code}\nnames(IRAdf_nrc)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRAdf_nrc' not found\n```\n:::\n\n```{.r .cell-code}\nIRAdf_nrc$polarity <- (IRAdf_nrc$positive - IRAdf_nrc$negative)/(IRAdf_nrc$positive + IRAdf_nrc$negative)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRAdf_nrc' not found\n```\n:::\n\n```{.r .cell-code}\nIRAdf_nrc$polarity[(IRAdf_nrc$positive + IRAdf_nrc$negative) == 0] <- 0\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in IRAdf_nrc$polarity[(IRAdf_nrc$positive + IRAdf_nrc$negative) == : object 'IRAdf_nrc' not found\n```\n:::\n\n```{.r .cell-code}\nggplot(IRAdf_nrc) +\n  geom_histogram(aes(x=polarity)) +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(IRAdf_nrc): could not find function \"ggplot\"\n```\n:::\n:::\n\n\n# NEW DATAFRAME WITH TEXT AND POLARITY\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRAdf_nrc_CBIND <- as.data.frame(cbind(IRAdf_nrc, IRA_text_df))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in cbind(IRAdf_nrc, IRA_text_df): object 'IRAdf_nrc' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRAdf_nrc_CBIND <- as.character(IRAdf_nrc_CBIND)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRAdf_nrc_CBIND' not found\n```\n:::\n\n```{.r .cell-code}\ntypeof(IRAdf_nrc_CBIND)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in typeof(IRAdf_nrc_CBIND): object 'IRAdf_nrc_CBIND' not found\n```\n:::\n:::\n\n\n# NEW CORPUS with polarity scores\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRApolarity_corpus <- corpus(IRAdf_nrc_CBIND)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in corpus(IRAdf_nrc_CBIND): object 'IRAdf_nrc_CBIND' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwriteLines(head(IRA_corpus[which(IRAdf_nrc$polarity == 1)]))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in head(IRA_corpus[which(IRAdf_nrc$polarity == 1)]): object 'IRA_corpus' not found\n```\n:::\n:::\n\n\n\n# APPLY DICTIONARY within context\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# tokenize corpus\nIRAtokens <- tokens(IRA_corpus, remove_punct = TRUE)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in tokens(IRA_corpus, remove_punct = TRUE): object 'IRA_corpus' not found\n```\n:::\n\n```{.r .cell-code}\n# what are the context (target) words or phrases\nIRA_words <- c(\"inflation\",\"POTUS\", \"price*\",\"joe\", \"biden\", \"trump\",\"medicare\",\"drug\",\"cost\",\"america*\",\"won\",\"lost\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# retain only our tokens and their context\nIRAtokens_HC <- tokens_keep(IRAtokens, pattern = phrase(IRA_words), window = 40)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in tokens_select(x, ..., selection = \"keep\"): object 'IRAtokens' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nIRAdata_dictionary_LSD2015_pos_neg <- data_dictionary_LSD2015[1:2]\n\nIRAtokens_HC_lsd <- tokens_lookup(IRAtokens_HC,\n                               dictionary = data_dictionary_LSD2015_pos_neg)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in tokens_lookup(IRAtokens_HC, dictionary = data_dictionary_LSD2015_pos_neg): object 'IRAtokens_HC' not found\n```\n:::\n:::\n\n\n# COnvert to dfm\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIRAdfm_HC <- dfm(IRAtokens_HC_lsd)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in dfm(IRAtokens_HC_lsd): object 'IRAtokens_HC_lsd' not found\n```\n:::\n\n```{.r .cell-code}\nhead(IRAdfm_HC, 10)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in head(IRAdfm_HC, 10): object 'IRAdfm_HC' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# convert to data frame\nIRAmat_HC <- convert(IRAdfm_HC, to = \"data.frame\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in convert(IRAdfm_HC, to = \"data.frame\"): object 'IRAdfm_HC' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# drop if both features are 0\nIRAmat_HC <- IRAmat_HC[-which((IRAmat_HC$negative + IRAmat_HC$positive)==0),]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRAmat_HC' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# print a little summary info\npaste(\"We have \",nrow(IRAmat_HC),\" tweets replies that mention positive or negative words in the context of Inflation terms.\", sep=\"\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in nrow(IRAmat_HC): object 'IRAmat_HC' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create polarity scores\nIRAmat_HC$polarity <- (IRAmat_HC$positive - IRAmat_HC$negative)/(IRAmat_HC$positive + IRAmat_HC$negative)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'IRAmat_HC' not found\n```\n:::\n\n```{.r .cell-code}\n# summary\nsummary(IRAmat_HC$polarity)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(IRAmat_HC$polarity): object 'IRAmat_HC' not found\n```\n:::\n\n```{.r .cell-code}\n# plot\nggplot(IRAmat_HC) + \n  geom_histogram(aes(x=polarity)) + \n  theme_bw()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(IRAmat_HC): could not find function \"ggplot\"\n```\n:::\n:::\n\n\n\n\n## REFERENCES\n\n        1. House, T., 2022. BY THE NUMBERS: The Inflation Reduction Act - The White House. [online] The White House. Available at: <https://www.whitehouse.gov/briefing-room/statements-releases/2022/08/15/by-the-numbers-the-inflation-reduction-act/> [Accessed 15 October 2022].\n        2. Biden, P. (2022, October 15). We pay more for our prescription drugs than any other nation in the world. it's outrageous. but now, instead of money going into the pockets of drug companies, it will go into your pockets in the form of lower drug prices. Twitter. Retrieved October 15, 2022, from https://twitter.com/POTUS/status/1581374573815431168 \n        3. Robinson, J. S. and D. (n.d.). Welcome to text mining with r: Text mining with R. Welcome to Text Mining with R | Text Mining with R. Retrieved October 15, 2022, from https://www.tidytextmining.com/ \n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}