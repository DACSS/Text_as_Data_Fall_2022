<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rhowena Vespa">
<meta name="dcterms.date" content="2022-11-06">

<title>Text-as-Data Fall 2022 - Blog 5-Twitter Engagement Analysis of MA Gubernatorial Candidates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta name="twitter:title" content="Text-as-Data Fall 2022 - Blog 5-Twitter Engagement Analysis of MA Gubernatorial Candidates">
<meta name="twitter:description" content="This project analyzes Twitter engagement of specific Massachusetts GOvernor Candidates namely Maura Healey and Geoff Diehl.">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Text-as-Data Fall 2022</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/Text_as_Data_Fall_2022/">
 <span class="menu-text">Fall 2022</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/Text_as_Data_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">LOAD PACKAGES</a></li>
  <li><a href="#healey-data" id="toc-healey-data" class="nav-link" data-scroll-target="#healey-data">Healey DATA</a>
  <ul class="collapse">
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load Data</a></li>
  <li><a href="#data-cleaning-preprocessing" id="toc-data-cleaning-preprocessing" class="nav-link" data-scroll-target="#data-cleaning-preprocessing">Data Cleaning/ Preprocessing</a></li>
  <li><a href="#tokenize-and-stemming" id="toc-tokenize-and-stemming" class="nav-link" data-scroll-target="#tokenize-and-stemming">Tokenize and stemming</a></li>
  <li><a href="#create-dfm" id="toc-create-dfm" class="nav-link" data-scroll-target="#create-dfm">Create dfm</a></li>
  <li><a href="#tf-idf" id="toc-tf-idf" class="nav-link" data-scroll-target="#tf-idf">TF-IDF</a></li>
  <li><a href="#word-cloud" id="toc-word-cloud" class="nav-link" data-scroll-target="#word-cloud">Word Cloud</a></li>
  <li><a href="#feature-occurence-matrix" id="toc-feature-occurence-matrix" class="nav-link" data-scroll-target="#feature-occurence-matrix">Feature-Occurence Matrix</a></li>
  <li><a href="#semantic-network-visualization" id="toc-semantic-network-visualization" class="nav-link" data-scroll-target="#semantic-network-visualization">Semantic Network Visualization</a></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis">Sentiment Analysis</a>
  <ul class="collapse">
  <li><a href="#nrc-dictionary" id="toc-nrc-dictionary" class="nav-link" data-scroll-target="#nrc-dictionary">NRC Dictionary</a></li>
  </ul></li>
  <li><a href="#polarity-scores" id="toc-polarity-scores" class="nav-link" data-scroll-target="#polarity-scores">Polarity scores</a></li>
  <li><a href="#new-df-with-polarity-scores" id="toc-new-df-with-polarity-scores" class="nav-link" data-scroll-target="#new-df-with-polarity-scores">New DF with Polarity scores</a></li>
  <li><a href="#new-corpus-polaritytext" id="toc-new-corpus-polaritytext" class="nav-link" data-scroll-target="#new-corpus-polaritytext">New CORPUS (Polarity+text)</a>
  <ul class="collapse">
  <li><a href="#omit-na" id="toc-omit-na" class="nav-link" data-scroll-target="#omit-na">Omit na</a></li>
  <li><a href="#convert-cleaned-df-to-corpus" id="toc-convert-cleaned-df-to-corpus" class="nav-link" data-scroll-target="#convert-cleaned-df-to-corpus">Convert cleaned DF to corpus</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#healey--machine-learning-methods" id="toc-healey--machine-learning-methods" class="nav-link" data-scroll-target="#healey--machine-learning-methods">HEALEY- MACHINE LEARNING METHODS</a>
  <ul class="collapse">
  <li><a href="#nb-model" id="toc-nb-model" class="nav-link" data-scroll-target="#nb-model">NB model</a>
  <ul class="collapse">
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">CONFUSION MATRIX</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#naive-bayes--held-out" id="toc-naive-bayes--held-out" class="nav-link" data-scroll-target="#naive-bayes--held-out">Naive Bayes -held out</a>
  <ul class="collapse">
  <li><a href="#svm" id="toc-svm" class="nav-link" data-scroll-target="#svm">SVM</a>
  <ul class="collapse">
  <li><a href="#confusion-matrix-1" id="toc-confusion-matrix-1" class="nav-link" data-scroll-target="#confusion-matrix-1">Confusion Matrix</a></li>
  </ul></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest">RANDOM FOREST</a>
  <ul class="collapse">
  <li><a href="#confusion-matrix-2" id="toc-confusion-matrix-2" class="nav-link" data-scroll-target="#confusion-matrix-2">Confusion Matrix</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#diehl-data" id="toc-diehl-data" class="nav-link" data-scroll-target="#diehl-data">DIEHL DATA</a>
  <ul class="collapse">
  <li><a href="#load-data-1" id="toc-load-data-1" class="nav-link" data-scroll-target="#load-data-1">Load Data</a></li>
  <li><a href="#data-cleaning-preprocessing-1" id="toc-data-cleaning-preprocessing-1" class="nav-link" data-scroll-target="#data-cleaning-preprocessing-1">Data Cleaning/ Preprocessing</a></li>
  <li><a href="#tokenize-and-stemming-1" id="toc-tokenize-and-stemming-1" class="nav-link" data-scroll-target="#tokenize-and-stemming-1">Tokenize and stemming</a></li>
  <li><a href="#create-dfm-1" id="toc-create-dfm-1" class="nav-link" data-scroll-target="#create-dfm-1">Create dfm</a></li>
  <li><a href="#tf-idf-1" id="toc-tf-idf-1" class="nav-link" data-scroll-target="#tf-idf-1">TF-IDF</a></li>
  <li><a href="#word-cloud-1" id="toc-word-cloud-1" class="nav-link" data-scroll-target="#word-cloud-1">Word CLoud</a></li>
  <li><a href="#feature-occurrence-matrix" id="toc-feature-occurrence-matrix" class="nav-link" data-scroll-target="#feature-occurrence-matrix">Feature-occurrence matrix</a></li>
  <li><a href="#semantic-network-analysis" id="toc-semantic-network-analysis" class="nav-link" data-scroll-target="#semantic-network-analysis">Semantic Network Analysis</a></li>
  <li><a href="#sentiment-analysis-1" id="toc-sentiment-analysis-1" class="nav-link" data-scroll-target="#sentiment-analysis-1">Sentiment Analysis</a>
  <ul class="collapse">
  <li><a href="#nrc-dictionary-1" id="toc-nrc-dictionary-1" class="nav-link" data-scroll-target="#nrc-dictionary-1">NRC Dictionary</a></li>
  </ul></li>
  <li><a href="#polarity-scores-1" id="toc-polarity-scores-1" class="nav-link" data-scroll-target="#polarity-scores-1">Polarity Scores</a></li>
  <li><a href="#bind-to-new-df" id="toc-bind-to-new-df" class="nav-link" data-scroll-target="#bind-to-new-df">Bind to new DF</a></li>
  <li><a href="#subset-to-polarity-and-text" id="toc-subset-to-polarity-and-text" class="nav-link" data-scroll-target="#subset-to-polarity-and-text">subset to polarity and text</a></li>
  <li><a href="#cleaned-df" id="toc-cleaned-df" class="nav-link" data-scroll-target="#cleaned-df">Cleaned DF</a></li>
  <li><a href="#new-corpus-with-polarity-scores" id="toc-new-corpus-with-polarity-scores" class="nav-link" data-scroll-target="#new-corpus-with-polarity-scores">New Corpus with polarity scores</a></li>
  </ul></li>
  <li><a href="#diehl-machine-learning" id="toc-diehl-machine-learning" class="nav-link" data-scroll-target="#diehl-machine-learning">DIEHL-MACHINE LEARNING</a>
  <ul class="collapse">
  <li><a href="#nb-model-1" id="toc-nb-model-1" class="nav-link" data-scroll-target="#nb-model-1">NB model</a>
  <ul class="collapse">
  <li><a href="#confusion-matrix-3" id="toc-confusion-matrix-3" class="nav-link" data-scroll-target="#confusion-matrix-3">CONFUSION MATRIX</a></li>
  </ul></li>
  <li><a href="#svm-1" id="toc-svm-1" class="nav-link" data-scroll-target="#svm-1">SVM</a>
  <ul class="collapse">
  <li><a href="#run-model" id="toc-run-model" class="nav-link" data-scroll-target="#run-model">run model</a></li>
  </ul></li>
  <li><a href="#random-forest-1" id="toc-random-forest-1" class="nav-link" data-scroll-target="#random-forest-1">RANDOM FOREST</a></li>
  <li><a href="#naive-bayes--held-out-1" id="toc-naive-bayes--held-out-1" class="nav-link" data-scroll-target="#naive-bayes--held-out-1">Naive Bayes -Held out</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Blog 5-Twitter Engagement Analysis of MA Gubernatorial Candidates</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Blog 5</div>
    <div class="quarto-category">Twitter Replies</div>
    <div class="quarto-category">Twarc2</div>
    <div class="quarto-category">Rhowena Vespa</div>
    <div class="quarto-category">Massachusetts Gubernatorial Elections</div>
    <div class="quarto-category">Healey</div>
    <div class="quarto-category">Diehl</div>
    <div class="quarto-category">Supervised Machine Learning</div>
    <div class="quarto-category">Sentiment Analysis</div>
    <div class="quarto-category">TF-IDF</div>
    <div class="quarto-category">Semantic Network</div>
    <div class="quarto-category">Naive Bayes</div>
    <div class="quarto-category">Support Vector Machines</div>
    <div class="quarto-category">Random Forest</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rhowena Vespa </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">StringsAsFActors=</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This project analyzes Twitter engagement of specific Massachusetts GOvernor Candidates namely Maura Healey and Geoff Diehl. CORPUS: Extracted twitter replies (Oct 29 to Nov 4) from all of Healey and Diehl’s tweets. The replies looks into how these candidates engages other twitter users by generating a response to their original tweet or retweet. The replies are then cleaned and pre-processed. Analysis: Initial Data visualization (word cloud) TF-IDF Semantic Network Analysis Sentiment Analysis + Polarity SML -Naive Bayes, SVM, Random Forest</p>
<p>I wanted to analyze twitter engagement and correlate it with poll results With the election coming up, I would also like to correlate my analysis with actual election results.</p>
<section id="load-packages" class="level1">
<h1>LOAD PACKAGES</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.6      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Package version: 3.2.3
Unicode version: 13.0
ICU version: 69.1
Parallel computing: 8 of 8 threads used.
See https://quanteda.io for tutorials and examples.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textstats)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textplots)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: NLP

Attaching package: 'NLP'

The following objects are masked from 'package:quanteda':

    meta, meta&lt;-

The following object is masked from 'package:ggplot2':

    annotate


Attaching package: 'tm'

The following object is masked from 'package:quanteda':

    stopwords</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------
You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)
------------------------------------------------------------------------------

Attaching package: 'plyr'

The following objects are masked from 'package:dplyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize

The following object is masked from 'package:purrr':

    compact</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textmodels)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: usethis</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.dictionaries)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(devtools)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("kbenoit/quanteda.dictionaries")</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.dictionaries)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(syuzhet) </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("quanteda/quanteda.sentiment")</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.sentiment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'quanteda.sentiment'

The following object is masked from 'package:quanteda':

    data_dictionary_LSD2015</code></pre>
</div>
</div>
</section>
<section id="healey-data" class="level1">
<h1>Healey DATA</h1>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Healy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Healy.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1900 Columns: 79
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (33): edit_history_tweet_ids, text, lang, source, reply_settings, entit...
dbl  (18): id, conversation_id, referenced_tweets.replied_to.id, referenced_...
lgl  (24): referenced_tweets.retweeted.id, edit_controls.is_edit_eligible, r...
dttm  (4): edit_controls.editable_until, created_at, author.created_at, __tw...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"@[[:alpha:]]*"</span>,<span class="st">""</span>, Healy<span class="sc">$</span>text) <span class="co">#remove Twitter handles</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"&amp;amp"</span>, <span class="st">""</span>, Healy<span class="sc">$</span>text)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"healey"</span>, <span class="st">""</span>, Healy<span class="sc">$</span>text)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">""</span>, Healy<span class="sc">$</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-cleaning-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-preprocessing">Data Cleaning/ Preprocessing</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(Healy<span class="sc">$</span>text))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, tolower) <span class="co">#lowercase</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removeWords, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"s"</span>,<span class="st">"healey"</span>, <span class="st">"healy"</span>,<span class="st">"maura"</span>,<span class="st">"rt"</span>, <span class="st">"amp"</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removeWords, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removePunctuation)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, stripWhitespace)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removeNumbers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenize-and-stemming" class="level2">
<h2 class="anchored" data-anchor-id="tokenize-and-stemming">Tokenize and stemming</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(Healy_corpus,<span class="at">text_field =</span> <span class="st">"text"</span>) </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Healy_text_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Healy_corpus)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>Healy_tokens <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Healy_corpus)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Healy_tokens <span class="ot">&lt;-</span> <span class="fu">tokens_wordstem</span>(Healy_tokens) </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Healy_tokens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Tokens consisting of 1,900 documents.
text1 :
 [1] "four"       "day"        "nov"        "th"         "best"      
 [6] "pitchnnfor" "starter"    "abort"      "fulli"      "protect"   
[11] "ma"         "chang"     
[ ... and 14 more ]

text2 :
 [1] "reproduct"  "freedom"    "protect"    "ma"         "sent"      
 [6] "back"       "state"      "…"          "belong"     "ag"        
[11] "understand"

text3 :
 [1] "serious"    "state"      "'"          "follow"     "scienc"    
 [6] "'"          "w"          "experiment" "drug"       "young"     
[11] "femal"      "'"         
[ ... and 13 more ]

text4 :
[1] "preserv"   "democraci" "come"      "man"      

text5 :
[1] "protect" "kid"     "mean"    "vote"   

text6 :
 [1] "like"            "serious"         "guy"             "republican"     
 [5] "fix"             "anyth"           "claim"           "abl"            
 [9] "just"            "gonna"           "pull"            "sociallyconserv"
[ ... and 11 more ]

[ reached max_ndoc ... 1,894 more documents ]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfm</span>(Healy_tokens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Document-feature matrix of: 1,900 documents, 3,683 features (99.79% sparse) and 0 docvars.
       features
docs    four day nov th best pitchnnfor starter abort fulli protect
  text1    1   1   1  1    1          1       1     1     1       1
  text2    0   0   0  0    0          0       0     0     0       1
  text3    0   0   0  0    0          0       0     0     0       2
  text4    0   0   0  0    0          0       0     0     0       0
  text5    0   0   0  0    0          0       0     0     0       1
  text6    0   0   0  0    0          0       0     0     0       0
[ reached max_ndoc ... 1,894 more documents, reached max_nfeat ... 3,673 more features ]</code></pre>
</div>
</div>
</section>
<section id="create-dfm" class="level2">
<h2 class="anchored" data-anchor-id="create-dfm">Create dfm</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a full dfm for comparison---use this to append to polarity</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Healy_Dfm <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Healy_tokens,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tf-idf" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf">TF-IDF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Healy_Dfm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    vote     will       go    peopl    state     like democrat    right 
     403      124      123      117      114      100       96       93 
    just    elect 
      89       89 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Healy_tf_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(Healy_Dfm, <span class="at">force =</span> <span class="cn">TRUE</span>) <span class="co">#create a new DFM by tf-idf scores</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Healy_tf_dfm) <span class="do">## this shows top words by tf-idf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    vote     will       go    state    peopl     like democrat    right 
308.5110 152.9454 151.2329 145.2853 145.2353 132.4511 127.6189 125.0157 
   elect     just 
121.0111 119.1919 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert corpus to dfm using the dictionary---use to append ???</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>HealyDfm_nrc <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Healy_tokens,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_lookup</span>(data_dictionary_NRC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="word-cloud" class="level2">
<h2 class="anchored" data-anchor-id="word-cloud">Word Cloud</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_wordcloud</span>(Healy_Dfm, <span class="at">scale=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>), <span class="at">max.words=</span><span class="dv">50</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.35</span>, <span class="at">use.r.layout=</span><span class="cn">FALSE</span>, <span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="feature-occurence-matrix" class="level2">
<h2 class="anchored" data-anchor-id="feature-occurence-matrix">Feature-Occurence Matrix</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DFM that contains hashtags </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Healytag_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_select</span>(Healy_Dfm, <span class="at">pattern =</span> <span class="st">"#*"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>Healytoptag <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">topfeatures</span>(Healy_Dfm, <span class="dv">30</span>)) </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Healytoptag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vote"  "will"  "go"    "peopl" "state" "like" </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Healytag_fcm <span class="ot">&lt;-</span> <span class="fu">fcm</span>(Healy_Dfm, <span class="at">context =</span> <span class="st">"document"</span>, <span class="at">tri =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Healytag_fcm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Feature co-occurrence matrix of: 6 by 334 features.
         features
features  day th best abort protect ma chang two just anyth
  day       3  1    2     1       1  3     1   1    9     1
  th        1  0    1     2       1  2     1   1    1     1
  best      2  1    0     1       2  2     1   1    1     1
  abort     1  2    1     0       1  2     1   1    1     1
  protect   1  1    2     1       4  3     1   1    2     1
  ma        3  2    2     2       3  1     2   3    5     2
[ reached max_nfeat ... 324 more features ]</code></pre>
</div>
</div>
</section>
<section id="semantic-network-visualization" class="level2">
<h2 class="anchored" data-anchor-id="semantic-network-visualization">Semantic Network Visualization</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualization of semantic network based on hashtag co-occurrence</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Healytopgat_fcm <span class="ot">&lt;-</span> <span class="fu">fcm_select</span>(Healytag_fcm, <span class="at">pattern =</span> Healytoptag)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_network</span>(Healytopgat_fcm, <span class="at">min_freq =</span> <span class="fl">0.8</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">omit_isolated =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_color =</span> <span class="st">"#1F78B4"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_size =</span> <span class="dv">2</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_color =</span> <span class="st">"#4D4D4D"</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_size =</span> <span class="dv">2</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelcolor =</span> <span class="cn">NULL</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelfont =</span> <span class="cn">NULL</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelsize =</span> <span class="dv">8</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">offset =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_network</span>(Healytopgat_fcm, <span class="at">vertex_labelsize =</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">rowSums</span>(Healytopgat_fcm)<span class="sc">/</span><span class="fu">min</span>(<span class="fu">rowSums</span>(Healytopgat_fcm)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sentiment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert cleaned Healy_tokens back tp corpus for sentiment analysis</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(<span class="fu">as.character</span>(Healy_tokens))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="nrc-dictionary" class="level3">
<h3 class="anchored" data-anchor-id="nrc-dictionary">NRC Dictionary</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use liwcalike() to estimate sentiment using NRC dictionary</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>HealyTweetSentiment_nrc <span class="ot">&lt;-</span> <span class="fu">liwcalike</span>(Healy_corpus, data_dictionary_NRC)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(HealyTweetSentiment_nrc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "docname"      "Segment"      "WPS"          "WC"           "Sixltr"      
 [6] "Dic"          "anger"        "anticipation" "disgust"      "fear"        
[11] "joy"          "negative"     "positive"     "sadness"      "surprise"    
[16] "trust"        "AllPunc"      "Period"       "Comma"        "Colon"       
[21] "SemiC"        "QMark"        "Exclam"       "Dash"         "Quote"       
[26] "Apostro"      "Parenth"      "OtherP"      </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>HealyTweetSentiment_nrc_viz <span class="ot">&lt;-</span> HealyTweetSentiment_nrc <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"anticipation"</span>, <span class="st">"disgust"</span>, <span class="st">"fear"</span>,<span class="st">"joy"</span>,<span class="st">"sadness"</span>, <span class="st">"surprise"</span>,<span class="st">"trust"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Healy_tr<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">t</span>(HealyTweetSentiment_nrc_viz)) <span class="co">#transpose</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Healy_tr_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(Healy_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">1900</span>]))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Healy_tr_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowMeans</span>(Healy_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">1900</span>]))<span class="co">#get mean of sentiment values</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Healy_tr_new)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Count"</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>Healy_tr_new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Healy_tr_new), Healy_tr_new)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Healy_tr_new) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>Healy_tr_new2<span class="ot">&lt;-</span>Healy_tr_new[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healy_tr_new2,<span class="st">"Healy-Sentiments"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healy_tr_new,<span class="st">"Healy-8 Sentiments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Healy_tr_new2, <span class="at">weight=</span>Count, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"count"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Emotions of REPLIES to Maura Healey Tweets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Healy_tr_mean)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Mean"</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>Healy_tr_mean <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Healy_tr_mean), Healy_tr_mean)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Healy_tr_mean) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>Healy_tr_mean2<span class="ot">&lt;-</span>Healy_tr_mean[<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healy_tr_mean2,<span class="st">"Healy-Mean Sentiments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Healy_tr_mean2, <span class="at">weight=</span>Mean, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"Mean Sentiment Score"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Mean Sentiment Scores to Maura Healey Tweets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="polarity-scores" class="level2">
<h2 class="anchored" data-anchor-id="polarity-scores">Polarity scores</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># POLARITY</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>Healydf_nrc <span class="ot">&lt;-</span> <span class="fu">convert</span>(HealyDfm_nrc, <span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Healydf_nrc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "doc_id"       "anger"        "anticipation" "disgust"      "fear"        
 [6] "joy"          "negative"     "positive"     "sadness"      "surprise"    
[11] "trust"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healydf_nrc,<span class="st">"Healy-Polarity Scores"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>Healydf_nrc<span class="sc">$</span>polarity <span class="ot">&lt;-</span> (Healydf_nrc<span class="sc">$</span>positive <span class="sc">-</span> Healydf_nrc<span class="sc">$</span>negative)<span class="sc">/</span>(Healydf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Healydf_nrc<span class="sc">$</span>negative)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>Healydf_nrc<span class="sc">$</span>polarity[(Healydf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Healydf_nrc<span class="sc">$</span>negative) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Healydf_nrc) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>polarity)) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="new-df-with-polarity-scores" class="level2">
<h2 class="anchored" data-anchor-id="new-df-with-polarity-scores">New DF with Polarity scores</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>Healy_text_df <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(Healy_text_df)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>((<span class="fu">cbind</span>(Healydf_nrc,Healy_text_df)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="new-corpus-polaritytext" class="level2">
<h2 class="anchored" data-anchor-id="new-corpus-polaritytext">New CORPUS (Polarity+text)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity <span class="ot">&lt;-</span> HealyCorpus_Polarity <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"polarity"</span>,<span class="st">"Healy_corpus"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity<span class="sc">$</span>polarity <span class="ot">&lt;-</span> <span class="fu">recode</span>(HealyCorpus_Polarity<span class="sc">$</span>polarity,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"positive"</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"negative"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"neutral"</span>,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="omit-na" class="level3">
<h3 class="anchored" data-anchor-id="omit-na">Omit na</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(HealyCorpus_Polarity)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(HealyCorpus_Polarity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      polarity
text1  neutral
text2 positive
text4  neutral
text6  neutral
text7 negative
text8  neutral
                                                                                                                                                                    Healy_corpus
text1        four days nov th best pitchnnfor starters abortion fully protected ma change two items list just hyperbole anything drive business ma cost energy even higher crazy
text2                                                                                                 reproductive freedom protected ma sent back states… belongs ag understand 
text4                                                                                                                                              preserving democracy come man
text6  like seriously guys republicans fix anything claim able just gonna pull sociallyconservative bs take away right vote alongside social security medicare telegraphing hard
text7                                                                                                                  willing trade democracy lower gas prices will get neither
text8                                                                                                                                                          httpstcopqhknanuo</code></pre>
</div>
</div>
</section>
<section id="convert-cleaned-df-to-corpus" class="level3">
<h3 class="anchored" data-anchor-id="convert-cleaned-df-to-corpus">Convert cleaned DF to corpus</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>HealyCorpus_P<span class="ot">&lt;-</span> <span class="fu">corpus</span>(HealyCorpus_Polarity,<span class="at">text_field =</span> <span class="st">"Healy_corpus"</span>)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="healey--machine-learning-methods" class="level1">
<h1>HEALEY- MACHINE LEARNING METHODS</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create id variable in corpus metadata</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(HealyCorpus_P, <span class="st">"id"</span>) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ndoc</span>(HealyCorpus_P)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create training set (60% of data) and initial test set</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">ndoc</span>(HealyCorpus_P)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N,.<span class="dv">6</span> <span class="sc">*</span> N) </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>testIndex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>N)[<span class="sc">-</span>trainIndex]</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co"># split test set in half (so 20% of data are test, 20% of data are held-out)</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(testIndex)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>heldOutIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, .<span class="dv">5</span> <span class="sc">*</span> N)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>testIndex <span class="ot">&lt;-</span> testIndex[<span class="sc">-</span>heldOutIndex]</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="co"># now apply indices to create subsets and dfms</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>dfmTrain <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> trainIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>dfmTest <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>dfmHeldOut <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> heldOutIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trainIndex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 415 463 179 526 195 938</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(testIndex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  4 12 14 15 20</code></pre>
</div>
</div>
<section id="nb-model" class="level2">
<h2 class="anchored" data-anchor-id="nb-model">NB model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>polarity_NaiveBayes <span class="ot">&lt;-</span> <span class="fu">textmodel_nb</span>(dfmTrain, <span class="fu">docvars</span>(dfmTrain, <span class="st">"polarity"</span>), <span class="at">distribution =</span> <span class="st">"Bernoulli"</span>) </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(polarity_NaiveBayes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
textmodel_nb.dfm(x = dfmTrain, y = docvars(dfmTrain, "polarity"), 
    distribution = "Bernoulli")

Class Priors:
(showing first 3 elements)
negative  neutral positive 
  0.3333   0.3333   0.3333 

Estimated Feature Scores:
         reproductive  freedom protected      ma     sent     back   states
negative     0.011494 0.011494  0.011494 0.04598 0.011494 0.022989 0.011494
neutral      0.001309 0.003927  0.001309 0.02618 0.002618 0.006545 0.003927
positive     0.010582 0.015873  0.015873 0.04233 0.015873 0.037037 0.015873
               …  belongs       ag understand  willing    trade democracy
negative 0.02299 0.011494 0.011494   0.011494 0.022989 0.022989  0.022989
neutral  0.02225 0.001309 0.006545   0.001309 0.002618 0.001309  0.002618
positive 0.01587 0.010582 0.031746   0.010582 0.005291 0.005291  0.015873
            lower     gas   prices    will     get  neither httpstcopqhknanuo
negative 0.034483 0.02299 0.057471 0.09195 0.04598 0.022989          0.011494
neutral  0.002618 0.01702 0.003927 0.04188 0.03272 0.001309          0.002618
positive 0.005291 0.06878 0.010582 0.06878 0.06349 0.010582          0.005291
            build  economy    works everyone  raising   living     cost
negative 0.022989 0.022989 0.022989 0.022989 0.022989 0.022989 0.022989
neutral  0.001309 0.002618 0.001309 0.006545 0.001309 0.002618 0.003927
positive 0.010582 0.015873 0.005291 0.005291 0.015873 0.010582 0.015873
            taxes  chasing
negative 0.045977 0.022989
neutral  0.006545 0.001309
positive 0.005291 0.005291</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dfmTestMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(dfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(dfmTrain))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="confusion-matrix" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix">CONFUSION MATRIX</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(dfmTestMatched, <span class="st">"polarity"</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> dfmTestMatched)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, predicted)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          predicted
actual     negative neutral positive
  negative        2      33        1
  neutral         0     240        3
  positive        0      58        8

Overall Statistics
                                          
               Accuracy : 0.7246          
                 95% CI : (0.6743, 0.7711)
    No Information Rate : 0.9594          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.1313          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                 1.000000         0.7251         0.66667
Specificity                 0.900875         0.7857         0.82583
Pos Pred Value              0.055556         0.9877         0.12121
Neg Pred Value              1.000000         0.1078         0.98566
Precision                   0.055556         0.9877         0.12121
Recall                      1.000000         0.7251         0.66667
F1                          0.105263         0.8362         0.20513
Prevalence                  0.005797         0.9594         0.03478
Detection Rate              0.005797         0.6957         0.02319
Detection Prevalence        0.104348         0.7043         0.19130
Balanced Accuracy           0.950437         0.7554         0.74625</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> dfmTestMatched, <span class="at">type =</span> <span class="st">"probability"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           negative   neutral     positive
text4  8.369084e-14 1.0000000 4.927139e-08
text6  1.084335e-08 0.9999950 4.980505e-06
text14 1.244174e-11 0.9999826 1.737715e-05
text17 6.671955e-13 0.9999999 9.920512e-08
text18 9.471524e-15 1.0000000 3.598392e-08
text24 2.010070e-12 1.0000000 3.591003e-08</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(predicted_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    negative           neutral          positive       
 Min.   :0.000000   Min.   :0.0000   Min.   :0.00e+00  
 1st Qu.:0.000000   1st Qu.:1.0000   1st Qu.:0.00e+00  
 Median :0.000000   Median :1.0000   Median :3.00e-07  
 Mean   :0.005803   Mean   :0.9541   Mean   :4.01e-02  
 3rd Qu.:0.000000   3rd Qu.:1.0000   3rd Qu.:1.33e-05  
 Max.   :1.000000   Max.   :1.0000   Max.   :1.00e+00  </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>mostPos <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(predicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex))[mostPos]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              text1320 
" casting vote modern" </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>mostNeg <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(predicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>T)[<span class="dv">1</span>]</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex))[mostNeg]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                                        text903 
" black poverty charts dem areann  africanamerican households boston live poverty line statistic conceals huge inequities across neighborhoods ranging  hyde park  charlestown" </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>mixed <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(<span class="fu">abs</span>(predicted_prob[,<span class="dv">1</span>] <span class="sc">-</span> .<span class="dv">5</span>), <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>predicted_prob[mixed,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  negative    neutral   positive 
0.00135779 0.29476010 0.70388211 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex))[mixed]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                                                     text1194 
" gemini  omg almost east coast california speak especially witch becomes gov thing holding together balance r gov entire legislature d unliked many reluctance ban covid 🗥 kids pissed moms" </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="naive-bayes--held-out" class="level1">
<h1>Naive Bayes -held out</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(dfmHeldOut)<span class="sc">$</span>polarity</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         x freq
1 negative   23
2  neutral  256
3 positive   66</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>dfmHeldOutMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(dfmHeldOut, <span class="at">features =</span> <span class="fu">featnames</span>(dfmTrain))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>predicted.nb <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, dfmHeldOutMatched)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(predicted.nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         x freq
1 negative    1
2  neutral  320
3 positive   24</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, predicted.nb)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          predicted.nb
actual     negative neutral positive
  negative        1      22        0
  neutral         0     254        2
  positive        0      44       22

Overall Statistics
                                          
               Accuracy : 0.8029          
                 95% CI : (0.7569, 0.8436)
    No Information Rate : 0.9275          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.3391          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                 1.000000         0.7937         0.91667
Specificity                 0.936047         0.9200         0.86293
Pos Pred Value              0.043478         0.9922         0.33333
Neg Pred Value              1.000000         0.2584         0.99283
Precision                   0.043478         0.9922         0.33333
Recall                      1.000000         0.7937         0.91667
F1                          0.083333         0.8819         0.48889
Prevalence                  0.002899         0.9275         0.06957
Detection Rate              0.002899         0.7362         0.06377
Detection Prevalence        0.066667         0.7420         0.19130
Balanced Accuracy           0.968023         0.8569         0.88980</code></pre>
</div>
</div>
<section id="svm" class="level2">
<h2 class="anchored" data-anchor-id="svm">SVM</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set of training data</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>newTrainIndex <span class="ot">&lt;-</span> trainIndex[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(trainIndex))]</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create small DFM</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>dfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> newTrainIndex) <span class="sc">%&gt;%</span> <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">"English"</span>), <span class="at">remove_punct=</span>T)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="co"># trim the DFM down to frequent terms</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>dfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(dfmTrainSmall, <span class="at">min_docfreq =</span> <span class="dv">20</span>, <span class="at">min_termfreq =</span> <span class="dv">20</span>)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dfmTrainSmall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1034   34</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>polarity_SVM <span class="ot">&lt;-</span> <span class="fu">textmodel_svm</span>(dfmTrainSmall, <span class="fu">docvars</span>(dfmTrainSmall, <span class="st">"polarity"</span>)) </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># update test set</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>dfmTestMatchedSmall <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(dfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(dfmTrainSmall))</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(dfmTestMatchedSmall, <span class="st">"polarity"</span>)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_SVM, <span class="at">newdata =</span> dfmTestMatchedSmall)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="confusion-matrix-1" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix-1">Confusion Matrix</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          predicted
actual     negative neutral positive
  negative        2      32        2
  neutral         0     240        3
  positive        0      53       13

Overall Statistics
                                          
               Accuracy : 0.7391          
                 95% CI : (0.6894, 0.7847)
    No Information Rate : 0.942           
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.1995          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                 1.000000         0.7385         0.72222
Specificity                 0.900875         0.8500         0.83792
Pos Pred Value              0.055556         0.9877         0.19697
Neg Pred Value              1.000000         0.1667         0.98208
Precision                   0.055556         0.9877         0.19697
Recall                      1.000000         0.7385         0.72222
F1                          0.105263         0.8451         0.30952
Prevalence                  0.005797         0.9420         0.05217
Detection Rate              0.005797         0.6957         0.03768
Detection Prevalence        0.104348         0.7043         0.19130
Balanced Accuracy           0.950437         0.7942         0.78007</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check code---Error in order(V1) : object 'V1' not found</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>svmCoefs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">coefficients</span>(polarity_SVM)))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svmCoefs,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            positive    negative     neutral
ma        0.10642383  0.04095159 -0.15027369
gas       0.63259122 -0.23232753 -0.45305789
will     -0.04905536  0.17855470 -0.11240942
get       0.13327219 -0.08977719 -0.04335252
state     0.32094424 -0.03608965 -0.28125136
governor -0.23191741  0.03187021  0.19601274
re        0.19742408  0.07659889 -0.25219334
just     -0.11477470  0.03795018  0.06346217
one       0.36764128 -0.05616672 -0.31978665
biden     0.20245429 -0.46449151  0.02273121</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(svmCoefs,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            positive    negative     neutral
go       -0.30889746 -0.06202332  0.34283740
need      0.08641445 -0.01586162 -0.07350022
now       0.12340404  0.19171685 -0.26537615
want     -0.08106290  0.21969589 -0.12917587
know      0.44976743  0.01858271 -0.47835868
us        0.06998385 -0.06974139 -0.01704071
election  1.45926123 -0.33623228 -1.30718337
already  -0.19044299 -0.02657631  0.21397132
border    0.30428331 -0.08398931 -0.24725324
Bias     -0.73363968 -0.84683933  0.58081363</code></pre>
</div>
</div>
</section>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">RANDOM FOREST</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in library(randomForest): there is no package called 'randomForest'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>dfmTrainSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(dfmTrainSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>dfmTestMatchedSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(dfmTestMatchedSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>Healey_polarity_RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(dfmTrainSmallRf, </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(dfmTrainSmall)<span class="sc">$</span>polarity),</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">xtest =</span> dfmTestMatchedSmallRf, </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ytest =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(dfmTestMatchedSmall)<span class="sc">$</span>polarity),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mtry =</span> <span class="dv">20</span>,</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ntree =</span> <span class="dv">100</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in randomForest(dfmTrainSmallRf, y = as.factor(docvars(dfmTrainSmall)$polarity), : could not find function "randomForest"</code></pre>
</div>
</div>
<section id="confusion-matrix-2" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix-2">Confusion Matrix</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(dfmTestMatchedSmall)<span class="sc">$</span>polarity)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> Healey_polarity_RF<span class="sc">$</span>test[[<span class="st">'predicted'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'Healey_polarity_RF' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual,predicted)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode=</span><span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          predicted
actual     negative neutral positive
  negative        2      32        2
  neutral         0     240        3
  positive        0      53       13

Overall Statistics
                                          
               Accuracy : 0.7391          
                 95% CI : (0.6894, 0.7847)
    No Information Rate : 0.942           
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.1995          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                 1.000000         0.7385         0.72222
Specificity                 0.900875         0.8500         0.83792
Pos Pred Value              0.055556         0.9877         0.19697
Neg Pred Value              1.000000         0.1667         0.98208
Precision                   0.055556         0.9877         0.19697
Recall                      1.000000         0.7385         0.72222
F1                          0.105263         0.8451         0.30952
Prevalence                  0.005797         0.9420         0.05217
Detection Rate              0.005797         0.6957         0.03768
Detection Prevalence        0.104348         0.7043         0.19130
Balanced Accuracy           0.950437         0.7942         0.78007</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(Healey_polarity_RF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in varImpPlot(Healey_polarity_RF): could not find function "varImpPlot"</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="diehl-data" class="level1">
<h1>DIEHL DATA</h1>
<section id="load-data-1" class="level2">
<h2 class="anchored" data-anchor-id="load-data-1">Load Data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>Diehl <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Diehl.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 497 Columns: 79
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (34): edit_history_tweet_ids, text, lang, source, reply_settings, entit...
dbl  (18): id, conversation_id, referenced_tweets.replied_to.id, referenced_...
lgl  (23): referenced_tweets.retweeted.id, edit_controls.is_edit_eligible, r...
dttm  (4): edit_controls.editable_until, created_at, author.created_at, __tw...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>Diehl<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"@[[:alpha:]]*"</span>,<span class="st">""</span>, Diehl<span class="sc">$</span>text) <span class="co">#remove Twitter handles</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>Diehl<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"&amp;amp"</span>, <span class="st">""</span>, Diehl<span class="sc">$</span>text)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>Diehl<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">""</span>, Diehl<span class="sc">$</span>text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-cleaning-preprocessing-1" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-preprocessing-1">Data Cleaning/ Preprocessing</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(Diehl<span class="sc">$</span>text))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, tolower) <span class="co">#lowercase</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removeWords, </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"s"</span>,<span class="st">"geoff"</span>, <span class="st">"diehl"</span>,<span class="st">"rt"</span>, <span class="st">"amp"</span>))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removeWords, </span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removePunctuation)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, stripWhitespace)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removeNumbers)</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(Diehl_corpus,<span class="at">text_field =</span> <span class="st">"text"</span>) </span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>Diehl_text_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Diehl_corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tokenize-and-stemming-1" class="level2">
<h2 class="anchored" data-anchor-id="tokenize-and-stemming-1">Tokenize and stemming</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>Diehl_tokens <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Diehl_corpus)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>Diehl_tokens <span class="ot">&lt;-</span> <span class="fu">tokens_wordstem</span>(Diehl_tokens)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Diehl_tokens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Tokens consisting of 497 documents.
text1 :
[1] "still"   "beat"    "fascism" "day"     "week"    "📴"     

text2 :
[1] "wear" "mask" "'"    "re"   "dumb"

text3 :
 [1] "'"       "mention" "mask"    "pay"     "compani" "can"     "charg"  
 [8] "whatev"  "want"    "follow"  "'"       "ll"     
[ ... and 10 more ]

text4 :
 [1] "argument" "gas"      "pipelin"  "energi"   "independ" "right"   
 [7] "now"      "new"      "england"  "get"      "lng"      "deliveri"
[ ... and 18 more ]

text5 :
 [1] "shit"     "u"        "dumb"     "masker"   "democrat" "still"   
 [7] "fuck"     "everyon"  "caus"     "price"    "hike"     "higher"  
[ ... and 7 more ]

text6 :
 [1] "compani"  "take"     "profit"   "loss"     "kinder"   "morgan"  
 [7] "elect"    "need"     "proof"    "energi"   "independ" "way"     
[ ... and 7 more ]

[ reached max_ndoc ... 491 more documents ]</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfm</span>(Diehl_tokens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Document-feature matrix of: 497 documents, 1,921 features (99.49% sparse) and 0 docvars.
       features
docs    still beat fascism day week📴 wear mask ' re
  text1     1    1       1   1    1 1    0    0 0  0
  text2     0    0       0   0    0 0    1    1 1  1
  text3     0    0       0   0    0 0    0    1 2  0
  text4     0    0       0   0    0 0    0    0 0  0
  text5     1    0       0   0    0 0    0    0 0  0
  text6     0    0       0   0    0 0    0    0 0  0
[ reached max_ndoc ... 491 more documents, reached max_nfeat ... 1,911 more features ]</code></pre>
</div>
</div>
</section>
<section id="create-dfm-1" class="level2">
<h2 class="anchored" data-anchor-id="create-dfm-1">Create dfm</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a full dfm for comparison---use this to append to polarity</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>Diehl_Dfm <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Diehl_tokens,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tf-idf-1" class="level2">
<h2 class="anchored" data-anchor-id="tf-idf-1">TF-IDF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Diehl_Dfm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  vote school     go   like   will    get healey public   know   just 
    57     54     47     43     43     39     39     35     32     32 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>Diehl_tf_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(Diehl_Dfm, <span class="at">force =</span> <span class="cn">TRUE</span>) <span class="co">#create a new DFM by tf-idf scores</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Diehl_tf_dfm) <span class="do">## this shows top words by tf-idf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  school     vote       go     like     will      get   healey   public 
61.56291 55.88012 50.43603 46.14361 46.14361 44.46210 44.46210 43.18854 
    know     just 
39.97435 39.48667 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert corpus to dfm using the dictionary---use to append </span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>DiehlDfm_nrc <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Diehl_tokens,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_lookup</span>(data_dictionary_NRC)</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(DiehlDfm_nrc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 497  10</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DiehlDfm_nrc, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Document-feature matrix of: 10 documents, 10 features (70.00% sparse) and 0 docvars.
       features
docs    anger anticipation disgust fear joy negative positive sadness surprise
  text1     0            0       0    0   0        0        0       0        0
  text2     0            0       0    0   0        0        0       0        0
  text3     1            1       0    0   1        1        1       1        1
  text4     1            3       0    0   1        0        3       0        1
  text5     0            0       0    0   0        0        0       0        0
  text6     0            0       0    0   0        0        1       0        0
       features
docs    trust
  text1     0
  text2     0
  text3     1
  text4     1
  text5     0
  text6     1
[ reached max_ndoc ... 4 more documents ]</code></pre>
</div>
</div>
</section>
<section id="word-cloud-1" class="level2">
<h2 class="anchored" data-anchor-id="word-cloud-1">Word CLoud</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_wordcloud</span>(Diehl_Dfm, <span class="at">scale=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>), <span class="at">max.words=</span><span class="dv">50</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.35</span>, <span class="at">use.r.layout=</span><span class="cn">FALSE</span>, <span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="feature-occurrence-matrix" class="level2">
<h2 class="anchored" data-anchor-id="feature-occurrence-matrix">Feature-occurrence matrix</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>Diehltag_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_select</span>(Diehl_Dfm, <span class="at">pattern =</span> <span class="st">"#*"</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>Diehltoptag <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">topfeatures</span>(Diehl_Dfm, <span class="dv">30</span>)) </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Diehltoptag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vote"   "school" "go"     "like"   "will"   "get"   </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>Diehltag_fcm <span class="ot">&lt;-</span> <span class="fu">fcm</span>(Diehl_Dfm)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Diehltag_fcm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Feature co-occurrence matrix of: 6 by 74 features.
        features
features re can want see vote like gas energi right now
    re    1   0    2   0    0    1   0      1     4   0
    can   0   1    3   1    5    3   2      2     2   2
    want  0   0    4   1    2    3   0      0     4   3
    see   0   0    0   1    5    3   0      0     0   0
    vote  0   0    0   0    5    4   1      1     1   2
    like  0   0    0   0    0    1   1      1     2   3
[ reached max_nfeat ... 64 more features ]</code></pre>
</div>
</div>
</section>
<section id="semantic-network-analysis" class="level2">
<h2 class="anchored" data-anchor-id="semantic-network-analysis">Semantic Network Analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualization of semantic network based on hashtag co-occurrence</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>Diehltopgat_fcm <span class="ot">&lt;-</span> <span class="fu">fcm_select</span>(Diehltag_fcm, <span class="at">pattern =</span> Diehltoptag)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_network</span>(Diehltopgat_fcm, <span class="at">min_freq =</span> <span class="fl">0.8</span>,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">omit_isolated =</span> <span class="cn">TRUE</span>,</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_color =</span> <span class="st">"#1F78B4"</span>,</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_size =</span> <span class="dv">2</span>,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_color =</span> <span class="st">"#4D4D4D"</span>,</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_size =</span> <span class="dv">2</span>,</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelcolor =</span> <span class="cn">NULL</span>,</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelfont =</span> <span class="cn">NULL</span>,</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelsize =</span> <span class="dv">8</span>,</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">offset =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sentiment-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-analysis-1">Sentiment Analysis</h2>
<section id="nrc-dictionary-1" class="level3">
<h3 class="anchored" data-anchor-id="nrc-dictionary-1">NRC Dictionary</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert cleaned Diehl_tokens back tp corpus for sentiment analysis</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(<span class="fu">as.character</span>(Diehl_tokens))</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use liwcalike() to estimate sentiment using NRC dictionary</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>DiehlTweetSentiment_nrc <span class="ot">&lt;-</span> <span class="fu">liwcalike</span>(Diehl_corpus, data_dictionary_NRC)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(DiehlTweetSentiment_nrc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "docname"      "Segment"      "WPS"          "WC"           "Sixltr"      
 [6] "Dic"          "anger"        "anticipation" "disgust"      "fear"        
[11] "joy"          "negative"     "positive"     "sadness"      "surprise"    
[16] "trust"        "AllPunc"      "Period"       "Comma"        "Colon"       
[21] "SemiC"        "QMark"        "Exclam"       "Dash"         "Quote"       
[26] "Apostro"      "Parenth"      "OtherP"      </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>DiehlTweetSentiment_nrc_viz <span class="ot">&lt;-</span> DiehlTweetSentiment_nrc <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"anticipation"</span>, <span class="st">"disgust"</span>, <span class="st">"fear"</span>,<span class="st">"joy"</span>,<span class="st">"sadness"</span>, <span class="st">"surprise"</span>,<span class="st">"trust"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>))</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>Diehl_tr<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">t</span>(DiehlTweetSentiment_nrc_viz)) <span class="co">#transpose</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>Diehl_tr_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(Diehl_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">497</span>]))</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>Diehl_tr_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowMeans</span>(Diehl_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">497</span>]))<span class="co">#get mean of sentiment values</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Diehl_tr_new)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Count"</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>Diehl_tr_new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Diehl_tr_new), Diehl_tr_new)</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Diehl_tr_new) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>Diehl_tr_new2<span class="ot">&lt;-</span>Diehl_tr_new[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Diehl_tr_new2,<span class="st">"Diehl- 8 Sentiments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Diehl_tr_new2, <span class="at">weight=</span>Count, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"count"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Emotions to REPLIES Geoff Diehl Tweets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Diehl_tr_mean)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Mean"</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>Diehl_tr_mean <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Diehl_tr_mean), Diehl_tr_mean)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Diehl_tr_mean) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>Diehl_tr_mean2<span class="ot">&lt;-</span>Diehl_tr_mean[<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Diehl_tr_mean2,<span class="st">"Diehl -Mean Sentiments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Diehl_tr_mean2, <span class="at">weight=</span>Mean, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"Mean Sentiment Score"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Mean Sentiment Scores to Geoff Diehl Tweets"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="polarity-scores-1" class="level2">
<h2 class="anchored" data-anchor-id="polarity-scores-1">Polarity Scores</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>Diehldf_nrc <span class="ot">&lt;-</span> <span class="fu">convert</span>(DiehlDfm_nrc, <span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Diehldf_nrc, <span class="st">"Diehl- Polarity Scores"</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>Diehldf_nrc<span class="sc">$</span>polarity <span class="ot">&lt;-</span> (Diehldf_nrc<span class="sc">$</span>positive <span class="sc">-</span> Diehldf_nrc<span class="sc">$</span>negative)<span class="sc">/</span>(Diehldf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Diehldf_nrc<span class="sc">$</span>negative)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>Diehldf_nrc<span class="sc">$</span>polarity[(Diehldf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Diehldf_nrc<span class="sc">$</span>negative) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Diehldf_nrc) <span class="sc">+</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>polarity)) <span class="sc">+</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="MAGov_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bind-to-new-df" class="level2">
<h2 class="anchored" data-anchor-id="bind-to-new-df">Bind to new DF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>Diehl_text_df <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(Diehl_text_df)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>((<span class="fu">cbind</span>(Diehldf_nrc,Diehl_text_df)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="subset-to-polarity-and-text" class="level2">
<h2 class="anchored" data-anchor-id="subset-to-polarity-and-text">subset to polarity and text</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity <span class="ot">&lt;-</span> DiehlCorpus_Polarity <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"polarity"</span>,<span class="st">"Diehl_corpus"</span>))</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity<span class="sc">$</span>polarity <span class="ot">&lt;-</span> <span class="fu">recode</span>(DiehlCorpus_Polarity<span class="sc">$</span>polarity,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"positive"</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"negative"</span>,</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"neutral"</span>,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="cleaned-df" class="level2">
<h2 class="anchored" data-anchor-id="cleaned-df">Cleaned DF</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(DiehlCorpus_Polarity)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DiehlCorpus_Polarity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      polarity
text1  neutral
text2  neutral
text3  neutral
text4 positive
text5  neutral
text6 positive
                                                                                                                                                                                                                  Diehl_corpus
text1                                                                                                                                                                                           still beats fascism day week 📴
text2                                                                                                                                                                                                       wear mask ’re dumb
text3                                                                                     ’ mentioning masks paying companies can charge whatever want follow ’ll see shareholders companies keep voting party like dumb poor…
text4  argument gas pipelines energy independence right now new england gets lng deliveries international shipments nthese corporations making profit another story vg blckrck use public funds turn profit pull public money 
text5                                                                                                         shit u dumb masker democrats still fucked everyone caused price hikes higher taxes fn maskers u don’t know squat
text6                                                                     companies take profit loss kinder morgan elected need proof energy independence way actually take control prices give billionaires httpstcodairdldph</code></pre>
</div>
</div>
</section>
<section id="new-corpus-with-polarity-scores" class="level2">
<h2 class="anchored" data-anchor-id="new-corpus-with-polarity-scores">New Corpus with polarity scores</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_P<span class="ot">&lt;-</span> <span class="fu">corpus</span>(DiehlCorpus_Polarity,<span class="at">text_field =</span> <span class="st">"Diehl_corpus"</span>)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="diehl-machine-learning" class="level1">
<h1>DIEHL-MACHINE LEARNING</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create id variable in corpus metadata</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(DiehlCorpus_P, <span class="st">"id"</span>) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ndoc</span>(DiehlCorpus_P)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create training set (60% of data) and initial test set</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>DN <span class="ot">&lt;-</span> <span class="fu">ndoc</span>(DiehlCorpus_P)</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>DtrainIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>DN,.<span class="dv">6</span> <span class="sc">*</span> DN) </span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>DtestIndex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>N)[<span class="sc">-</span>DtrainIndex]</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="co"># split test set in half (so 20% of data are test, 20% of data are held-out)</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>DN <span class="ot">&lt;-</span> <span class="fu">length</span>(DtestIndex)</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>DheldOutIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>DN, .<span class="dv">5</span> <span class="sc">*</span> DN)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>DtestIndex <span class="ot">&lt;-</span> DtestIndex[<span class="sc">-</span>DheldOutIndex]</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a><span class="co"># now apply indices to create subsets and dfms</span></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>DdfmTrain <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtrainIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>DdfmTest <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>DdfmHeldOut <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DheldOutIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DtrainIndex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 415 463 179  14 195 426</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DtestIndex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  3  6  8  9 15</code></pre>
</div>
</div>
<section id="nb-model-1" class="level2">
<h2 class="anchored" data-anchor-id="nb-model-1">NB model</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>polarity_NaiveBayes <span class="ot">&lt;-</span> <span class="fu">textmodel_nb</span>(DdfmTrain, <span class="fu">docvars</span>(DdfmTrain, <span class="st">"polarity"</span>), <span class="at">distribution =</span> <span class="st">"Bernoulli"</span>) </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(polarity_NaiveBayes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
textmodel_nb.dfm(x = DdfmTrain, y = docvars(DdfmTrain, "polarity"), 
    distribution = "Bernoulli")

Class Priors:
(showing first 3 elements)
negative  neutral positive 
  0.3333   0.3333   0.3333 

Estimated Feature Scores:
             wear     mask      '      re    dumb argument     gas pipelines
negative 0.142857 0.142857 0.4286 0.14286 0.14286 0.142857 0.14286   0.14286
neutral  0.008163 0.008163 0.1347 0.02857 0.02041 0.008163 0.02041   0.02449
positive 0.023810 0.023810 0.1667 0.04762 0.02381 0.071429 0.09524   0.04762
          energy independence   right     now     new  england     gets
negative 0.14286     0.142857 0.14286 0.28571 0.14286 0.142857 0.142857
neutral  0.02449     0.008163 0.02449 0.03265 0.01633 0.004082 0.004082
positive 0.07143     0.047619 0.11905 0.11905 0.11905 0.047619 0.095238
              lng deliveries international shipments   nthese corporations
negative 0.142857   0.142857      0.142857  0.142857 0.142857     0.142857
neutral  0.004082   0.004082      0.004082  0.004082 0.004082     0.008163
positive 0.047619   0.047619      0.047619  0.047619 0.047619     0.047619
          making   profit another    story       vg  blckrck      use   public
negative 0.14286 0.142857 0.14286 0.142857 0.142857 0.142857 0.142857 0.142857
neutral  0.01633 0.008163 0.01633 0.008163 0.004082 0.004082 0.008163 0.008163
positive 0.07143 0.047619 0.04762 0.047619 0.047619 0.047619 0.047619 0.357143
            funds
negative 0.142857
neutral  0.004082
positive 0.047619</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>DdfmTestMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(DdfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(DdfmTrain))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="confusion-matrix-3" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix-3">CONFUSION MATRIX</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(DdfmTestMatched, <span class="st">"polarity"</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>Dpredicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> DdfmTestMatched)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual, Dpredicted)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Dpredicted
Dactual    negative neutral positive
  negative        0       1        0
  neutral         0      84        0
  positive        0      12        0

Overall Statistics
                                          
               Accuracy : 0.866           
                 95% CI : (0.7817, 0.9267)
    No Information Rate : 1               
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0               
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                       NA         0.8660              NA
Specificity                  0.98969             NA          0.8763
Pos Pred Value                    NA             NA              NA
Neg Pred Value                    NA             NA              NA
Precision                    0.00000         1.0000          0.0000
Recall                            NA         0.8660              NA
F1                                NA         0.9282              NA
Prevalence                   0.00000         1.0000          0.0000
Detection Rate               0.00000         0.8660          0.0000
Detection Prevalence         0.01031         0.8660          0.1237
Balanced Accuracy                 NA             NA              NA</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>Dpredicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> DdfmTestMatched, <span class="at">type =</span> <span class="st">"probability"</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Dpredicted_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            negative   neutral     positive
text1  1.925127e-102 1.0000000 1.708320e-16
text3   4.365338e-91 1.0000000 1.285406e-12
text6   2.104851e-89 1.0000000 6.880633e-09
text8   5.873103e-86 0.9999995 4.570643e-07
text9   7.688654e-95 1.0000000 1.265155e-12
text17 4.872562e-103 1.0000000 7.091057e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Dpredicted_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    negative            neutral     positive        
 Min.   :0.000e+00   Min.   :1   Min.   :0.000e+00  
 1st Qu.:0.000e+00   1st Qu.:1   1st Qu.:0.000e+00  
 Median :0.000e+00   Median :1   Median :0.000e+00  
 Mean   :2.885e-87   Mean   :1   Mean   :9.401e-09  
 3rd Qu.:0.000e+00   3rd Qu.:1   3rd Qu.:1.300e-12  
 Max.   :2.149e-85   Max.   :1   Max.   :4.571e-07  </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>mostPos <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(Dpredicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex))[mostPos]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              text39 
" httpstcogihndiqwj" </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>mostNeg <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(Dpredicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>T)[<span class="dv">1</span>]</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex))[mostNeg]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                                                        text331 
" won’t also statement electric prices going  tomorrow customers categorically false lastly take personal responsibility curb energy use many trips dunks conserve haven’t turn heat house yet" </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>Dmixed <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(<span class="fu">abs</span>(Dpredicted_prob[,<span class="dv">1</span>] <span class="sc">-</span> .<span class="dv">5</span>), <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>Dpredicted_prob[Dmixed,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     negative       neutral      positive 
1.925127e-102  1.000000e+00  1.708320e-16 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex))[Dmixed]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             text1 
" still beats fascism day week 📴" </code></pre>
</div>
</div>
</section>
</section>
<section id="svm-1" class="level2">
<h2 class="anchored" data-anchor-id="svm-1">SVM</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample smaller set of training data</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>DnewTrainIndex <span class="ot">&lt;-</span> DtrainIndex[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DtrainIndex))]</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create small DFM</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>DdfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DnewTrainIndex) <span class="sc">%&gt;%</span> <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">"English"</span>), <span class="at">remove_punct=</span>T)</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="co"># trim the DFM down to frequent terms</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>DdfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(DdfmTrainSmall, <span class="at">min_docfreq =</span> <span class="dv">2</span>, <span class="at">min_termfreq =</span> <span class="dv">2</span>)</span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(DdfmTrainSmall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 288 447</code></pre>
</div>
</div>
<section id="run-model" class="level3">
<h3 class="anchored" data-anchor-id="run-model">run model</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>Dpolarity_SVM <span class="ot">&lt;-</span> <span class="fu">textmodel_svm</span>(DdfmTrainSmall, <span class="fu">docvars</span>(DdfmTrainSmall, <span class="st">"polarity"</span>)) </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># update test set</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>DdfmTestMatchedSmall <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(DdfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(DdfmTrainSmall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(DdfmTestMatchedSmall, <span class="st">"polarity"</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>Dpredicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(Dpolarity_SVM, <span class="at">newdata =</span> DdfmTestMatchedSmall)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual, Dpredicted)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Dpredicted
Dactual    negative neutral positive
  negative        0       1        0
  neutral         1      82        1
  positive        0       6        6

Overall Statistics
                                          
               Accuracy : 0.9072          
                 95% CI : (0.8312, 0.9567)
    No Information Rate : 0.9175          
    P-Value [Acc &gt; NIR] : 0.7222          
                                          
                  Kappa : 0.5276          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                  0.00000         0.9213         0.85714
Specificity                  0.98958         0.7500         0.93333
Pos Pred Value               0.00000         0.9762         0.50000
Neg Pred Value               0.98958         0.4615         0.98824
Precision                    0.00000         0.9762         0.50000
Recall                       0.00000         0.9213         0.85714
F1                               NaN         0.9480         0.63158
Prevalence                   0.01031         0.9175         0.07216
Detection Rate               0.00000         0.8454         0.06186
Detection Prevalence         0.01031         0.8660         0.12371
Balanced Accuracy            0.49479         0.8357         0.89524</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM coeff</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>DsvmCoefs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">coefficients</span>(Dpolarity_SVM)))</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DsvmCoefs,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 neutral    positive      negative
re           -0.03132930  0.05928472 -0.0329520937
dumb          0.14182580 -0.04494786 -0.0874533193
argument     -0.20821243  0.20288659 -0.0002532952
gas          -0.17606195  0.13348240 -0.0058732396
pipelines     0.05733301 -0.09047331  0.0000000000
energy       -0.05797844  0.03723350 -0.0000666509
independence  0.00000000  0.00000000  0.0000000000
right        -0.01302839  0.06484791 -0.0426623835
now          -0.16246334  0.15407481  0.0287002076
new          -0.18549462  0.19847717 -0.0056908459</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(DsvmCoefs,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  neutral      positive    negative
results      8.104458e-02 -2.514501e-02 -0.03999678
tom         -1.952894e-02 -8.281253e-02  0.02176794
pot          1.666422e-01 -1.438545e-01  0.00000000
northampton -3.469447e-18  0.000000e+00  0.00000000
draining    -9.221612e-03  3.172656e-02  0.00000000
effected     0.000000e+00  0.000000e+00  0.00000000
health      -3.469447e-18  3.469447e-18  0.00000000
pregnancy    0.000000e+00  3.469447e-18  0.00000000
abortion     5.451712e-02 -9.680120e-03 -0.04875344
Bias         1.013049e+00 -1.061780e+00 -0.98978009</code></pre>
</div>
</div>
</section>
</section>
<section id="random-forest-1" class="level2">
<h2 class="anchored" data-anchor-id="random-forest-1">RANDOM FOREST</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in library(randomForest): there is no package called 'randomForest'</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>DdfmTrainSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(DdfmTrainSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>DdfmTestMatchedSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(DdfmTestMatchedSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>Diehl_polarity_RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DdfmTrainSmallRf, </span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(DdfmTrainSmall)<span class="sc">$</span>polarity),</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">xtest =</span> DdfmTestMatchedSmallRf, </span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ytest =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(DdfmTestMatchedSmall)<span class="sc">$</span>polarity),</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mtry =</span> <span class="dv">20</span>,</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ntree =</span> <span class="dv">100</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in randomForest(DdfmTrainSmallRf, y = as.factor(docvars(DdfmTrainSmall)$polarity), : could not find function "randomForest"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(DdfmTestMatchedSmall)<span class="sc">$</span>polarity)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>Dpredicted <span class="ot">&lt;-</span> Diehl_polarity_RF<span class="sc">$</span>test[[<span class="st">'predicted'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'Diehl_polarity_RF' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual,Dpredicted)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode=</span><span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Dpredicted
Dactual    negative neutral positive
  negative        0       1        0
  neutral         1      82        1
  positive        0       6        6

Overall Statistics
                                          
               Accuracy : 0.9072          
                 95% CI : (0.8312, 0.9567)
    No Information Rate : 0.9175          
    P-Value [Acc &gt; NIR] : 0.7222          
                                          
                  Kappa : 0.5276          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                  0.00000         0.9213         0.85714
Specificity                  0.98958         0.7500         0.93333
Pos Pred Value               0.00000         0.9762         0.50000
Neg Pred Value               0.98958         0.4615         0.98824
Precision                    0.00000         0.9762         0.50000
Recall                       0.00000         0.9213         0.85714
F1                               NaN         0.9480         0.63158
Prevalence                   0.01031         0.9175         0.07216
Detection Rate               0.00000         0.8454         0.06186
Detection Prevalence         0.01031         0.8660         0.12371
Balanced Accuracy            0.49479         0.8357         0.89524</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(Diehl_polarity_RF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in varImpPlot(Diehl_polarity_RF): could not find function "varImpPlot"</code></pre>
</div>
</div>
</section>
<section id="naive-bayes--held-out-1" class="level2">
<h2 class="anchored" data-anchor-id="naive-bayes--held-out-1">Naive Bayes -Held out</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(DdfmHeldOut)<span class="sc">$</span>polarity</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(Dactual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         x freq
1 negative    1
2  neutral  169
3 positive   31</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>DdfmHeldOutMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(DdfmHeldOut, <span class="at">features =</span> <span class="fu">featnames</span>(DdfmTrain))</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>Dpredicted.nb <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, DdfmHeldOutMatched, <span class="at">force =</span>  <span class="cn">TRUE</span> )</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(Dpredicted.nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         x freq
1  neutral  196
2 positive    5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual, Dpredicted.nb)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Dpredicted.nb
Dactual    negative neutral positive
  negative        0       1        0
  neutral         0     169        0
  positive        0      26        5

Overall Statistics
                                          
               Accuracy : 0.8657          
                 95% CI : (0.8106, 0.9096)
    No Information Rate : 0.9751          
    P-Value [Acc &gt; NIR] : 1               
                                          
                  Kappa : 0.238           
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: negative Class: neutral Class: positive
Sensitivity                       NA         0.8622         1.00000
Specificity                 0.995025         1.0000         0.86735
Pos Pred Value                    NA         1.0000         0.16129
Neg Pred Value                    NA         0.1562         1.00000
Precision                   0.000000         1.0000         0.16129
Recall                            NA         0.8622         1.00000
F1                                NA         0.9260         0.27778
Prevalence                  0.000000         0.9751         0.02488
Detection Rate              0.000000         0.8408         0.02488
Detection Prevalence        0.004975         0.8408         0.15423
Balanced Accuracy                 NA         0.9311         0.93367</code></pre>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/Text_as_Data_Fall_2022" data-repo-id="R_kgDOH5675w" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb185" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Blog 5-Twitter Engagement Analysis of MA Gubernatorial Candidates"</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Rhowena Vespa"</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "Analysis of Replies on Gubernatorial Candidates' Tweets and Influence on Election Results"</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "11/06/2022"</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - Blog 5</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Twitter Replies</span></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - Twarc2</span></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Rhowena Vespa</span></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - Massachusetts Gubernatorial Elections</span></span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - Healey</span></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - Diehl</span></span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a><span class="co">  - Supervised Machine Learning</span></span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a><span class="co">  - Sentiment Analysis</span></span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a><span class="co">  - TF-IDF</span></span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a><span class="co">  - Semantic Network</span></span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a><span class="co">  - Naive Bayes</span></span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a><span class="co">  - Support Vector Machines</span></span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a><span class="co">  - Random Forest</span></span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">StringsAsFActors=</span> <span class="cn">FALSE</span>)</span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a>This project analyzes Twitter engagement of specific Massachusetts GOvernor Candidates namely</span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a>Maura Healey and Geoff Diehl. </span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a>CORPUS: Extracted twitter replies (Oct 29 to Nov 4) from all of Healey and Diehl's tweets.</span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a>The replies looks into how these candidates engages other twitter users by generating a response </span>
<span id="cb185-42"><a href="#cb185-42" aria-hidden="true" tabindex="-1"></a>to their original tweet or retweet.</span>
<span id="cb185-43"><a href="#cb185-43" aria-hidden="true" tabindex="-1"></a>The replies are then cleaned and pre-processed.</span>
<span id="cb185-44"><a href="#cb185-44" aria-hidden="true" tabindex="-1"></a>Analysis: </span>
<span id="cb185-45"><a href="#cb185-45" aria-hidden="true" tabindex="-1"></a>        Initial Data visualization (word cloud)</span>
<span id="cb185-46"><a href="#cb185-46" aria-hidden="true" tabindex="-1"></a>        TF-IDF</span>
<span id="cb185-47"><a href="#cb185-47" aria-hidden="true" tabindex="-1"></a>        Semantic Network Analysis</span>
<span id="cb185-48"><a href="#cb185-48" aria-hidden="true" tabindex="-1"></a>        Sentiment Analysis + Polarity</span>
<span id="cb185-49"><a href="#cb185-49" aria-hidden="true" tabindex="-1"></a>        SML -Naive Bayes, SVM, Random Forest</span>
<span id="cb185-50"><a href="#cb185-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb185-51"><a href="#cb185-51" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb185-52"><a href="#cb185-52" aria-hidden="true" tabindex="-1"></a>I wanted to analyze twitter engagement and correlate it with poll results</span>
<span id="cb185-53"><a href="#cb185-53" aria-hidden="true" tabindex="-1"></a>With the election coming up, I would also like to correlate my analysis with actual election results.</span>
<span id="cb185-54"><a href="#cb185-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-55"><a href="#cb185-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-56"><a href="#cb185-56" aria-hidden="true" tabindex="-1"></a><span class="fu"># LOAD PACKAGES</span></span>
<span id="cb185-57"><a href="#cb185-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-60"><a href="#cb185-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-61"><a href="#cb185-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb185-62"><a href="#cb185-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb185-63"><a href="#cb185-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb185-64"><a href="#cb185-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb185-65"><a href="#cb185-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textstats)</span>
<span id="cb185-66"><a href="#cb185-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textplots)</span>
<span id="cb185-67"><a href="#cb185-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb185-68"><a href="#cb185-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb185-69"><a href="#cb185-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb185-70"><a href="#cb185-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb185-71"><a href="#cb185-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb185-72"><a href="#cb185-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb185-73"><a href="#cb185-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb185-74"><a href="#cb185-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textmodels)</span>
<span id="cb185-75"><a href="#cb185-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb185-76"><a href="#cb185-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb185-77"><a href="#cb185-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb185-78"><a href="#cb185-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.dictionaries)</span>
<span id="cb185-79"><a href="#cb185-79" aria-hidden="true" tabindex="-1"></a><span class="co">#library(devtools)</span></span>
<span id="cb185-80"><a href="#cb185-80" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("kbenoit/quanteda.dictionaries")</span></span>
<span id="cb185-81"><a href="#cb185-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.dictionaries)</span>
<span id="cb185-82"><a href="#cb185-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(syuzhet) </span>
<span id="cb185-83"><a href="#cb185-83" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("quanteda/quanteda.sentiment")</span></span>
<span id="cb185-84"><a href="#cb185-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.sentiment)</span>
<span id="cb185-85"><a href="#cb185-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-86"><a href="#cb185-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-87"><a href="#cb185-87" aria-hidden="true" tabindex="-1"></a><span class="fu"># Healey DATA</span></span>
<span id="cb185-88"><a href="#cb185-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Data</span></span>
<span id="cb185-91"><a href="#cb185-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-92"><a href="#cb185-92" aria-hidden="true" tabindex="-1"></a>Healy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Healy.csv"</span>)</span>
<span id="cb185-93"><a href="#cb185-93" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"@[[:alpha:]]*"</span>,<span class="st">""</span>, Healy<span class="sc">$</span>text) <span class="co">#remove Twitter handles</span></span>
<span id="cb185-94"><a href="#cb185-94" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"&amp;amp"</span>, <span class="st">""</span>, Healy<span class="sc">$</span>text)</span>
<span id="cb185-95"><a href="#cb185-95" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"healey"</span>, <span class="st">""</span>, Healy<span class="sc">$</span>text)</span>
<span id="cb185-96"><a href="#cb185-96" aria-hidden="true" tabindex="-1"></a>Healy<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">""</span>, Healy<span class="sc">$</span>text)</span>
<span id="cb185-97"><a href="#cb185-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-98"><a href="#cb185-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-99"><a href="#cb185-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Cleaning/ Preprocessing</span></span>
<span id="cb185-102"><a href="#cb185-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-103"><a href="#cb185-103" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(Healy<span class="sc">$</span>text))</span>
<span id="cb185-104"><a href="#cb185-104" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, tolower) <span class="co">#lowercase</span></span>
<span id="cb185-105"><a href="#cb185-105" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removeWords, </span>
<span id="cb185-106"><a href="#cb185-106" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">"s"</span>,<span class="st">"healey"</span>, <span class="st">"healy"</span>,<span class="st">"maura"</span>,<span class="st">"rt"</span>, <span class="st">"amp"</span>))</span>
<span id="cb185-107"><a href="#cb185-107" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removeWords, </span>
<span id="cb185-108"><a href="#cb185-108" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb185-109"><a href="#cb185-109" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removePunctuation)</span>
<span id="cb185-110"><a href="#cb185-110" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, stripWhitespace)</span>
<span id="cb185-111"><a href="#cb185-111" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Healy_corpus, removeNumbers)</span>
<span id="cb185-112"><a href="#cb185-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-113"><a href="#cb185-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tokenize and stemming</span></span>
<span id="cb185-114"><a href="#cb185-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-117"><a href="#cb185-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-118"><a href="#cb185-118" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(Healy_corpus,<span class="at">text_field =</span> <span class="st">"text"</span>) </span>
<span id="cb185-119"><a href="#cb185-119" aria-hidden="true" tabindex="-1"></a>Healy_text_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Healy_corpus)</span>
<span id="cb185-120"><a href="#cb185-120" aria-hidden="true" tabindex="-1"></a>Healy_tokens <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Healy_corpus)</span>
<span id="cb185-121"><a href="#cb185-121" aria-hidden="true" tabindex="-1"></a>Healy_tokens <span class="ot">&lt;-</span> <span class="fu">tokens_wordstem</span>(Healy_tokens) </span>
<span id="cb185-122"><a href="#cb185-122" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Healy_tokens)</span>
<span id="cb185-123"><a href="#cb185-123" aria-hidden="true" tabindex="-1"></a><span class="fu">dfm</span>(Healy_tokens)</span>
<span id="cb185-124"><a href="#cb185-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-125"><a href="#cb185-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-126"><a href="#cb185-126" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create dfm</span></span>
<span id="cb185-129"><a href="#cb185-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-130"><a href="#cb185-130" aria-hidden="true" tabindex="-1"></a><span class="co"># create a full dfm for comparison---use this to append to polarity</span></span>
<span id="cb185-131"><a href="#cb185-131" aria-hidden="true" tabindex="-1"></a>Healy_Dfm <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Healy_tokens,</span>
<span id="cb185-132"><a href="#cb185-132" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-133"><a href="#cb185-133" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-134"><a href="#cb185-134" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-135"><a href="#cb185-135" aria-hidden="true" tabindex="-1"></a>                  <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-136"><a href="#cb185-136" aria-hidden="true" tabindex="-1"></a>                  <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-137"><a href="#cb185-137" aria-hidden="true" tabindex="-1"></a>                  <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-138"><a href="#cb185-138" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-139"><a href="#cb185-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-140"><a href="#cb185-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb185-141"><a href="#cb185-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-142"><a href="#cb185-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>()</span>
<span id="cb185-143"><a href="#cb185-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-144"><a href="#cb185-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-145"><a href="#cb185-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-146"><a href="#cb185-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## TF-IDF </span></span>
<span id="cb185-147"><a href="#cb185-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-150"><a href="#cb185-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-151"><a href="#cb185-151" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Healy_Dfm)</span>
<span id="cb185-152"><a href="#cb185-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-155"><a href="#cb185-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-156"><a href="#cb185-156" aria-hidden="true" tabindex="-1"></a>Healy_tf_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(Healy_Dfm, <span class="at">force =</span> <span class="cn">TRUE</span>) <span class="co">#create a new DFM by tf-idf scores</span></span>
<span id="cb185-157"><a href="#cb185-157" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Healy_tf_dfm) <span class="do">## this shows top words by tf-idf</span></span>
<span id="cb185-158"><a href="#cb185-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-161"><a href="#cb185-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-162"><a href="#cb185-162" aria-hidden="true" tabindex="-1"></a><span class="co"># convert corpus to dfm using the dictionary---use to append ???</span></span>
<span id="cb185-163"><a href="#cb185-163" aria-hidden="true" tabindex="-1"></a>HealyDfm_nrc <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Healy_tokens,</span>
<span id="cb185-164"><a href="#cb185-164" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-165"><a href="#cb185-165" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-166"><a href="#cb185-166" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-167"><a href="#cb185-167" aria-hidden="true" tabindex="-1"></a>                     <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-168"><a href="#cb185-168" aria-hidden="true" tabindex="-1"></a>                     <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-169"><a href="#cb185-169" aria-hidden="true" tabindex="-1"></a>                     <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-170"><a href="#cb185-170" aria-hidden="true" tabindex="-1"></a>                     <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-171"><a href="#cb185-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-172"><a href="#cb185-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb185-173"><a href="#cb185-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-174"><a href="#cb185-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-175"><a href="#cb185-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_lookup</span>(data_dictionary_NRC)</span>
<span id="cb185-176"><a href="#cb185-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-177"><a href="#cb185-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-178"><a href="#cb185-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-179"><a href="#cb185-179" aria-hidden="true" tabindex="-1"></a><span class="fu">## Word Cloud</span></span>
<span id="cb185-180"><a href="#cb185-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-183"><a href="#cb185-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-184"><a href="#cb185-184" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb185-185"><a href="#cb185-185" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_wordcloud</span>(Healy_Dfm, <span class="at">scale=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>), <span class="at">max.words=</span><span class="dv">50</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.35</span>, <span class="at">use.r.layout=</span><span class="cn">FALSE</span>, <span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span>
<span id="cb185-186"><a href="#cb185-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-187"><a href="#cb185-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-188"><a href="#cb185-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature-Occurence Matrix</span></span>
<span id="cb185-189"><a href="#cb185-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-192"><a href="#cb185-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-193"><a href="#cb185-193" aria-hidden="true" tabindex="-1"></a><span class="co"># DFM that contains hashtags </span></span>
<span id="cb185-194"><a href="#cb185-194" aria-hidden="true" tabindex="-1"></a>Healytag_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_select</span>(Healy_Dfm, <span class="at">pattern =</span> <span class="st">"#*"</span>)</span>
<span id="cb185-195"><a href="#cb185-195" aria-hidden="true" tabindex="-1"></a>Healytoptag <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">topfeatures</span>(Healy_Dfm, <span class="dv">30</span>)) </span>
<span id="cb185-196"><a href="#cb185-196" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Healytoptag)</span>
<span id="cb185-197"><a href="#cb185-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-200"><a href="#cb185-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-201"><a href="#cb185-201" aria-hidden="true" tabindex="-1"></a>Healytag_fcm <span class="ot">&lt;-</span> <span class="fu">fcm</span>(Healy_Dfm, <span class="at">context =</span> <span class="st">"document"</span>, <span class="at">tri =</span> <span class="cn">FALSE</span>)</span>
<span id="cb185-202"><a href="#cb185-202" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Healytag_fcm)</span>
<span id="cb185-203"><a href="#cb185-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-204"><a href="#cb185-204" aria-hidden="true" tabindex="-1"></a><span class="fu">## Semantic Network Visualization</span></span>
<span id="cb185-205"><a href="#cb185-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-208"><a href="#cb185-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-209"><a href="#cb185-209" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualization of semantic network based on hashtag co-occurrence</span></span>
<span id="cb185-210"><a href="#cb185-210" aria-hidden="true" tabindex="-1"></a>Healytopgat_fcm <span class="ot">&lt;-</span> <span class="fu">fcm_select</span>(Healytag_fcm, <span class="at">pattern =</span> Healytoptag)</span>
<span id="cb185-211"><a href="#cb185-211" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_network</span>(Healytopgat_fcm, <span class="at">min_freq =</span> <span class="fl">0.8</span>,</span>
<span id="cb185-212"><a href="#cb185-212" aria-hidden="true" tabindex="-1"></a>                 <span class="at">omit_isolated =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-213"><a href="#cb185-213" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_color =</span> <span class="st">"#1F78B4"</span>,</span>
<span id="cb185-214"><a href="#cb185-214" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb185-215"><a href="#cb185-215" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_size =</span> <span class="dv">2</span>,</span>
<span id="cb185-216"><a href="#cb185-216" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_color =</span> <span class="st">"#4D4D4D"</span>,</span>
<span id="cb185-217"><a href="#cb185-217" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_size =</span> <span class="dv">2</span>,</span>
<span id="cb185-218"><a href="#cb185-218" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelcolor =</span> <span class="cn">NULL</span>,</span>
<span id="cb185-219"><a href="#cb185-219" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelfont =</span> <span class="cn">NULL</span>,</span>
<span id="cb185-220"><a href="#cb185-220" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelsize =</span> <span class="dv">8</span>,</span>
<span id="cb185-221"><a href="#cb185-221" aria-hidden="true" tabindex="-1"></a>                 <span class="at">offset =</span> <span class="cn">NULL</span>)</span>
<span id="cb185-222"><a href="#cb185-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-223"><a href="#cb185-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-226"><a href="#cb185-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-227"><a href="#cb185-227" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_network</span>(Healytopgat_fcm, <span class="at">vertex_labelsize =</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">rowSums</span>(Healytopgat_fcm)<span class="sc">/</span><span class="fu">min</span>(<span class="fu">rowSums</span>(Healytopgat_fcm)))</span>
<span id="cb185-228"><a href="#cb185-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-229"><a href="#cb185-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-230"><a href="#cb185-230" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sentiment Analysis</span></span>
<span id="cb185-231"><a href="#cb185-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-234"><a href="#cb185-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-235"><a href="#cb185-235" aria-hidden="true" tabindex="-1"></a><span class="co">#convert cleaned Healy_tokens back tp corpus for sentiment analysis</span></span>
<span id="cb185-236"><a href="#cb185-236" aria-hidden="true" tabindex="-1"></a>Healy_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(<span class="fu">as.character</span>(Healy_tokens))</span>
<span id="cb185-237"><a href="#cb185-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-238"><a href="#cb185-238" aria-hidden="true" tabindex="-1"></a><span class="fu">### NRC Dictionary</span></span>
<span id="cb185-239"><a href="#cb185-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-242"><a href="#cb185-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-243"><a href="#cb185-243" aria-hidden="true" tabindex="-1"></a><span class="co"># use liwcalike() to estimate sentiment using NRC dictionary</span></span>
<span id="cb185-244"><a href="#cb185-244" aria-hidden="true" tabindex="-1"></a>HealyTweetSentiment_nrc <span class="ot">&lt;-</span> <span class="fu">liwcalike</span>(Healy_corpus, data_dictionary_NRC)</span>
<span id="cb185-245"><a href="#cb185-245" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(HealyTweetSentiment_nrc)</span>
<span id="cb185-246"><a href="#cb185-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-249"><a href="#cb185-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-250"><a href="#cb185-250" aria-hidden="true" tabindex="-1"></a>HealyTweetSentiment_nrc_viz <span class="ot">&lt;-</span> HealyTweetSentiment_nrc <span class="sc">%&gt;%</span></span>
<span id="cb185-251"><a href="#cb185-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"anticipation"</span>, <span class="st">"disgust"</span>, <span class="st">"fear"</span>,<span class="st">"joy"</span>,<span class="st">"sadness"</span>, <span class="st">"surprise"</span>,<span class="st">"trust"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>))</span>
<span id="cb185-252"><a href="#cb185-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-255"><a href="#cb185-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-256"><a href="#cb185-256" aria-hidden="true" tabindex="-1"></a>Healy_tr<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">t</span>(HealyTweetSentiment_nrc_viz)) <span class="co">#transpose</span></span>
<span id="cb185-257"><a href="#cb185-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-260"><a href="#cb185-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-261"><a href="#cb185-261" aria-hidden="true" tabindex="-1"></a>Healy_tr_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(Healy_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">1900</span>]))</span>
<span id="cb185-262"><a href="#cb185-262" aria-hidden="true" tabindex="-1"></a>Healy_tr_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowMeans</span>(Healy_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">1900</span>]))<span class="co">#get mean of sentiment values</span></span>
<span id="cb185-263"><a href="#cb185-263" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Healy_tr_new)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Count"</span></span>
<span id="cb185-264"><a href="#cb185-264" aria-hidden="true" tabindex="-1"></a>Healy_tr_new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Healy_tr_new), Healy_tr_new)</span>
<span id="cb185-265"><a href="#cb185-265" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Healy_tr_new) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb185-266"><a href="#cb185-266" aria-hidden="true" tabindex="-1"></a>Healy_tr_new2<span class="ot">&lt;-</span>Healy_tr_new[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb185-267"><a href="#cb185-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-270"><a href="#cb185-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-271"><a href="#cb185-271" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healy_tr_new2,<span class="st">"Healy-Sentiments"</span>)</span>
<span id="cb185-272"><a href="#cb185-272" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healy_tr_new,<span class="st">"Healy-8 Sentiments"</span>)</span>
<span id="cb185-273"><a href="#cb185-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-276"><a href="#cb185-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-277"><a href="#cb185-277" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb185-278"><a href="#cb185-278" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Healy_tr_new2, <span class="at">weight=</span>Count, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"count"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Emotions of REPLIES to Maura Healey Tweets"</span>)</span>
<span id="cb185-279"><a href="#cb185-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-282"><a href="#cb185-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-283"><a href="#cb185-283" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Healy_tr_mean)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Mean"</span></span>
<span id="cb185-284"><a href="#cb185-284" aria-hidden="true" tabindex="-1"></a>Healy_tr_mean <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Healy_tr_mean), Healy_tr_mean)</span>
<span id="cb185-285"><a href="#cb185-285" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Healy_tr_mean) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb185-286"><a href="#cb185-286" aria-hidden="true" tabindex="-1"></a>Healy_tr_mean2<span class="ot">&lt;-</span>Healy_tr_mean[<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb185-287"><a href="#cb185-287" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healy_tr_mean2,<span class="st">"Healy-Mean Sentiments"</span>)</span>
<span id="cb185-288"><a href="#cb185-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-291"><a href="#cb185-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-292"><a href="#cb185-292" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb185-293"><a href="#cb185-293" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Healy_tr_mean2, <span class="at">weight=</span>Mean, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"Mean Sentiment Score"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Mean Sentiment Scores to Maura Healey Tweets"</span>)</span>
<span id="cb185-294"><a href="#cb185-294" aria-hidden="true" tabindex="-1"></a>                                                                                                                        </span>
<span id="cb185-295"><a href="#cb185-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-296"><a href="#cb185-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-297"><a href="#cb185-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-298"><a href="#cb185-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Polarity scores</span></span>
<span id="cb185-299"><a href="#cb185-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-302"><a href="#cb185-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-303"><a href="#cb185-303" aria-hidden="true" tabindex="-1"></a><span class="co"># POLARITY</span></span>
<span id="cb185-304"><a href="#cb185-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-305"><a href="#cb185-305" aria-hidden="true" tabindex="-1"></a>Healydf_nrc <span class="ot">&lt;-</span> <span class="fu">convert</span>(HealyDfm_nrc, <span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb185-306"><a href="#cb185-306" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Healydf_nrc)</span>
<span id="cb185-307"><a href="#cb185-307" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Healydf_nrc,<span class="st">"Healy-Polarity Scores"</span>)</span>
<span id="cb185-308"><a href="#cb185-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-309"><a href="#cb185-309" aria-hidden="true" tabindex="-1"></a>Healydf_nrc<span class="sc">$</span>polarity <span class="ot">&lt;-</span> (Healydf_nrc<span class="sc">$</span>positive <span class="sc">-</span> Healydf_nrc<span class="sc">$</span>negative)<span class="sc">/</span>(Healydf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Healydf_nrc<span class="sc">$</span>negative)</span>
<span id="cb185-310"><a href="#cb185-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-311"><a href="#cb185-311" aria-hidden="true" tabindex="-1"></a>Healydf_nrc<span class="sc">$</span>polarity[(Healydf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Healydf_nrc<span class="sc">$</span>negative) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb185-312"><a href="#cb185-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-313"><a href="#cb185-313" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Healydf_nrc) <span class="sc">+</span></span>
<span id="cb185-314"><a href="#cb185-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>polarity)) <span class="sc">+</span></span>
<span id="cb185-315"><a href="#cb185-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb185-316"><a href="#cb185-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-317"><a href="#cb185-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-318"><a href="#cb185-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-319"><a href="#cb185-319" aria-hidden="true" tabindex="-1"></a><span class="fu">## New DF with Polarity scores</span></span>
<span id="cb185-322"><a href="#cb185-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-323"><a href="#cb185-323" aria-hidden="true" tabindex="-1"></a>Healy_text_df <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(Healy_text_df)</span>
<span id="cb185-324"><a href="#cb185-324" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>((<span class="fu">cbind</span>(Healydf_nrc,Healy_text_df)))</span>
<span id="cb185-325"><a href="#cb185-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-326"><a href="#cb185-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-327"><a href="#cb185-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## New CORPUS (Polarity+text)</span></span>
<span id="cb185-330"><a href="#cb185-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-331"><a href="#cb185-331" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity <span class="ot">&lt;-</span> HealyCorpus_Polarity <span class="sc">%&gt;%</span></span>
<span id="cb185-332"><a href="#cb185-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"polarity"</span>,<span class="st">"Healy_corpus"</span>))</span>
<span id="cb185-333"><a href="#cb185-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb185-336"><a href="#cb185-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-337"><a href="#cb185-337" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity<span class="sc">$</span>polarity <span class="ot">&lt;-</span> <span class="fu">recode</span>(HealyCorpus_Polarity<span class="sc">$</span>polarity,</span>
<span id="cb185-338"><a href="#cb185-338" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"positive"</span>,</span>
<span id="cb185-339"><a href="#cb185-339" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"negative"</span>,</span>
<span id="cb185-340"><a href="#cb185-340" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"neutral"</span>,)</span>
<span id="cb185-341"><a href="#cb185-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-342"><a href="#cb185-342" aria-hidden="true" tabindex="-1"></a><span class="fu">### Omit na</span></span>
<span id="cb185-345"><a href="#cb185-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-346"><a href="#cb185-346" aria-hidden="true" tabindex="-1"></a>HealyCorpus_Polarity <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(HealyCorpus_Polarity)</span>
<span id="cb185-347"><a href="#cb185-347" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(HealyCorpus_Polarity)</span>
<span id="cb185-348"><a href="#cb185-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-349"><a href="#cb185-349" aria-hidden="true" tabindex="-1"></a><span class="fu">### Convert cleaned DF to corpus</span></span>
<span id="cb185-352"><a href="#cb185-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-353"><a href="#cb185-353" aria-hidden="true" tabindex="-1"></a>HealyCorpus_P<span class="ot">&lt;-</span> <span class="fu">corpus</span>(HealyCorpus_Polarity,<span class="at">text_field =</span> <span class="st">"Healy_corpus"</span>)   </span>
<span id="cb185-354"><a href="#cb185-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-355"><a href="#cb185-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-356"><a href="#cb185-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-357"><a href="#cb185-357" aria-hidden="true" tabindex="-1"></a><span class="fu"># HEALEY- MACHINE LEARNING METHODS</span></span>
<span id="cb185-358"><a href="#cb185-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-359"><a href="#cb185-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-362"><a href="#cb185-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-363"><a href="#cb185-363" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb185-364"><a href="#cb185-364" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-365"><a href="#cb185-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-366"><a href="#cb185-366" aria-hidden="true" tabindex="-1"></a><span class="co"># create id variable in corpus metadata</span></span>
<span id="cb185-367"><a href="#cb185-367" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(HealyCorpus_P, <span class="st">"id"</span>) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ndoc</span>(HealyCorpus_P)</span>
<span id="cb185-368"><a href="#cb185-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-369"><a href="#cb185-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-370"><a href="#cb185-370" aria-hidden="true" tabindex="-1"></a><span class="co"># create training set (60% of data) and initial test set</span></span>
<span id="cb185-371"><a href="#cb185-371" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">ndoc</span>(HealyCorpus_P)</span>
<span id="cb185-372"><a href="#cb185-372" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N,.<span class="dv">6</span> <span class="sc">*</span> N) </span>
<span id="cb185-373"><a href="#cb185-373" aria-hidden="true" tabindex="-1"></a>testIndex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>N)[<span class="sc">-</span>trainIndex]</span>
<span id="cb185-374"><a href="#cb185-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-375"><a href="#cb185-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-376"><a href="#cb185-376" aria-hidden="true" tabindex="-1"></a><span class="co"># split test set in half (so 20% of data are test, 20% of data are held-out)</span></span>
<span id="cb185-377"><a href="#cb185-377" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(testIndex)</span>
<span id="cb185-378"><a href="#cb185-378" aria-hidden="true" tabindex="-1"></a>heldOutIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, .<span class="dv">5</span> <span class="sc">*</span> N)</span>
<span id="cb185-379"><a href="#cb185-379" aria-hidden="true" tabindex="-1"></a>testIndex <span class="ot">&lt;-</span> testIndex[<span class="sc">-</span>heldOutIndex]</span>
<span id="cb185-380"><a href="#cb185-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-381"><a href="#cb185-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-382"><a href="#cb185-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-383"><a href="#cb185-383" aria-hidden="true" tabindex="-1"></a><span class="co"># now apply indices to create subsets and dfms</span></span>
<span id="cb185-384"><a href="#cb185-384" aria-hidden="true" tabindex="-1"></a>dfmTrain <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> trainIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb185-385"><a href="#cb185-385" aria-hidden="true" tabindex="-1"></a>dfmTest <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb185-386"><a href="#cb185-386" aria-hidden="true" tabindex="-1"></a>dfmHeldOut <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> heldOutIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb185-387"><a href="#cb185-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-388"><a href="#cb185-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-389"><a href="#cb185-389" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trainIndex)</span>
<span id="cb185-390"><a href="#cb185-390" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(testIndex)</span>
<span id="cb185-391"><a href="#cb185-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-392"><a href="#cb185-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-393"><a href="#cb185-393" aria-hidden="true" tabindex="-1"></a><span class="fu">## NB model</span></span>
<span id="cb185-396"><a href="#cb185-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-397"><a href="#cb185-397" aria-hidden="true" tabindex="-1"></a>polarity_NaiveBayes <span class="ot">&lt;-</span> <span class="fu">textmodel_nb</span>(dfmTrain, <span class="fu">docvars</span>(dfmTrain, <span class="st">"polarity"</span>), <span class="at">distribution =</span> <span class="st">"Bernoulli"</span>) </span>
<span id="cb185-398"><a href="#cb185-398" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(polarity_NaiveBayes)</span>
<span id="cb185-399"><a href="#cb185-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-400"><a href="#cb185-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-401"><a href="#cb185-401" aria-hidden="true" tabindex="-1"></a>dfmTestMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(dfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(dfmTrain))</span>
<span id="cb185-402"><a href="#cb185-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-403"><a href="#cb185-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-404"><a href="#cb185-404" aria-hidden="true" tabindex="-1"></a><span class="fu">### CONFUSION MATRIX</span></span>
<span id="cb185-405"><a href="#cb185-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-408"><a href="#cb185-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-409"><a href="#cb185-409" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb185-410"><a href="#cb185-410" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(dfmTestMatched, <span class="st">"polarity"</span>)</span>
<span id="cb185-411"><a href="#cb185-411" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> dfmTestMatched)</span>
<span id="cb185-412"><a href="#cb185-412" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, predicted)</span>
<span id="cb185-413"><a href="#cb185-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-414"><a href="#cb185-414" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb185-415"><a href="#cb185-415" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span>
<span id="cb185-416"><a href="#cb185-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-417"><a href="#cb185-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-418"><a href="#cb185-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-421"><a href="#cb185-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-422"><a href="#cb185-422" aria-hidden="true" tabindex="-1"></a>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> dfmTestMatched, <span class="at">type =</span> <span class="st">"probability"</span>)</span>
<span id="cb185-423"><a href="#cb185-423" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predicted_prob)</span>
<span id="cb185-424"><a href="#cb185-424" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(predicted_prob)</span>
<span id="cb185-425"><a href="#cb185-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-428"><a href="#cb185-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-429"><a href="#cb185-429" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb185-430"><a href="#cb185-430" aria-hidden="true" tabindex="-1"></a>mostPos <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(predicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb185-431"><a href="#cb185-431" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex))[mostPos]</span>
<span id="cb185-432"><a href="#cb185-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-433"><a href="#cb185-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-436"><a href="#cb185-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-437"><a href="#cb185-437" aria-hidden="true" tabindex="-1"></a>mostNeg <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(predicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>T)[<span class="dv">1</span>]</span>
<span id="cb185-438"><a href="#cb185-438" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex))[mostNeg]</span>
<span id="cb185-439"><a href="#cb185-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-442"><a href="#cb185-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-443"><a href="#cb185-443" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb185-444"><a href="#cb185-444" aria-hidden="true" tabindex="-1"></a>mixed <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(<span class="fu">abs</span>(predicted_prob[,<span class="dv">1</span>] <span class="sc">-</span> .<span class="dv">5</span>), <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb185-445"><a href="#cb185-445" aria-hidden="true" tabindex="-1"></a>predicted_prob[mixed,]</span>
<span id="cb185-446"><a href="#cb185-446" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> testIndex))[mixed]</span>
<span id="cb185-447"><a href="#cb185-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-448"><a href="#cb185-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-449"><a href="#cb185-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-450"><a href="#cb185-450" aria-hidden="true" tabindex="-1"></a><span class="fu"># Naive Bayes -held out</span></span>
<span id="cb185-451"><a href="#cb185-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-454"><a href="#cb185-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-455"><a href="#cb185-455" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(dfmHeldOut)<span class="sc">$</span>polarity</span>
<span id="cb185-456"><a href="#cb185-456" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(actual)</span>
<span id="cb185-457"><a href="#cb185-457" aria-hidden="true" tabindex="-1"></a>dfmHeldOutMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(dfmHeldOut, <span class="at">features =</span> <span class="fu">featnames</span>(dfmTrain))</span>
<span id="cb185-458"><a href="#cb185-458" aria-hidden="true" tabindex="-1"></a>predicted.nb <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, dfmHeldOutMatched)</span>
<span id="cb185-459"><a href="#cb185-459" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(predicted.nb)</span>
<span id="cb185-460"><a href="#cb185-460" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, predicted.nb)</span>
<span id="cb185-461"><a href="#cb185-461" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span>
<span id="cb185-462"><a href="#cb185-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-463"><a href="#cb185-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-464"><a href="#cb185-464" aria-hidden="true" tabindex="-1"></a><span class="fu">## SVM</span></span>
<span id="cb185-465"><a href="#cb185-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-468"><a href="#cb185-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-469"><a href="#cb185-469" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb185-470"><a href="#cb185-470" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-471"><a href="#cb185-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-472"><a href="#cb185-472" aria-hidden="true" tabindex="-1"></a><span class="co"># set of training data</span></span>
<span id="cb185-473"><a href="#cb185-473" aria-hidden="true" tabindex="-1"></a>newTrainIndex <span class="ot">&lt;-</span> trainIndex[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(trainIndex))]</span>
<span id="cb185-474"><a href="#cb185-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-475"><a href="#cb185-475" aria-hidden="true" tabindex="-1"></a><span class="co"># create small DFM</span></span>
<span id="cb185-476"><a href="#cb185-476" aria-hidden="true" tabindex="-1"></a>dfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(HealyCorpus_P, id <span class="sc">%in%</span> newTrainIndex) <span class="sc">%&gt;%</span> <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">"English"</span>), <span class="at">remove_punct=</span>T)</span>
<span id="cb185-477"><a href="#cb185-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-478"><a href="#cb185-478" aria-hidden="true" tabindex="-1"></a><span class="co"># trim the DFM down to frequent terms</span></span>
<span id="cb185-479"><a href="#cb185-479" aria-hidden="true" tabindex="-1"></a>dfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(dfmTrainSmall, <span class="at">min_docfreq =</span> <span class="dv">20</span>, <span class="at">min_termfreq =</span> <span class="dv">20</span>)</span>
<span id="cb185-480"><a href="#cb185-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-481"><a href="#cb185-481" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dfmTrainSmall)</span>
<span id="cb185-482"><a href="#cb185-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-483"><a href="#cb185-483" aria-hidden="true" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb185-484"><a href="#cb185-484" aria-hidden="true" tabindex="-1"></a>polarity_SVM <span class="ot">&lt;-</span> <span class="fu">textmodel_svm</span>(dfmTrainSmall, <span class="fu">docvars</span>(dfmTrainSmall, <span class="st">"polarity"</span>)) </span>
<span id="cb185-485"><a href="#cb185-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-486"><a href="#cb185-486" aria-hidden="true" tabindex="-1"></a><span class="co"># update test set</span></span>
<span id="cb185-487"><a href="#cb185-487" aria-hidden="true" tabindex="-1"></a>dfmTestMatchedSmall <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(dfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(dfmTrainSmall))</span>
<span id="cb185-488"><a href="#cb185-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-489"><a href="#cb185-489" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb185-490"><a href="#cb185-490" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(dfmTestMatchedSmall, <span class="st">"polarity"</span>)</span>
<span id="cb185-491"><a href="#cb185-491" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_SVM, <span class="at">newdata =</span> dfmTestMatchedSmall)</span>
<span id="cb185-492"><a href="#cb185-492" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, predicted)</span>
<span id="cb185-493"><a href="#cb185-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-494"><a href="#cb185-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-495"><a href="#cb185-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confusion Matrix</span></span>
<span id="cb185-498"><a href="#cb185-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-499"><a href="#cb185-499" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb185-500"><a href="#cb185-500" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span>
<span id="cb185-501"><a href="#cb185-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-504"><a href="#cb185-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-505"><a href="#cb185-505" aria-hidden="true" tabindex="-1"></a><span class="co"># check code---Error in order(V1) : object 'V1' not found</span></span>
<span id="cb185-506"><a href="#cb185-506" aria-hidden="true" tabindex="-1"></a>svmCoefs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">coefficients</span>(polarity_SVM)))</span>
<span id="cb185-507"><a href="#cb185-507" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svmCoefs,<span class="dv">10</span>)</span>
<span id="cb185-508"><a href="#cb185-508" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(svmCoefs,<span class="dv">10</span>)</span>
<span id="cb185-509"><a href="#cb185-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-510"><a href="#cb185-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-511"><a href="#cb185-511" aria-hidden="true" tabindex="-1"></a><span class="fu">## RANDOM FOREST</span></span>
<span id="cb185-512"><a href="#cb185-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-515"><a href="#cb185-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-516"><a href="#cb185-516" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb185-517"><a href="#cb185-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-518"><a href="#cb185-518" aria-hidden="true" tabindex="-1"></a>dfmTrainSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(dfmTrainSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb185-519"><a href="#cb185-519" aria-hidden="true" tabindex="-1"></a>dfmTestMatchedSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(dfmTestMatchedSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb185-520"><a href="#cb185-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-521"><a href="#cb185-521" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-522"><a href="#cb185-522" aria-hidden="true" tabindex="-1"></a>Healey_polarity_RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(dfmTrainSmallRf, </span>
<span id="cb185-523"><a href="#cb185-523" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(dfmTrainSmall)<span class="sc">$</span>polarity),</span>
<span id="cb185-524"><a href="#cb185-524" aria-hidden="true" tabindex="-1"></a>                            <span class="at">xtest =</span> dfmTestMatchedSmallRf, </span>
<span id="cb185-525"><a href="#cb185-525" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ytest =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(dfmTestMatchedSmall)<span class="sc">$</span>polarity),</span>
<span id="cb185-526"><a href="#cb185-526" aria-hidden="true" tabindex="-1"></a>                            <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-527"><a href="#cb185-527" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mtry =</span> <span class="dv">20</span>,</span>
<span id="cb185-528"><a href="#cb185-528" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ntree =</span> <span class="dv">100</span></span>
<span id="cb185-529"><a href="#cb185-529" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb185-530"><a href="#cb185-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-531"><a href="#cb185-531" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-532"><a href="#cb185-532" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confusion Matrix</span></span>
<span id="cb185-535"><a href="#cb185-535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-536"><a href="#cb185-536" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(dfmTestMatchedSmall)<span class="sc">$</span>polarity)</span>
<span id="cb185-537"><a href="#cb185-537" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> Healey_polarity_RF<span class="sc">$</span>test[[<span class="st">'predicted'</span>]]</span>
<span id="cb185-538"><a href="#cb185-538" aria-hidden="true" tabindex="-1"></a>confusion <span class="ot">&lt;-</span> <span class="fu">table</span>(actual,predicted)</span>
<span id="cb185-539"><a href="#cb185-539" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(confusion, <span class="at">mode=</span><span class="st">"everything"</span>)</span>
<span id="cb185-540"><a href="#cb185-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-543"><a href="#cb185-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-544"><a href="#cb185-544" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(Healey_polarity_RF)</span>
<span id="cb185-545"><a href="#cb185-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-546"><a href="#cb185-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-547"><a href="#cb185-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-548"><a href="#cb185-548" aria-hidden="true" tabindex="-1"></a>--------------------------------------------------</span>
<span id="cb185-549"><a href="#cb185-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-550"><a href="#cb185-550" aria-hidden="true" tabindex="-1"></a><span class="fu"># DIEHL DATA</span></span>
<span id="cb185-551"><a href="#cb185-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-552"><a href="#cb185-552" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Data</span></span>
<span id="cb185-555"><a href="#cb185-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-556"><a href="#cb185-556" aria-hidden="true" tabindex="-1"></a>Diehl <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Diehl.csv"</span>)</span>
<span id="cb185-557"><a href="#cb185-557" aria-hidden="true" tabindex="-1"></a>Diehl<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"@[[:alpha:]]*"</span>,<span class="st">""</span>, Diehl<span class="sc">$</span>text) <span class="co">#remove Twitter handles</span></span>
<span id="cb185-558"><a href="#cb185-558" aria-hidden="true" tabindex="-1"></a>Diehl<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"&amp;amp"</span>, <span class="st">""</span>, Diehl<span class="sc">$</span>text)</span>
<span id="cb185-559"><a href="#cb185-559" aria-hidden="true" tabindex="-1"></a>Diehl<span class="sc">$</span>text <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">""</span>, Diehl<span class="sc">$</span>text)</span>
<span id="cb185-560"><a href="#cb185-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-561"><a href="#cb185-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-562"><a href="#cb185-562" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Cleaning/ Preprocessing</span></span>
<span id="cb185-565"><a href="#cb185-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-566"><a href="#cb185-566" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(Diehl<span class="sc">$</span>text))</span>
<span id="cb185-567"><a href="#cb185-567" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, tolower) <span class="co">#lowercase</span></span>
<span id="cb185-568"><a href="#cb185-568" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removeWords, </span>
<span id="cb185-569"><a href="#cb185-569" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"s"</span>,<span class="st">"geoff"</span>, <span class="st">"diehl"</span>,<span class="st">"rt"</span>, <span class="st">"amp"</span>))</span>
<span id="cb185-570"><a href="#cb185-570" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removeWords, </span>
<span id="cb185-571"><a href="#cb185-571" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb185-572"><a href="#cb185-572" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removePunctuation)</span>
<span id="cb185-573"><a href="#cb185-573" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, stripWhitespace)</span>
<span id="cb185-574"><a href="#cb185-574" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(Diehl_corpus, removeNumbers)</span>
<span id="cb185-575"><a href="#cb185-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-576"><a href="#cb185-576" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(Diehl_corpus,<span class="at">text_field =</span> <span class="st">"text"</span>) </span>
<span id="cb185-577"><a href="#cb185-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-578"><a href="#cb185-578" aria-hidden="true" tabindex="-1"></a>Diehl_text_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Diehl_corpus)</span>
<span id="cb185-579"><a href="#cb185-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-580"><a href="#cb185-580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-581"><a href="#cb185-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-582"><a href="#cb185-582" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tokenize and stemming</span></span>
<span id="cb185-585"><a href="#cb185-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-586"><a href="#cb185-586" aria-hidden="true" tabindex="-1"></a>Diehl_tokens <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Diehl_corpus)</span>
<span id="cb185-587"><a href="#cb185-587" aria-hidden="true" tabindex="-1"></a>Diehl_tokens <span class="ot">&lt;-</span> <span class="fu">tokens_wordstem</span>(Diehl_tokens)</span>
<span id="cb185-588"><a href="#cb185-588" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Diehl_tokens)</span>
<span id="cb185-589"><a href="#cb185-589" aria-hidden="true" tabindex="-1"></a><span class="fu">dfm</span>(Diehl_tokens)</span>
<span id="cb185-590"><a href="#cb185-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-591"><a href="#cb185-591" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create dfm</span></span>
<span id="cb185-594"><a href="#cb185-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-595"><a href="#cb185-595" aria-hidden="true" tabindex="-1"></a><span class="co"># create a full dfm for comparison---use this to append to polarity</span></span>
<span id="cb185-596"><a href="#cb185-596" aria-hidden="true" tabindex="-1"></a>Diehl_Dfm <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Diehl_tokens,</span>
<span id="cb185-597"><a href="#cb185-597" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-598"><a href="#cb185-598" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-599"><a href="#cb185-599" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-600"><a href="#cb185-600" aria-hidden="true" tabindex="-1"></a>                    <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-601"><a href="#cb185-601" aria-hidden="true" tabindex="-1"></a>                    <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-602"><a href="#cb185-602" aria-hidden="true" tabindex="-1"></a>                    <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-603"><a href="#cb185-603" aria-hidden="true" tabindex="-1"></a>                    <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-604"><a href="#cb185-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-605"><a href="#cb185-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb185-606"><a href="#cb185-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-607"><a href="#cb185-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>()</span>
<span id="cb185-608"><a href="#cb185-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-609"><a href="#cb185-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-610"><a href="#cb185-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-611"><a href="#cb185-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-612"><a href="#cb185-612" aria-hidden="true" tabindex="-1"></a><span class="fu">## TF-IDF</span></span>
<span id="cb185-613"><a href="#cb185-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-616"><a href="#cb185-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-617"><a href="#cb185-617" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Diehl_Dfm)</span>
<span id="cb185-618"><a href="#cb185-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-621"><a href="#cb185-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-622"><a href="#cb185-622" aria-hidden="true" tabindex="-1"></a>Diehl_tf_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(Diehl_Dfm, <span class="at">force =</span> <span class="cn">TRUE</span>) <span class="co">#create a new DFM by tf-idf scores</span></span>
<span id="cb185-623"><a href="#cb185-623" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(Diehl_tf_dfm) <span class="do">## this shows top words by tf-idf</span></span>
<span id="cb185-624"><a href="#cb185-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-625"><a href="#cb185-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-626"><a href="#cb185-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-629"><a href="#cb185-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-630"><a href="#cb185-630" aria-hidden="true" tabindex="-1"></a><span class="co"># convert corpus to dfm using the dictionary---use to append </span></span>
<span id="cb185-631"><a href="#cb185-631" aria-hidden="true" tabindex="-1"></a>DiehlDfm_nrc <span class="ot">&lt;-</span> <span class="fu">tokens</span>(Diehl_tokens,</span>
<span id="cb185-632"><a href="#cb185-632" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_punct =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-633"><a href="#cb185-633" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-634"><a href="#cb185-634" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-635"><a href="#cb185-635" aria-hidden="true" tabindex="-1"></a>                       <span class="at">remove_url =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-636"><a href="#cb185-636" aria-hidden="true" tabindex="-1"></a>                       <span class="at">split_tags =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-637"><a href="#cb185-637" aria-hidden="true" tabindex="-1"></a>                       <span class="at">split_hyphens =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-638"><a href="#cb185-638" aria-hidden="true" tabindex="-1"></a>                       <span class="at">include_docvars =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-639"><a href="#cb185-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-640"><a href="#cb185-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">'english'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb185-641"><a href="#cb185-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_trim</span>(<span class="at">min_termfreq =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-642"><a href="#cb185-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-643"><a href="#cb185-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_lookup</span>(data_dictionary_NRC)</span>
<span id="cb185-644"><a href="#cb185-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-645"><a href="#cb185-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-646"><a href="#cb185-646" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(DiehlDfm_nrc)</span>
<span id="cb185-647"><a href="#cb185-647" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DiehlDfm_nrc, <span class="dv">10</span>)</span>
<span id="cb185-648"><a href="#cb185-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-649"><a href="#cb185-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-650"><a href="#cb185-650" aria-hidden="true" tabindex="-1"></a><span class="fu">## Word CLoud</span></span>
<span id="cb185-653"><a href="#cb185-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-654"><a href="#cb185-654" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb185-655"><a href="#cb185-655" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_wordcloud</span>(Diehl_Dfm, <span class="at">scale=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>), <span class="at">max.words=</span><span class="dv">50</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.35</span>, <span class="at">use.r.layout=</span><span class="cn">FALSE</span>, <span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span>
<span id="cb185-656"><a href="#cb185-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-657"><a href="#cb185-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-658"><a href="#cb185-658" aria-hidden="true" tabindex="-1"></a><span class="fu">## Feature-occurrence matrix </span></span>
<span id="cb185-661"><a href="#cb185-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-662"><a href="#cb185-662" aria-hidden="true" tabindex="-1"></a>Diehltag_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_select</span>(Diehl_Dfm, <span class="at">pattern =</span> <span class="st">"#*"</span>)</span>
<span id="cb185-663"><a href="#cb185-663" aria-hidden="true" tabindex="-1"></a>Diehltoptag <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">topfeatures</span>(Diehl_Dfm, <span class="dv">30</span>)) </span>
<span id="cb185-664"><a href="#cb185-664" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Diehltoptag)</span>
<span id="cb185-665"><a href="#cb185-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-668"><a href="#cb185-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-669"><a href="#cb185-669" aria-hidden="true" tabindex="-1"></a>Diehltag_fcm <span class="ot">&lt;-</span> <span class="fu">fcm</span>(Diehl_Dfm)</span>
<span id="cb185-670"><a href="#cb185-670" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Diehltag_fcm)</span>
<span id="cb185-671"><a href="#cb185-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-672"><a href="#cb185-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-673"><a href="#cb185-673" aria-hidden="true" tabindex="-1"></a><span class="fu">## Semantic Network Analysis</span></span>
<span id="cb185-676"><a href="#cb185-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-677"><a href="#cb185-677" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualization of semantic network based on hashtag co-occurrence</span></span>
<span id="cb185-678"><a href="#cb185-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-679"><a href="#cb185-679" aria-hidden="true" tabindex="-1"></a>Diehltopgat_fcm <span class="ot">&lt;-</span> <span class="fu">fcm_select</span>(Diehltag_fcm, <span class="at">pattern =</span> Diehltoptag)</span>
<span id="cb185-680"><a href="#cb185-680" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_network</span>(Diehltopgat_fcm, <span class="at">min_freq =</span> <span class="fl">0.8</span>,</span>
<span id="cb185-681"><a href="#cb185-681" aria-hidden="true" tabindex="-1"></a>                 <span class="at">omit_isolated =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-682"><a href="#cb185-682" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_color =</span> <span class="st">"#1F78B4"</span>,</span>
<span id="cb185-683"><a href="#cb185-683" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb185-684"><a href="#cb185-684" aria-hidden="true" tabindex="-1"></a>                 <span class="at">edge_size =</span> <span class="dv">2</span>,</span>
<span id="cb185-685"><a href="#cb185-685" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_color =</span> <span class="st">"#4D4D4D"</span>,</span>
<span id="cb185-686"><a href="#cb185-686" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_size =</span> <span class="dv">2</span>,</span>
<span id="cb185-687"><a href="#cb185-687" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelcolor =</span> <span class="cn">NULL</span>,</span>
<span id="cb185-688"><a href="#cb185-688" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelfont =</span> <span class="cn">NULL</span>,</span>
<span id="cb185-689"><a href="#cb185-689" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vertex_labelsize =</span> <span class="dv">8</span>,</span>
<span id="cb185-690"><a href="#cb185-690" aria-hidden="true" tabindex="-1"></a>                 <span class="at">offset =</span> <span class="cn">NULL</span>)</span>
<span id="cb185-691"><a href="#cb185-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-692"><a href="#cb185-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-693"><a href="#cb185-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-694"><a href="#cb185-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-695"><a href="#cb185-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sentiment Analysis</span></span>
<span id="cb185-696"><a href="#cb185-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-697"><a href="#cb185-697" aria-hidden="true" tabindex="-1"></a><span class="fu">### NRC Dictionary</span></span>
<span id="cb185-700"><a href="#cb185-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-701"><a href="#cb185-701" aria-hidden="true" tabindex="-1"></a><span class="co">#convert cleaned Diehl_tokens back tp corpus for sentiment analysis</span></span>
<span id="cb185-702"><a href="#cb185-702" aria-hidden="true" tabindex="-1"></a>Diehl_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(<span class="fu">as.character</span>(Diehl_tokens))</span>
<span id="cb185-703"><a href="#cb185-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-704"><a href="#cb185-704" aria-hidden="true" tabindex="-1"></a><span class="co"># use liwcalike() to estimate sentiment using NRC dictionary</span></span>
<span id="cb185-705"><a href="#cb185-705" aria-hidden="true" tabindex="-1"></a>DiehlTweetSentiment_nrc <span class="ot">&lt;-</span> <span class="fu">liwcalike</span>(Diehl_corpus, data_dictionary_NRC)</span>
<span id="cb185-706"><a href="#cb185-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-707"><a href="#cb185-707" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(DiehlTweetSentiment_nrc)</span>
<span id="cb185-708"><a href="#cb185-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-711"><a href="#cb185-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-712"><a href="#cb185-712" aria-hidden="true" tabindex="-1"></a>DiehlTweetSentiment_nrc_viz <span class="ot">&lt;-</span> DiehlTweetSentiment_nrc <span class="sc">%&gt;%</span></span>
<span id="cb185-713"><a href="#cb185-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"anger"</span>, <span class="st">"anticipation"</span>, <span class="st">"disgust"</span>, <span class="st">"fear"</span>,<span class="st">"joy"</span>,<span class="st">"sadness"</span>, <span class="st">"surprise"</span>,<span class="st">"trust"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>))</span>
<span id="cb185-714"><a href="#cb185-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-715"><a href="#cb185-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-716"><a href="#cb185-716" aria-hidden="true" tabindex="-1"></a>Diehl_tr<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">t</span>(DiehlTweetSentiment_nrc_viz)) <span class="co">#transpose</span></span>
<span id="cb185-717"><a href="#cb185-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-718"><a href="#cb185-718" aria-hidden="true" tabindex="-1"></a>Diehl_tr_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(Diehl_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">497</span>]))</span>
<span id="cb185-719"><a href="#cb185-719" aria-hidden="true" tabindex="-1"></a>Diehl_tr_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowMeans</span>(Diehl_tr[<span class="dv">2</span><span class="sc">:</span><span class="dv">497</span>]))<span class="co">#get mean of sentiment values</span></span>
<span id="cb185-720"><a href="#cb185-720" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Diehl_tr_new)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Count"</span></span>
<span id="cb185-721"><a href="#cb185-721" aria-hidden="true" tabindex="-1"></a>Diehl_tr_new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Diehl_tr_new), Diehl_tr_new)</span>
<span id="cb185-722"><a href="#cb185-722" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Diehl_tr_new) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb185-723"><a href="#cb185-723" aria-hidden="true" tabindex="-1"></a>Diehl_tr_new2<span class="ot">&lt;-</span>Diehl_tr_new[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,]</span>
<span id="cb185-724"><a href="#cb185-724" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Diehl_tr_new2,<span class="st">"Diehl- 8 Sentiments"</span>)</span>
<span id="cb185-725"><a href="#cb185-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-728"><a href="#cb185-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-729"><a href="#cb185-729" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb185-730"><a href="#cb185-730" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Diehl_tr_new2, <span class="at">weight=</span>Count, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"count"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Emotions to REPLIES Geoff Diehl Tweets"</span>)</span>
<span id="cb185-731"><a href="#cb185-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-732"><a href="#cb185-732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-735"><a href="#cb185-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-736"><a href="#cb185-736" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Diehl_tr_mean)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Mean"</span></span>
<span id="cb185-737"><a href="#cb185-737" aria-hidden="true" tabindex="-1"></a>Diehl_tr_mean <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"sentiment"</span> <span class="ot">=</span> <span class="fu">rownames</span>(Diehl_tr_mean), Diehl_tr_mean)</span>
<span id="cb185-738"><a href="#cb185-738" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Diehl_tr_mean) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb185-739"><a href="#cb185-739" aria-hidden="true" tabindex="-1"></a>Diehl_tr_mean2<span class="ot">&lt;-</span>Diehl_tr_mean[<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb185-740"><a href="#cb185-740" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Diehl_tr_mean2,<span class="st">"Diehl -Mean Sentiments"</span>)</span>
<span id="cb185-741"><a href="#cb185-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-744"><a href="#cb185-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-745"><a href="#cb185-745" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot One - Count of words associated with each sentiment</span></span>
<span id="cb185-746"><a href="#cb185-746" aria-hidden="true" tabindex="-1"></a><span class="fu">quickplot</span>(sentiment, <span class="at">data=</span>Diehl_tr_mean2, <span class="at">weight=</span>Mean, <span class="at">geom=</span><span class="st">"bar"</span>, <span class="at">fill=</span>sentiment, <span class="at">ylab=</span><span class="st">"Mean Sentiment Score"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Mean Sentiment Scores to Geoff Diehl Tweets"</span>)</span>
<span id="cb185-747"><a href="#cb185-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-748"><a href="#cb185-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-749"><a href="#cb185-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-750"><a href="#cb185-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-751"><a href="#cb185-751" aria-hidden="true" tabindex="-1"></a><span class="fu">## Polarity Scores</span></span>
<span id="cb185-754"><a href="#cb185-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-755"><a href="#cb185-755" aria-hidden="true" tabindex="-1"></a>Diehldf_nrc <span class="ot">&lt;-</span> <span class="fu">convert</span>(DiehlDfm_nrc, <span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb185-756"><a href="#cb185-756" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(Diehldf_nrc, <span class="st">"Diehl- Polarity Scores"</span>)</span>
<span id="cb185-757"><a href="#cb185-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-758"><a href="#cb185-758" aria-hidden="true" tabindex="-1"></a>Diehldf_nrc<span class="sc">$</span>polarity <span class="ot">&lt;-</span> (Diehldf_nrc<span class="sc">$</span>positive <span class="sc">-</span> Diehldf_nrc<span class="sc">$</span>negative)<span class="sc">/</span>(Diehldf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Diehldf_nrc<span class="sc">$</span>negative)</span>
<span id="cb185-759"><a href="#cb185-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-760"><a href="#cb185-760" aria-hidden="true" tabindex="-1"></a>Diehldf_nrc<span class="sc">$</span>polarity[(Diehldf_nrc<span class="sc">$</span>positive <span class="sc">+</span> Diehldf_nrc<span class="sc">$</span>negative) <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb185-761"><a href="#cb185-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-762"><a href="#cb185-762" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Diehldf_nrc) <span class="sc">+</span></span>
<span id="cb185-763"><a href="#cb185-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>polarity)) <span class="sc">+</span></span>
<span id="cb185-764"><a href="#cb185-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb185-765"><a href="#cb185-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-766"><a href="#cb185-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-767"><a href="#cb185-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-768"><a href="#cb185-768" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bind to new DF</span></span>
<span id="cb185-771"><a href="#cb185-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-772"><a href="#cb185-772" aria-hidden="true" tabindex="-1"></a>Diehl_text_df <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(Diehl_text_df)</span>
<span id="cb185-773"><a href="#cb185-773" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>((<span class="fu">cbind</span>(Diehldf_nrc,Diehl_text_df)))</span>
<span id="cb185-774"><a href="#cb185-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-775"><a href="#cb185-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-776"><a href="#cb185-776" aria-hidden="true" tabindex="-1"></a><span class="fu">## subset to polarity and text</span></span>
<span id="cb185-779"><a href="#cb185-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-780"><a href="#cb185-780" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity <span class="ot">&lt;-</span> DiehlCorpus_Polarity <span class="sc">%&gt;%</span></span>
<span id="cb185-781"><a href="#cb185-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"polarity"</span>,<span class="st">"Diehl_corpus"</span>))</span>
<span id="cb185-782"><a href="#cb185-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-783"><a href="#cb185-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-784"><a href="#cb185-784" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity<span class="sc">$</span>polarity <span class="ot">&lt;-</span> <span class="fu">recode</span>(DiehlCorpus_Polarity<span class="sc">$</span>polarity,</span>
<span id="cb185-785"><a href="#cb185-785" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"positive"</span>,</span>
<span id="cb185-786"><a href="#cb185-786" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"-1"</span> <span class="ot">=</span> <span class="st">"negative"</span>,</span>
<span id="cb185-787"><a href="#cb185-787" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"0"</span> <span class="ot">=</span> <span class="st">"neutral"</span>,)</span>
<span id="cb185-788"><a href="#cb185-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-789"><a href="#cb185-789" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleaned DF</span></span>
<span id="cb185-792"><a href="#cb185-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-793"><a href="#cb185-793" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_Polarity <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(DiehlCorpus_Polarity)</span>
<span id="cb185-794"><a href="#cb185-794" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DiehlCorpus_Polarity)</span>
<span id="cb185-795"><a href="#cb185-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-796"><a href="#cb185-796" aria-hidden="true" tabindex="-1"></a><span class="fu">## New Corpus with polarity scores</span></span>
<span id="cb185-799"><a href="#cb185-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-800"><a href="#cb185-800" aria-hidden="true" tabindex="-1"></a>DiehlCorpus_P<span class="ot">&lt;-</span> <span class="fu">corpus</span>(DiehlCorpus_Polarity,<span class="at">text_field =</span> <span class="st">"Diehl_corpus"</span>)   </span>
<span id="cb185-801"><a href="#cb185-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-802"><a href="#cb185-802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-803"><a href="#cb185-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-804"><a href="#cb185-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-805"><a href="#cb185-805" aria-hidden="true" tabindex="-1"></a><span class="fu"># DIEHL-MACHINE LEARNING</span></span>
<span id="cb185-806"><a href="#cb185-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-809"><a href="#cb185-809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-810"><a href="#cb185-810" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb185-811"><a href="#cb185-811" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-812"><a href="#cb185-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-813"><a href="#cb185-813" aria-hidden="true" tabindex="-1"></a><span class="co"># create id variable in corpus metadata</span></span>
<span id="cb185-814"><a href="#cb185-814" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(DiehlCorpus_P, <span class="st">"id"</span>) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ndoc</span>(DiehlCorpus_P)</span>
<span id="cb185-815"><a href="#cb185-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-816"><a href="#cb185-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-817"><a href="#cb185-817" aria-hidden="true" tabindex="-1"></a><span class="co"># create training set (60% of data) and initial test set</span></span>
<span id="cb185-818"><a href="#cb185-818" aria-hidden="true" tabindex="-1"></a>DN <span class="ot">&lt;-</span> <span class="fu">ndoc</span>(DiehlCorpus_P)</span>
<span id="cb185-819"><a href="#cb185-819" aria-hidden="true" tabindex="-1"></a>DtrainIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>DN,.<span class="dv">6</span> <span class="sc">*</span> DN) </span>
<span id="cb185-820"><a href="#cb185-820" aria-hidden="true" tabindex="-1"></a>DtestIndex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>N)[<span class="sc">-</span>DtrainIndex]</span>
<span id="cb185-821"><a href="#cb185-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-822"><a href="#cb185-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-823"><a href="#cb185-823" aria-hidden="true" tabindex="-1"></a><span class="co"># split test set in half (so 20% of data are test, 20% of data are held-out)</span></span>
<span id="cb185-824"><a href="#cb185-824" aria-hidden="true" tabindex="-1"></a>DN <span class="ot">&lt;-</span> <span class="fu">length</span>(DtestIndex)</span>
<span id="cb185-825"><a href="#cb185-825" aria-hidden="true" tabindex="-1"></a>DheldOutIndex <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>DN, .<span class="dv">5</span> <span class="sc">*</span> DN)</span>
<span id="cb185-826"><a href="#cb185-826" aria-hidden="true" tabindex="-1"></a>DtestIndex <span class="ot">&lt;-</span> DtestIndex[<span class="sc">-</span>DheldOutIndex]</span>
<span id="cb185-827"><a href="#cb185-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-828"><a href="#cb185-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-829"><a href="#cb185-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-830"><a href="#cb185-830" aria-hidden="true" tabindex="-1"></a><span class="co"># now apply indices to create subsets and dfms</span></span>
<span id="cb185-831"><a href="#cb185-831" aria-hidden="true" tabindex="-1"></a>DdfmTrain <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtrainIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb185-832"><a href="#cb185-832" aria-hidden="true" tabindex="-1"></a>DdfmTest <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb185-833"><a href="#cb185-833" aria-hidden="true" tabindex="-1"></a>DdfmHeldOut <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DheldOutIndex) <span class="sc">%&gt;%</span> <span class="fu">tokens</span>() <span class="sc">%&gt;%</span> <span class="fu">dfm</span>()</span>
<span id="cb185-834"><a href="#cb185-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-835"><a href="#cb185-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-836"><a href="#cb185-836" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DtrainIndex)</span>
<span id="cb185-837"><a href="#cb185-837" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DtestIndex)</span>
<span id="cb185-838"><a href="#cb185-838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-839"><a href="#cb185-839" aria-hidden="true" tabindex="-1"></a><span class="fu">## NB model</span></span>
<span id="cb185-842"><a href="#cb185-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-843"><a href="#cb185-843" aria-hidden="true" tabindex="-1"></a>polarity_NaiveBayes <span class="ot">&lt;-</span> <span class="fu">textmodel_nb</span>(DdfmTrain, <span class="fu">docvars</span>(DdfmTrain, <span class="st">"polarity"</span>), <span class="at">distribution =</span> <span class="st">"Bernoulli"</span>) </span>
<span id="cb185-844"><a href="#cb185-844" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(polarity_NaiveBayes)</span>
<span id="cb185-845"><a href="#cb185-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-846"><a href="#cb185-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-847"><a href="#cb185-847" aria-hidden="true" tabindex="-1"></a>DdfmTestMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(DdfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(DdfmTrain))</span>
<span id="cb185-848"><a href="#cb185-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-849"><a href="#cb185-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-850"><a href="#cb185-850" aria-hidden="true" tabindex="-1"></a><span class="fu">### CONFUSION MATRIX</span></span>
<span id="cb185-851"><a href="#cb185-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-854"><a href="#cb185-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-855"><a href="#cb185-855" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb185-856"><a href="#cb185-856" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(DdfmTestMatched, <span class="st">"polarity"</span>)</span>
<span id="cb185-857"><a href="#cb185-857" aria-hidden="true" tabindex="-1"></a>Dpredicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> DdfmTestMatched)</span>
<span id="cb185-858"><a href="#cb185-858" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual, Dpredicted)</span>
<span id="cb185-859"><a href="#cb185-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-860"><a href="#cb185-860" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb185-861"><a href="#cb185-861" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span>
<span id="cb185-862"><a href="#cb185-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-865"><a href="#cb185-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-866"><a href="#cb185-866" aria-hidden="true" tabindex="-1"></a>Dpredicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, <span class="at">newdata =</span> DdfmTestMatched, <span class="at">type =</span> <span class="st">"probability"</span>)</span>
<span id="cb185-867"><a href="#cb185-867" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Dpredicted_prob)</span>
<span id="cb185-868"><a href="#cb185-868" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Dpredicted_prob)</span>
<span id="cb185-869"><a href="#cb185-869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-872"><a href="#cb185-872" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-873"><a href="#cb185-873" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb185-874"><a href="#cb185-874" aria-hidden="true" tabindex="-1"></a>mostPos <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(Dpredicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb185-875"><a href="#cb185-875" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex))[mostPos]</span>
<span id="cb185-876"><a href="#cb185-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-879"><a href="#cb185-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-880"><a href="#cb185-880" aria-hidden="true" tabindex="-1"></a>mostNeg <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(Dpredicted_prob[,<span class="dv">1</span>], <span class="at">dec=</span>T)[<span class="dv">1</span>]</span>
<span id="cb185-881"><a href="#cb185-881" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex))[mostNeg]</span>
<span id="cb185-882"><a href="#cb185-882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-885"><a href="#cb185-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-886"><a href="#cb185-886" aria-hidden="true" tabindex="-1"></a><span class="co"># The most positive review</span></span>
<span id="cb185-887"><a href="#cb185-887" aria-hidden="true" tabindex="-1"></a>Dmixed <span class="ot">&lt;-</span> <span class="fu">sort.list</span>(<span class="fu">abs</span>(Dpredicted_prob[,<span class="dv">1</span>] <span class="sc">-</span> .<span class="dv">5</span>), <span class="at">dec=</span>F)[<span class="dv">1</span>]</span>
<span id="cb185-888"><a href="#cb185-888" aria-hidden="true" tabindex="-1"></a>Dpredicted_prob[Dmixed,]</span>
<span id="cb185-889"><a href="#cb185-889" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(<span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DtestIndex))[Dmixed]</span>
<span id="cb185-890"><a href="#cb185-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-891"><a href="#cb185-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-892"><a href="#cb185-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-893"><a href="#cb185-893" aria-hidden="true" tabindex="-1"></a><span class="fu">## SVM</span></span>
<span id="cb185-894"><a href="#cb185-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-897"><a href="#cb185-897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-898"><a href="#cb185-898" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb185-899"><a href="#cb185-899" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-900"><a href="#cb185-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-901"><a href="#cb185-901" aria-hidden="true" tabindex="-1"></a><span class="co"># sample smaller set of training data</span></span>
<span id="cb185-902"><a href="#cb185-902" aria-hidden="true" tabindex="-1"></a>DnewTrainIndex <span class="ot">&lt;-</span> DtrainIndex[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(DtrainIndex))]</span>
<span id="cb185-903"><a href="#cb185-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-904"><a href="#cb185-904" aria-hidden="true" tabindex="-1"></a><span class="co"># create small DFM</span></span>
<span id="cb185-905"><a href="#cb185-905" aria-hidden="true" tabindex="-1"></a>DdfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">corpus_subset</span>(DiehlCorpus_P, id <span class="sc">%in%</span> DnewTrainIndex) <span class="sc">%&gt;%</span> <span class="fu">dfm</span>(<span class="at">remove =</span> <span class="fu">stopwords</span>(<span class="st">"English"</span>), <span class="at">remove_punct=</span>T)</span>
<span id="cb185-906"><a href="#cb185-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-907"><a href="#cb185-907" aria-hidden="true" tabindex="-1"></a><span class="co"># trim the DFM down to frequent terms</span></span>
<span id="cb185-908"><a href="#cb185-908" aria-hidden="true" tabindex="-1"></a>DdfmTrainSmall <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(DdfmTrainSmall, <span class="at">min_docfreq =</span> <span class="dv">2</span>, <span class="at">min_termfreq =</span> <span class="dv">2</span>)</span>
<span id="cb185-909"><a href="#cb185-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-910"><a href="#cb185-910" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(DdfmTrainSmall)</span>
<span id="cb185-911"><a href="#cb185-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-912"><a href="#cb185-912" aria-hidden="true" tabindex="-1"></a><span class="fu">### run model</span></span>
<span id="cb185-915"><a href="#cb185-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-916"><a href="#cb185-916" aria-hidden="true" tabindex="-1"></a>Dpolarity_SVM <span class="ot">&lt;-</span> <span class="fu">textmodel_svm</span>(DdfmTrainSmall, <span class="fu">docvars</span>(DdfmTrainSmall, <span class="st">"polarity"</span>)) </span>
<span id="cb185-917"><a href="#cb185-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-918"><a href="#cb185-918" aria-hidden="true" tabindex="-1"></a><span class="co"># update test set</span></span>
<span id="cb185-919"><a href="#cb185-919" aria-hidden="true" tabindex="-1"></a>DdfmTestMatchedSmall <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(DdfmTest, <span class="at">features =</span> <span class="fu">featnames</span>(DdfmTrainSmall))</span>
<span id="cb185-920"><a href="#cb185-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-923"><a href="#cb185-923" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-924"><a href="#cb185-924" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix </span></span>
<span id="cb185-925"><a href="#cb185-925" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(DdfmTestMatchedSmall, <span class="st">"polarity"</span>)</span>
<span id="cb185-926"><a href="#cb185-926" aria-hidden="true" tabindex="-1"></a>Dpredicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(Dpolarity_SVM, <span class="at">newdata =</span> DdfmTestMatchedSmall)</span>
<span id="cb185-927"><a href="#cb185-927" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual, Dpredicted)</span>
<span id="cb185-928"><a href="#cb185-928" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate a number of statistics related to the confusion matrix</span></span>
<span id="cb185-929"><a href="#cb185-929" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span>
<span id="cb185-930"><a href="#cb185-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-933"><a href="#cb185-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-934"><a href="#cb185-934" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM coeff</span></span>
<span id="cb185-935"><a href="#cb185-935" aria-hidden="true" tabindex="-1"></a>DsvmCoefs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">coefficients</span>(Dpolarity_SVM)))</span>
<span id="cb185-936"><a href="#cb185-936" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DsvmCoefs,<span class="dv">10</span>)</span>
<span id="cb185-937"><a href="#cb185-937" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(DsvmCoefs,<span class="dv">10</span>)</span>
<span id="cb185-938"><a href="#cb185-938" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-939"><a href="#cb185-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-940"><a href="#cb185-940" aria-hidden="true" tabindex="-1"></a><span class="fu">## RANDOM FOREST</span></span>
<span id="cb185-943"><a href="#cb185-943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-944"><a href="#cb185-944" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb185-945"><a href="#cb185-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-946"><a href="#cb185-946" aria-hidden="true" tabindex="-1"></a>DdfmTrainSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(DdfmTrainSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb185-947"><a href="#cb185-947" aria-hidden="true" tabindex="-1"></a>DdfmTestMatchedSmallRf <span class="ot">&lt;-</span> <span class="fu">convert</span>(DdfmTestMatchedSmall, <span class="at">to =</span> <span class="st">"matrix"</span>)</span>
<span id="cb185-948"><a href="#cb185-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-949"><a href="#cb185-949" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb185-950"><a href="#cb185-950" aria-hidden="true" tabindex="-1"></a>Diehl_polarity_RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(DdfmTrainSmallRf, </span>
<span id="cb185-951"><a href="#cb185-951" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(DdfmTrainSmall)<span class="sc">$</span>polarity),</span>
<span id="cb185-952"><a href="#cb185-952" aria-hidden="true" tabindex="-1"></a>                            <span class="at">xtest =</span> DdfmTestMatchedSmallRf, </span>
<span id="cb185-953"><a href="#cb185-953" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ytest =</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(DdfmTestMatchedSmall)<span class="sc">$</span>polarity),</span>
<span id="cb185-954"><a href="#cb185-954" aria-hidden="true" tabindex="-1"></a>                            <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb185-955"><a href="#cb185-955" aria-hidden="true" tabindex="-1"></a>                            <span class="at">mtry =</span> <span class="dv">20</span>,</span>
<span id="cb185-956"><a href="#cb185-956" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ntree =</span> <span class="dv">100</span></span>
<span id="cb185-957"><a href="#cb185-957" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb185-958"><a href="#cb185-958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-961"><a href="#cb185-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-962"><a href="#cb185-962" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">docvars</span>(DdfmTestMatchedSmall)<span class="sc">$</span>polarity)</span>
<span id="cb185-963"><a href="#cb185-963" aria-hidden="true" tabindex="-1"></a>Dpredicted <span class="ot">&lt;-</span> Diehl_polarity_RF<span class="sc">$</span>test[[<span class="st">'predicted'</span>]]</span>
<span id="cb185-964"><a href="#cb185-964" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual,Dpredicted)</span>
<span id="cb185-965"><a href="#cb185-965" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode=</span><span class="st">"everything"</span>)</span>
<span id="cb185-966"><a href="#cb185-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-969"><a href="#cb185-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-970"><a href="#cb185-970" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(Diehl_polarity_RF)</span>
<span id="cb185-971"><a href="#cb185-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-972"><a href="#cb185-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-973"><a href="#cb185-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-974"><a href="#cb185-974" aria-hidden="true" tabindex="-1"></a><span class="fu">## Naive Bayes -Held out</span></span>
<span id="cb185-975"><a href="#cb185-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-976"><a href="#cb185-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-977"><a href="#cb185-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-980"><a href="#cb185-980" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-981"><a href="#cb185-981" aria-hidden="true" tabindex="-1"></a>Dactual <span class="ot">&lt;-</span> <span class="fu">docvars</span>(DdfmHeldOut)<span class="sc">$</span>polarity</span>
<span id="cb185-982"><a href="#cb185-982" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(Dactual)</span>
<span id="cb185-983"><a href="#cb185-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb185-986"><a href="#cb185-986" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb185-987"><a href="#cb185-987" aria-hidden="true" tabindex="-1"></a>DdfmHeldOutMatched <span class="ot">&lt;-</span> <span class="fu">dfm_match</span>(DdfmHeldOut, <span class="at">features =</span> <span class="fu">featnames</span>(DdfmTrain))</span>
<span id="cb185-988"><a href="#cb185-988" aria-hidden="true" tabindex="-1"></a>Dpredicted.nb <span class="ot">&lt;-</span> <span class="fu">predict</span>(polarity_NaiveBayes, DdfmHeldOutMatched, <span class="at">force =</span>  <span class="cn">TRUE</span> )</span>
<span id="cb185-989"><a href="#cb185-989" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(Dpredicted.nb)</span>
<span id="cb185-990"><a href="#cb185-990" aria-hidden="true" tabindex="-1"></a>Dconfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(Dactual, Dpredicted.nb)</span>
<span id="cb185-991"><a href="#cb185-991" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(Dconfusion, <span class="at">mode =</span> <span class="st">"everything"</span>)</span>
<span id="cb185-992"><a href="#cb185-992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>