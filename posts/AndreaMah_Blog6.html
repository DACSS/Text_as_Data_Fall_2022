<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrea Mah">
<meta name="dcterms.date" content="2022-12-02">

<title>Text-as-Data Fall 2022 - Blog Post 6: Structural Topic Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta name="twitter:title" content="Text-as-Data Fall 2022 - Blog Post 6: Structural Topic Modeling">
<meta name="twitter:description" content="Based on suggestions from Prof Song,I used strucutural topic modelling on my data. Structural topic models should allow me to test the association between topics and document metadata.">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <img src="../images/UMass White Wordmark Horiz.png" alt="">
    <span class="navbar-title">Text-as-Data Fall 2022</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/Text_as_Data_Fall_2022/">Fall 2022</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">Contributors</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">DACSS</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/Text_as_Data_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Blog Post 6: Structural Topic Modeling</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">BlogPost6</div>
    <div class="quarto-category">Andrea Mah</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrea Mah </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 2, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>Based on suggestions from Prof Song,I used strucutural topic modelling on my data. Structural topic models should allow me to test the association between topics and document metadata. In my case, I have three metadata variables to look at: year of speech, Climate Risk Index (CRI) and income level of a given country. To do this, I planned to use the stm package, using the Roberts et al.&nbsp;paper as a guide.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#strucutral topic modeling</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#loading in nececssary libraries</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Package version: 3.2.3
Unicode version: 13.0
ICU version: 69.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Parallel computing: 8 of 8 threads used.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>See https://quanteda.io for tutorials and examples.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(text2vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'text2vec' was built under R version 4.2.2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stopwords)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RCurl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'RCurl'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    complete</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages('stm')</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stm' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>stm v1.3.6 successfully loaded. See ?stm for help. 
 Papers, resources, and other materials at structuraltopicmodel.com</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in data/ </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>speech.meta <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'FINAL_combined_meta-text_dataset.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file(file, "rt"): cannot open file 'FINAL_combined_meta-
text_dataset.csv': No such file or directory</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in file(file, "rt"): cannot open the connection</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>speech.meta<span class="sc">$</span>income <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(speech.meta<span class="sc">$</span>income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in is.factor(x): object 'speech.meta' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(speech.meta<span class="sc">$</span>income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in levels(speech.meta$income): object 'speech.meta' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>speech.meta<span class="sc">$</span>incNum <span class="ot">&lt;-</span> <span class="fu">recode</span>(speech.meta<span class="sc">$</span>income, <span class="st">"High income"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"Upper middle income"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Lower middle income"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Low income"</span> <span class="ot">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in recode(speech.meta$income, `High income` = 4, `Upper middle income` = 3, : object 'speech.meta' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>speech.meta<span class="sc">$</span>incNum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'speech.meta' not found</code></pre>
</div>
</div>
<p>After loading in the data, and creating a numeric income metadata variable (although it isn’t a true continuous scale, it helps with interpretation to use this kind of ordinal recoding to understand, roughly, the relationships between income levevl and topics…) I started processing the data for use with stm package.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#process the data for use with stm package</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>processed <span class="ot">&lt;-</span> <span class="fu">textProcessor</span>(speech.meta<span class="sc">$</span>text_field, <span class="at">metadata =</span> speech.meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in textProcessor(speech.meta$text_field, metadata = speech.meta): object 'speech.meta' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">prepDocuments</span>(processed<span class="sc">$</span>documents, processed<span class="sc">$</span>vocab, processed<span class="sc">$</span>meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in prepDocuments(processed$documents, processed$vocab, processed$meta): object 'processed' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> out<span class="sc">$</span>documents</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> out<span class="sc">$</span>vocab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> out<span class="sc">$</span>meta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'out' not found</code></pre>
</div>
</div>
<p>After doing this initial processing, I realized I needed to limit my corpus to documents which had my covariates… thus:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#process the data for use with stm package, limiting to only speeches</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#from countries with an associated CRI</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>speech.meta <span class="ot">&lt;-</span> <span class="fu">subset</span>(speech.meta, <span class="sc">!</span>(<span class="fu">is.na</span>(CRI)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in subset(speech.meta, !(is.na(CRI))): object 'speech.meta' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>speech.meta.cri <span class="ot">&lt;-</span> <span class="fu">subset</span>(speech.meta, <span class="sc">!</span>(<span class="fu">is.na</span>(incNum)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in subset(speech.meta, !(is.na(incNum))): object 'speech.meta' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(speech.meta.cri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in tail(speech.meta.cri): object 'speech.meta.cri' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>processed <span class="ot">&lt;-</span> <span class="fu">textProcessor</span>(speech.meta.cri<span class="sc">$</span>text_field, <span class="at">metadata =</span> speech.meta.cri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in textProcessor(speech.meta.cri$text_field, metadata = speech.meta.cri): object 'speech.meta.cri' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">prepDocuments</span>(processed<span class="sc">$</span>documents, processed<span class="sc">$</span>vocab, processed<span class="sc">$</span>meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in prepDocuments(processed$documents, processed$vocab, processed$meta): object 'processed' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> out<span class="sc">$</span>documents</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> out<span class="sc">$</span>vocab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> out<span class="sc">$</span>meta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'out' not found</code></pre>
</div>
</div>
<p>Next, I tried running strucutral topic models using a variety of the methods presented in the Roberts paper:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>stm.cri <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">K =</span> <span class="dv">20</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span>income <span class="sc">+</span> year, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in asSTMCorpus(documents, vocab, data): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>stm.cri.Select <span class="ot">&lt;-</span> <span class="fu">selectModel</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">K =</span> <span class="dv">20</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> income, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">runs =</span> <span class="dv">20</span>, <span class="at">seed =</span> <span class="dv">11112</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Casting net 
1 models in net </code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in asSTMCorpus(documents, vocab, data): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the models</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotModels</span>(stm.cri.Select, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plotModels(stm.cri.Select, pch = c(1, 2, 3, 4, 5, 6, 7, 8, 9)): object 'stm.cri.Select' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>selected.cri <span class="ot">&lt;-</span> stm.cri.Select<span class="sc">$</span>runout[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'stm.cri.Select' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(selected.cri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in summary(selected.cri): object 'selected.cri' not found</code></pre>
</div>
</div>
<p>I used the searchK function to compare models with different numbers of topics. Based on my previous exploration and use of LDA, I thought that k between 3 and 10 would likely be sufficient…</p>
<pre class="{r{}}"><code>#SearchK function to determine  potential number of topics
#I wanted to test between 3 and 10 topics. I think 20 (which I looked at
#in the select function) was too many topics.
storage &lt;- searchK(out$documents, out$vocab, K = c(3:10), 
                   prevalence =~ CRI + year + income, data = meta)

#now I want to examine the results of the search K... 
plot.searchK(storage)

results &lt;- as.data.frame(storage$results)

View(results)</code></pre>
<p>After running this, I was= looking for the following criteria: #higher semantic coherene #high held-out likelihood #low residual #low lower bound</p>
<p>iven the plots, I think that maybe a model with three, four or five topics could be best? ok, so given that I am thinking that three or four or five topics seems to fit criteria</p>
<p>I then ran models with each number of topics.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>stm.cri3 <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">K =</span> <span class="dv">3</span>, <span class="at">prevalence =</span><span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> income, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in asSTMCorpus(documents, vocab, data): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>stm.cri4 <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">K =</span> <span class="dv">4</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> incNum, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in asSTMCorpus(documents, vocab, data): object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>stm.cri5 <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">K =</span> <span class="dv">5</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> income, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in asSTMCorpus(documents, vocab, data): object 'out' not found</code></pre>
</div>
</div>
<p>Then, I wanted to think about labeling these… After looking at three, four, and five-topic models, I decided to proceed with the four-topic model.</p>
<p>Labels based on FREX were a bit strange…Mostly country names. #1: nepal_namibia_malawi_zambia_vietnam #2: bonn_group_complianc_bueno_china #3: tuvalu_copenhagen_island_australia_barbado #4: comment_geneva_consumpt_albania_effici</p>
<p>perhaps labels with probability are better: #1: climat, chang, develop, countri, adapt #2: parti, convent, develop, countri, protocol #3: climate, will, chang, countri, must, develop #4: energi, develop, countri, emiss, climat</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in labelTopics(stm.cri3): object 'stm.cri3' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sageLabels</span>(stm.cri3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in sageLabels(stm.cri3): object 'stm.cri3' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in labelTopics(stm.cri4): object 'stm.cri4' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in labelTopics(stm.cri5): object 'stm.cri5' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 1 Top Words:</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: climat, chang, develop, countri, presid, adapt, nation </span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: napa, namibia, malawi, nepal, zambia, vietnam, african </span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 2 Top Words:</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: parti, develop, convent, protocol, countri, kyoto, presid </span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: bonn, group, bueno, china, complianc, protocol, kyoto </span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 3 Top Words:</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: develop, climat, chang, countri, technolog, will, emiss </span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: vision, poznan, market, australia, partnership, key, invest </span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 4 Top Words:</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: countri, emiss, energi, develop, climat, convent, chang </span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: latvia, turkey, geneva, comment, agbm, lithuania, berlin </span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 5 Top Words:</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  Highest Prob: will, climat, world, countri, chang, must, island </span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: tuvalu, barbado, solomon, island, fiji, reef, children </span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sageLabels</span>(stm.cri4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in sageLabels(stm.cri4): object 'stm.cri4' not found</code></pre>
</div>
</div>
<p>Next I plotted more graphs looking at topic proportion:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#getting the graphical display of estimated topic proportions</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"summary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(stm.cri4, type = "summary"): object 'stm.cri4' not found</code></pre>
</div>
</div>
<p>Proceeding with 4 topics, I wanted to look at my covariates in relation to topics. As a reminder, these covariates were income classification of the country, climate risk index, and year of speech.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>prep <span class="ot">&lt;-</span> <span class="fu">estimateEffect</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> incNum, stm.cri4,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">meta =</span> out<span class="sc">$</span>meta, <span class="at">uncertainty =</span> <span class="st">"Global"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in estimateEffect(1:4 ~ CRI + year + incNum, stm.cri4, meta = out$meta, : object 'out' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#looking at the relationship between covariates and these four topics;</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(prep, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in summary(prep, topics = c(1, 2, 3, 4)): object 'prep' not found</code></pre>
</div>
</div>
<p>Interestingly, CRI did not seem to be a predictor of any topic. year and income were. I looked at a plot of income plotted against topic prevalence: #1 = low income, 2 = lower middle income, 3 = upper middle income, 4 = high income</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prep, <span class="at">covariate =</span> <span class="st">"incNum"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">model =</span> stm.cri4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(prep, covariate = "incNum", topics = c(1:4), model = stm.cri4): object 'prep' not found</code></pre>
</div>
</div>
<p>Not completely sure I set this up right, but here I looked at expected topic proportion over time (by year) Strangely, topic 2 decreased over time, while 4 increased. Topic 1 remained relatively stable, Topic 2 slightly increased</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prep, <span class="st">"year"</span>, <span class="at">method =</span> <span class="st">"continuous"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(prep, "year", method = "continuous", topics = c(1:4)): object 'prep' not found</code></pre>
</div>
</div>
<p>To remind myself of topic 2, I looked at the top words…</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 2:</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in labelTopics(stm.cri4): object 'stm.cri4' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 2 Top Words:</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Highest Prob: countri, develop, emiss, convent, climat, chang, energi </span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: kazakhstan, romania, croatia, latvia, berlin, japan, geneva </span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Lift: absorpt, achi, acti, additon, adriat, aerosol, afterward </span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Score: romania, berlin, latvia, croatia, energi, implement, aij </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To compare this topic to others, I used topical contrasts between topic 2 and other topics</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"perspectives"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(stm.cri4, type = "perspectives", topics = c(1, 2), xlim = c(0.1, : object 'stm.cri4' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"perspectives"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(stm.cri4, type = "perspectives", topics = c(2, 3), xlim = c(0.1, : object 'stm.cri4' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"perspectives"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(stm.cri4, type = "perspectives", topics = c(2, 4), xlim = c(0.1, : object 'stm.cri4' not found</code></pre>
</div>
</div>
<p>Finally, I looked at word clouds for each topic. I was hoping I could use the package grid or gridExtra to combine these four into one graphic, but I guess they were not the right kind of object.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>top1 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in cloud(stm.cri4, topic = 1, scale = c(3, 0.3)): object 'stm.cri4' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>top2 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in cloud(stm.cri4, topic = 2, scale = c(3, 0.3)): object 'stm.cri4' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>top3 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">3</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in cloud(stm.cri4, topic = 3, scale = c(3, 0.3)): object 'stm.cri4' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>top4 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">4</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in cloud(stm.cri4, topic = 4, scale = c(3, 0.3)): object 'stm.cri4' not found</code></pre>
</div>
</div>
<p>I think this was a very interesting exercise, but I am definitely lacking confidence in interpretation of various outputs from structural topic modeling. I want to spend more time working with the package in the future. From these explorations, I don’t know that I have a good understanding of waht characterizes each of the four extracted topics. I think I would need to spend more time closely examining each one to identify what the latent ideas are for each topic.</p>


<!-- -->


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/Text_as_Data_Fall_2022" data-repo-id="R_kgDOH5675w" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb111" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Blog Post 6: Structural Topic Modeling"</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Andrea Mah"</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "Topic modeling of speeches"</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "12/02/2022"</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - BlogPost6</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Andrea Mah</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>Based on suggestions from Prof Song,I used strucutural topic modelling on my data. Structural topic models should allow me to test the association between topics and document metadata. In my case, I have three metadata variables to look at: year of speech, Climate Risk Index (CRI) and income level of a given country. To do this, I planned to use the stm package, using the Roberts et al. paper as a guide.</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a><span class="co">#strucutral topic modeling</span></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a><span class="co">#loading in nececssary libraries</span></span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(text2vec)</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stopwords)</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RCurl)</span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages('stm')</span></span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stm)</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a><span class="co">#load in data/ </span></span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a>speech.meta <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'FINAL_combined_meta-text_dataset.csv'</span>)</span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a>speech.meta<span class="sc">$</span>income <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(speech.meta<span class="sc">$</span>income)</span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(speech.meta<span class="sc">$</span>income)</span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a>speech.meta<span class="sc">$</span>incNum <span class="ot">&lt;-</span> <span class="fu">recode</span>(speech.meta<span class="sc">$</span>income, <span class="st">"High income"</span> <span class="ot">=</span> <span class="dv">4</span>, <span class="st">"Upper middle income"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Lower middle income"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Low income"</span> <span class="ot">=</span> <span class="dv">1</span>)</span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a>speech.meta<span class="sc">$</span>incNum</span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a>After loading in the data, and creating a numeric income metadata variable </span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true" tabindex="-1"></a>(although it isn't a true continuous scale, it helps with interpretation to use </span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true" tabindex="-1"></a>this kind of ordinal recoding to understand, roughly, the relationships between</span>
<span id="cb111-50"><a href="#cb111-50" aria-hidden="true" tabindex="-1"></a>income levevl and topics...) I started processing the data for use with stm package.</span>
<span id="cb111-51"><a href="#cb111-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-54"><a href="#cb111-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-55"><a href="#cb111-55" aria-hidden="true" tabindex="-1"></a><span class="co">#process the data for use with stm package</span></span>
<span id="cb111-56"><a href="#cb111-56" aria-hidden="true" tabindex="-1"></a>processed <span class="ot">&lt;-</span> <span class="fu">textProcessor</span>(speech.meta<span class="sc">$</span>text_field, <span class="at">metadata =</span> speech.meta)</span>
<span id="cb111-57"><a href="#cb111-57" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">prepDocuments</span>(processed<span class="sc">$</span>documents, processed<span class="sc">$</span>vocab, processed<span class="sc">$</span>meta)</span>
<span id="cb111-58"><a href="#cb111-58" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> out<span class="sc">$</span>documents</span>
<span id="cb111-59"><a href="#cb111-59" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> out<span class="sc">$</span>vocab</span>
<span id="cb111-60"><a href="#cb111-60" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> out<span class="sc">$</span>meta</span>
<span id="cb111-61"><a href="#cb111-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-62"><a href="#cb111-62" aria-hidden="true" tabindex="-1"></a>After doing this initial processing, I realized I needed to limit my corpus to </span>
<span id="cb111-63"><a href="#cb111-63" aria-hidden="true" tabindex="-1"></a>documents which had my covariates... thus:</span>
<span id="cb111-66"><a href="#cb111-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-67"><a href="#cb111-67" aria-hidden="true" tabindex="-1"></a><span class="co">#process the data for use with stm package, limiting to only speeches</span></span>
<span id="cb111-68"><a href="#cb111-68" aria-hidden="true" tabindex="-1"></a><span class="co">#from countries with an associated CRI</span></span>
<span id="cb111-69"><a href="#cb111-69" aria-hidden="true" tabindex="-1"></a>speech.meta <span class="ot">&lt;-</span> <span class="fu">subset</span>(speech.meta, <span class="sc">!</span>(<span class="fu">is.na</span>(CRI)))</span>
<span id="cb111-70"><a href="#cb111-70" aria-hidden="true" tabindex="-1"></a>speech.meta.cri <span class="ot">&lt;-</span> <span class="fu">subset</span>(speech.meta, <span class="sc">!</span>(<span class="fu">is.na</span>(incNum)))</span>
<span id="cb111-71"><a href="#cb111-71" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(speech.meta.cri)</span>
<span id="cb111-72"><a href="#cb111-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-73"><a href="#cb111-73" aria-hidden="true" tabindex="-1"></a>processed <span class="ot">&lt;-</span> <span class="fu">textProcessor</span>(speech.meta.cri<span class="sc">$</span>text_field, <span class="at">metadata =</span> speech.meta.cri)</span>
<span id="cb111-74"><a href="#cb111-74" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">prepDocuments</span>(processed<span class="sc">$</span>documents, processed<span class="sc">$</span>vocab, processed<span class="sc">$</span>meta)</span>
<span id="cb111-75"><a href="#cb111-75" aria-hidden="true" tabindex="-1"></a>docs <span class="ot">&lt;-</span> out<span class="sc">$</span>documents</span>
<span id="cb111-76"><a href="#cb111-76" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">&lt;-</span> out<span class="sc">$</span>vocab</span>
<span id="cb111-77"><a href="#cb111-77" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> out<span class="sc">$</span>meta</span>
<span id="cb111-78"><a href="#cb111-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-79"><a href="#cb111-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-80"><a href="#cb111-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-81"><a href="#cb111-81" aria-hidden="true" tabindex="-1"></a>Next, I tried running strucutral topic models using a variety of the methods </span>
<span id="cb111-82"><a href="#cb111-82" aria-hidden="true" tabindex="-1"></a>presented in the Roberts paper:</span>
<span id="cb111-83"><a href="#cb111-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-86"><a href="#cb111-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-87"><a href="#cb111-87" aria-hidden="true" tabindex="-1"></a>stm.cri <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb111-88"><a href="#cb111-88" aria-hidden="true" tabindex="-1"></a>               <span class="at">K =</span> <span class="dv">20</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span>income <span class="sc">+</span> year, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb111-89"><a href="#cb111-89" aria-hidden="true" tabindex="-1"></a>               <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span>
<span id="cb111-90"><a href="#cb111-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-91"><a href="#cb111-91" aria-hidden="true" tabindex="-1"></a>stm.cri.Select <span class="ot">&lt;-</span> <span class="fu">selectModel</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb111-92"><a href="#cb111-92" aria-hidden="true" tabindex="-1"></a>               <span class="at">K =</span> <span class="dv">20</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> income, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb111-93"><a href="#cb111-93" aria-hidden="true" tabindex="-1"></a>               <span class="at">runs =</span> <span class="dv">20</span>, <span class="at">seed =</span> <span class="dv">11112</span>)</span>
<span id="cb111-94"><a href="#cb111-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-95"><a href="#cb111-95" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the models</span></span>
<span id="cb111-96"><a href="#cb111-96" aria-hidden="true" tabindex="-1"></a><span class="fu">plotModels</span>(stm.cri.Select, <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>))</span>
<span id="cb111-97"><a href="#cb111-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-98"><a href="#cb111-98" aria-hidden="true" tabindex="-1"></a>selected.cri <span class="ot">&lt;-</span> stm.cri.Select<span class="sc">$</span>runout[[<span class="dv">1</span>]]</span>
<span id="cb111-99"><a href="#cb111-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-100"><a href="#cb111-100" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(selected.cri)</span>
<span id="cb111-101"><a href="#cb111-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-102"><a href="#cb111-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-103"><a href="#cb111-103" aria-hidden="true" tabindex="-1"></a>I used the searchK function to compare models with different numbers of topics. Based</span>
<span id="cb111-104"><a href="#cb111-104" aria-hidden="true" tabindex="-1"></a>on my previous exploration and use of LDA, I thought that k between 3 and 10 would likely</span>
<span id="cb111-105"><a href="#cb111-105" aria-hidden="true" tabindex="-1"></a>be sufficient... </span>
<span id="cb111-106"><a href="#cb111-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-107"><a href="#cb111-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r{}}</span></span>
<span id="cb111-108"><a href="#cb111-108" aria-hidden="true" tabindex="-1"></a><span class="co">#SearchK function to determine  potential number of topics</span></span>
<span id="cb111-109"><a href="#cb111-109" aria-hidden="true" tabindex="-1"></a><span class="co">#I wanted to test between 3 and 10 topics. I think 20 (which I looked at</span></span>
<span id="cb111-110"><a href="#cb111-110" aria-hidden="true" tabindex="-1"></a><span class="co">#in the select function) was too many topics.</span></span>
<span id="cb111-111"><a href="#cb111-111" aria-hidden="true" tabindex="-1"></a>storage <span class="ot">&lt;-</span> <span class="fu">searchK</span>(out<span class="sc">$</span>documents, out<span class="sc">$</span>vocab, <span class="at">K =</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>), </span>
<span id="cb111-112"><a href="#cb111-112" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prevalence =</span><span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> income, <span class="at">data =</span> meta)</span>
<span id="cb111-113"><a href="#cb111-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-114"><a href="#cb111-114" aria-hidden="true" tabindex="-1"></a><span class="co">#now I want to examine the results of the search K... </span></span>
<span id="cb111-115"><a href="#cb111-115" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.searchK</span>(storage)</span>
<span id="cb111-116"><a href="#cb111-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-117"><a href="#cb111-117" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(storage<span class="sc">$</span>results)</span>
<span id="cb111-118"><a href="#cb111-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-119"><a href="#cb111-119" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(results)</span>
<span id="cb111-120"><a href="#cb111-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-121"><a href="#cb111-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-122"><a href="#cb111-122" aria-hidden="true" tabindex="-1"></a>After running this, I was= looking for the following criteria:</span>
<span id="cb111-123"><a href="#cb111-123" aria-hidden="true" tabindex="-1"></a>#higher semantic coherene</span>
<span id="cb111-124"><a href="#cb111-124" aria-hidden="true" tabindex="-1"></a>#high held-out likelihood</span>
<span id="cb111-125"><a href="#cb111-125" aria-hidden="true" tabindex="-1"></a>#low residual</span>
<span id="cb111-126"><a href="#cb111-126" aria-hidden="true" tabindex="-1"></a>#low lower bound</span>
<span id="cb111-127"><a href="#cb111-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-128"><a href="#cb111-128" aria-hidden="true" tabindex="-1"></a>iven the plots, I think that maybe a model with three, four or five topics could be best?</span>
<span id="cb111-129"><a href="#cb111-129" aria-hidden="true" tabindex="-1"></a>ok, so given that I am thinking that three or four or five topics seems to fit criteria</span>
<span id="cb111-130"><a href="#cb111-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-131"><a href="#cb111-131" aria-hidden="true" tabindex="-1"></a>I then ran models with each number of topics. </span>
<span id="cb111-132"><a href="#cb111-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-135"><a href="#cb111-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-136"><a href="#cb111-136" aria-hidden="true" tabindex="-1"></a>stm.cri3 <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb111-137"><a href="#cb111-137" aria-hidden="true" tabindex="-1"></a>                <span class="at">K =</span> <span class="dv">3</span>, <span class="at">prevalence =</span><span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> income, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb111-138"><a href="#cb111-138" aria-hidden="true" tabindex="-1"></a>                <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span>
<span id="cb111-139"><a href="#cb111-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-140"><a href="#cb111-140" aria-hidden="true" tabindex="-1"></a>stm.cri4 <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb111-141"><a href="#cb111-141" aria-hidden="true" tabindex="-1"></a>                <span class="at">K =</span> <span class="dv">4</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> incNum, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb111-142"><a href="#cb111-142" aria-hidden="true" tabindex="-1"></a>                <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span>
<span id="cb111-143"><a href="#cb111-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-144"><a href="#cb111-144" aria-hidden="true" tabindex="-1"></a>stm.cri5 <span class="ot">&lt;-</span> <span class="fu">stm</span>(<span class="at">documents =</span> out<span class="sc">$</span>documents, <span class="at">vocab =</span> out<span class="sc">$</span>vocab,</span>
<span id="cb111-145"><a href="#cb111-145" aria-hidden="true" tabindex="-1"></a>                <span class="at">K =</span> <span class="dv">5</span>, <span class="at">prevalence =</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> income, <span class="at">data =</span> out<span class="sc">$</span>meta,</span>
<span id="cb111-146"><a href="#cb111-146" aria-hidden="true" tabindex="-1"></a>                <span class="at">init.type =</span> <span class="st">"Spectral"</span>)</span>
<span id="cb111-147"><a href="#cb111-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-148"><a href="#cb111-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-149"><a href="#cb111-149" aria-hidden="true" tabindex="-1"></a>Then, I wanted to think about labeling these... After looking at three, four, and</span>
<span id="cb111-150"><a href="#cb111-150" aria-hidden="true" tabindex="-1"></a>five-topic models, I decided to proceed with the four-topic model.</span>
<span id="cb111-151"><a href="#cb111-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-152"><a href="#cb111-152" aria-hidden="true" tabindex="-1"></a>Labels based on FREX were a bit strange...Mostly country names. </span>
<span id="cb111-153"><a href="#cb111-153" aria-hidden="true" tabindex="-1"></a>#1: nepal_namibia_malawi_zambia_vietnam</span>
<span id="cb111-154"><a href="#cb111-154" aria-hidden="true" tabindex="-1"></a>#2: bonn_group_complianc_bueno_china</span>
<span id="cb111-155"><a href="#cb111-155" aria-hidden="true" tabindex="-1"></a>#3: tuvalu_copenhagen_island_australia_barbado</span>
<span id="cb111-156"><a href="#cb111-156" aria-hidden="true" tabindex="-1"></a>#4: comment_geneva_consumpt_albania_effici</span>
<span id="cb111-157"><a href="#cb111-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-158"><a href="#cb111-158" aria-hidden="true" tabindex="-1"></a>perhaps labels with probability are better: </span>
<span id="cb111-159"><a href="#cb111-159" aria-hidden="true" tabindex="-1"></a>#1: climat, chang, develop, countri, adapt</span>
<span id="cb111-160"><a href="#cb111-160" aria-hidden="true" tabindex="-1"></a>#2: parti, convent, develop, countri, protocol</span>
<span id="cb111-161"><a href="#cb111-161" aria-hidden="true" tabindex="-1"></a>#3: climate, will, chang, countri, must, develop</span>
<span id="cb111-162"><a href="#cb111-162" aria-hidden="true" tabindex="-1"></a>#4: energi, develop, countri, emiss, climat</span>
<span id="cb111-163"><a href="#cb111-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-164"><a href="#cb111-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-167"><a href="#cb111-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-168"><a href="#cb111-168" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri3)</span>
<span id="cb111-169"><a href="#cb111-169" aria-hidden="true" tabindex="-1"></a><span class="fu">sageLabels</span>(stm.cri3)</span>
<span id="cb111-170"><a href="#cb111-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-171"><a href="#cb111-171" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri4)</span>
<span id="cb111-172"><a href="#cb111-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-173"><a href="#cb111-173" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri5)</span>
<span id="cb111-174"><a href="#cb111-174" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 1 Top Words:</span></span>
<span id="cb111-175"><a href="#cb111-175" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: climat, chang, develop, countri, presid, adapt, nation </span></span>
<span id="cb111-176"><a href="#cb111-176" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: napa, namibia, malawi, nepal, zambia, vietnam, african </span></span>
<span id="cb111-177"><a href="#cb111-177" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 2 Top Words:</span></span>
<span id="cb111-178"><a href="#cb111-178" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: parti, develop, convent, protocol, countri, kyoto, presid </span></span>
<span id="cb111-179"><a href="#cb111-179" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: bonn, group, bueno, china, complianc, protocol, kyoto </span></span>
<span id="cb111-180"><a href="#cb111-180" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 3 Top Words:</span></span>
<span id="cb111-181"><a href="#cb111-181" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: develop, climat, chang, countri, technolog, will, emiss </span></span>
<span id="cb111-182"><a href="#cb111-182" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: vision, poznan, market, australia, partnership, key, invest </span></span>
<span id="cb111-183"><a href="#cb111-183" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 4 Top Words:</span></span>
<span id="cb111-184"><a href="#cb111-184" aria-hidden="true" tabindex="-1"></a> <span class="co"># Highest Prob: countri, emiss, energi, develop, climat, convent, chang </span></span>
<span id="cb111-185"><a href="#cb111-185" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: latvia, turkey, geneva, comment, agbm, lithuania, berlin </span></span>
<span id="cb111-186"><a href="#cb111-186" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 5 Top Words:</span></span>
<span id="cb111-187"><a href="#cb111-187" aria-hidden="true" tabindex="-1"></a><span class="co">#  Highest Prob: will, climat, world, countri, chang, must, island </span></span>
<span id="cb111-188"><a href="#cb111-188" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: tuvalu, barbado, solomon, island, fiji, reef, children </span></span>
<span id="cb111-189"><a href="#cb111-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-190"><a href="#cb111-190" aria-hidden="true" tabindex="-1"></a><span class="fu">sageLabels</span>(stm.cri4)</span>
<span id="cb111-191"><a href="#cb111-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-192"><a href="#cb111-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-193"><a href="#cb111-193" aria-hidden="true" tabindex="-1"></a>Next I plotted more graphs looking at topic proportion:</span>
<span id="cb111-194"><a href="#cb111-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-197"><a href="#cb111-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-198"><a href="#cb111-198" aria-hidden="true" tabindex="-1"></a><span class="co">#getting the graphical display of estimated topic proportions</span></span>
<span id="cb111-199"><a href="#cb111-199" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"summary"</span>)</span>
<span id="cb111-200"><a href="#cb111-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-201"><a href="#cb111-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-202"><a href="#cb111-202" aria-hidden="true" tabindex="-1"></a>Proceeding with 4 topics, I wanted to look at my covariates in relation to topics. </span>
<span id="cb111-203"><a href="#cb111-203" aria-hidden="true" tabindex="-1"></a>As a reminder, these covariates were income classification of the country, climate</span>
<span id="cb111-204"><a href="#cb111-204" aria-hidden="true" tabindex="-1"></a>risk index, and year of speech.</span>
<span id="cb111-205"><a href="#cb111-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-208"><a href="#cb111-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-209"><a href="#cb111-209" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking</span></span>
<span id="cb111-210"><a href="#cb111-210" aria-hidden="true" tabindex="-1"></a>prep <span class="ot">&lt;-</span> <span class="fu">estimateEffect</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> CRI <span class="sc">+</span> year <span class="sc">+</span> incNum, stm.cri4,</span>
<span id="cb111-211"><a href="#cb111-211" aria-hidden="true" tabindex="-1"></a>                       <span class="at">meta =</span> out<span class="sc">$</span>meta, <span class="at">uncertainty =</span> <span class="st">"Global"</span>)</span>
<span id="cb111-212"><a href="#cb111-212" aria-hidden="true" tabindex="-1"></a><span class="co">#looking at the relationship between covariates and these four topics;</span></span>
<span id="cb111-213"><a href="#cb111-213" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(prep, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb111-214"><a href="#cb111-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-215"><a href="#cb111-215" aria-hidden="true" tabindex="-1"></a>Interestingly, CRI did not seem to be a predictor of any topic. year and income were. </span>
<span id="cb111-216"><a href="#cb111-216" aria-hidden="true" tabindex="-1"></a>I looked at a plot of income plotted against topic prevalence:</span>
<span id="cb111-217"><a href="#cb111-217" aria-hidden="true" tabindex="-1"></a>#1 = low income, 2 = lower middle income, 3 = upper middle income, 4 = high income</span>
<span id="cb111-220"><a href="#cb111-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-221"><a href="#cb111-221" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prep, <span class="at">covariate =</span> <span class="st">"incNum"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">model =</span> stm.cri4)</span>
<span id="cb111-222"><a href="#cb111-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-223"><a href="#cb111-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-224"><a href="#cb111-224" aria-hidden="true" tabindex="-1"></a>Not completely sure I set this up right, but here I looked at expected topic proportion over time (by year)</span>
<span id="cb111-225"><a href="#cb111-225" aria-hidden="true" tabindex="-1"></a>Strangely, topic 2 decreased over time, while 4 increased. Topic 1 remained relatively stable, Topic 2 slightly increased</span>
<span id="cb111-228"><a href="#cb111-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-229"><a href="#cb111-229" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prep, <span class="st">"year"</span>, <span class="at">method =</span> <span class="st">"continuous"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb111-230"><a href="#cb111-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-231"><a href="#cb111-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-232"><a href="#cb111-232" aria-hidden="true" tabindex="-1"></a>To remind myself of topic 2, I looked at the top words... </span>
<span id="cb111-233"><a href="#cb111-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-236"><a href="#cb111-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-237"><a href="#cb111-237" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 2:</span></span>
<span id="cb111-238"><a href="#cb111-238" aria-hidden="true" tabindex="-1"></a><span class="fu">labelTopics</span>(stm.cri4)</span>
<span id="cb111-239"><a href="#cb111-239" aria-hidden="true" tabindex="-1"></a><span class="co">#Topic 2 Top Words:</span></span>
<span id="cb111-240"><a href="#cb111-240" aria-hidden="true" tabindex="-1"></a><span class="co">#Highest Prob: countri, develop, emiss, convent, climat, chang, energi </span></span>
<span id="cb111-241"><a href="#cb111-241" aria-hidden="true" tabindex="-1"></a><span class="co">#FREX: kazakhstan, romania, croatia, latvia, berlin, japan, geneva </span></span>
<span id="cb111-242"><a href="#cb111-242" aria-hidden="true" tabindex="-1"></a><span class="co">#Lift: absorpt, achi, acti, additon, adriat, aerosol, afterward </span></span>
<span id="cb111-243"><a href="#cb111-243" aria-hidden="true" tabindex="-1"></a><span class="co">#Score: romania, berlin, latvia, croatia, energi, implement, aij </span></span>
<span id="cb111-244"><a href="#cb111-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-245"><a href="#cb111-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-246"><a href="#cb111-246" aria-hidden="true" tabindex="-1"></a>To compare this topic to others, I used</span>
<span id="cb111-247"><a href="#cb111-247" aria-hidden="true" tabindex="-1"></a>topical contrasts between topic 2 and other topics</span>
<span id="cb111-248"><a href="#cb111-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-251"><a href="#cb111-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-252"><a href="#cb111-252" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"perspectives"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb111-253"><a href="#cb111-253" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"perspectives"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb111-254"><a href="#cb111-254" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(stm.cri4, <span class="at">type =</span> <span class="st">"perspectives"</span>, <span class="at">topics =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb111-255"><a href="#cb111-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-256"><a href="#cb111-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-257"><a href="#cb111-257" aria-hidden="true" tabindex="-1"></a>Finally, I looked at word clouds for each topic. I was hoping I could use the </span>
<span id="cb111-258"><a href="#cb111-258" aria-hidden="true" tabindex="-1"></a>package grid or gridExtra to combine these four into one graphic, but I guess</span>
<span id="cb111-259"><a href="#cb111-259" aria-hidden="true" tabindex="-1"></a>they were not the right kind of object.</span>
<span id="cb111-260"><a href="#cb111-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-263"><a href="#cb111-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb111-264"><a href="#cb111-264" aria-hidden="true" tabindex="-1"></a>top1 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span>
<span id="cb111-265"><a href="#cb111-265" aria-hidden="true" tabindex="-1"></a>top2 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span>
<span id="cb111-266"><a href="#cb111-266" aria-hidden="true" tabindex="-1"></a>top3 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">3</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span>
<span id="cb111-267"><a href="#cb111-267" aria-hidden="true" tabindex="-1"></a>top4 <span class="ot">&lt;-</span> <span class="fu">cloud</span>(stm.cri4, <span class="at">topic =</span> <span class="dv">4</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, .<span class="dv">3</span>))</span>
<span id="cb111-268"><a href="#cb111-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb111-269"><a href="#cb111-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-270"><a href="#cb111-270" aria-hidden="true" tabindex="-1"></a>I think this was a very interesting exercise, but I am definitely lacking confidence</span>
<span id="cb111-271"><a href="#cb111-271" aria-hidden="true" tabindex="-1"></a>in interpretation of various outputs from structural topic modeling. I want to spend</span>
<span id="cb111-272"><a href="#cb111-272" aria-hidden="true" tabindex="-1"></a>more time working with the package in the future. From these explorations, I </span>
<span id="cb111-273"><a href="#cb111-273" aria-hidden="true" tabindex="-1"></a>don't know that I have a good understanding of waht characterizes each of the four</span>
<span id="cb111-274"><a href="#cb111-274" aria-hidden="true" tabindex="-1"></a>extracted topics. I think I would need to spend more time closely examining each one</span>
<span id="cb111-275"><a href="#cb111-275" aria-hidden="true" tabindex="-1"></a>to identify what the latent ideas are for each topic. </span>
<span id="cb111-276"><a href="#cb111-276" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>